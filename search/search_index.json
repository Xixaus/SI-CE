{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"SI-CE Integration Package","text":""},{"location":"#automated-capillary-electrophoresis-with-sequential-injection","title":"Automated Capillary Electrophoresis with Sequential Injection","text":"<p>Welcome to the SI-CE Integration documentation. This package provides a unified Python interface for controlling Agilent ChemStation CE systems and Sequential Injection (SI) hardware, enabling fully automated analytical workflows. </p> <p>Specific coding mentioned later in text was developed for Openlab ChemStation ver. C.01.07 SR2 [255] with use of instrumentation consisting of Agilent Technologies 7100 Capillary Electrophoresis (CE) in combination with sequential injection (SI) system. Compatibility with different systems was not tested and specific use is left on user consideration.</p> <p>Project Status</p> <p>This project is actively developed.</p>"},{"location":"#what-is-si-ce","title":"What is SI-CE?","text":"<p>SI-CE combines two powerful analytical techniques:</p> <ul> <li>Capillary Electrophoresis (CE): High-resolution separation technique for analyzing charged molecules</li> <li>Sequential Injection (SI): Automated sample preparation and liquid handling system</li> </ul> <p>Connection of these techniques provides user with:</p> <ul> <li>Fully automated sample preparation and analysis</li> <li>Reduced manual intervention and human error</li> <li>Increased throughput and reproducibility</li> <li>Complex analytical workflows with minimal supervision</li> </ul>"},{"location":"#key-features","title":"Key Features","text":""},{"location":"#chemstation-api","title":"ChemStation API","text":"<ul> <li>Direct control of OpenLab CDS ChemStation by command processor</li> <li>Comprehensive method and sequence management</li> <li>Real-time instrument status monitoring</li> <li>Automated vial handling</li> </ul>"},{"location":"#sia-api","title":"SIA API","text":"<ul> <li>Precise syringe pump control (Hamilton MVP compatible)</li> <li>Multi-position valve automation (VICI compatible)</li> <li>Pre-built workflows for common operations</li> <li>Volume tracking and safety features</li> <li>Flexible port configuration</li> </ul>"},{"location":"#integration-benefits","title":"Integration Benefits","text":"<ul> <li>Seamless coordination between sample preparation and analysis</li> <li>One unified Python interface for complete workflow control</li> <li>Reduced analysis time through parallel operations</li> <li>Consistent and reproducible analytical procedures</li> </ul>"},{"location":"#code-preview","title":"Code preview","text":"<pre><code>from ChemstationAPI import ChemstationAPI\nfrom SIA_API.methods import PreparedSIAMethods\n\n# Initialize systems\nce = ChemstationAPI()\nsia = PreparedSIAMethods(ce, syringe, valve)\n\n# Automated workflow\nsia.system_initialization_and_cleaning()\nsia.continuous_fill(vial=15, volume=1500, solvent_port=5)\nce.method.execution_method_with_parameters(\n    vial=15, \n    method_name=\"Protein_Analysis\",\n    sample_name=\"BSA_Standard\"\n)\n</code></pre>"},{"location":"#documentation-overview","title":"Documentation Overview","text":"<p>This documentation is organized to help you quickly find what you need:</p> <ul> <li>Getting Started: Installation and first steps</li> <li>ChemStation API: Control your ChemStation system</li> <li>SIA API: Automate sample preparation</li> <li>Tutorials: Step-by-step guides</li> <li>API Reference: Complete function documentation</li> </ul>"},{"location":"#system-requirements","title":"System Requirements","text":""},{"location":"#hardware","title":"Hardware","text":"<ul> <li>Agilent 7100 Capillary Electrophoresis System</li> <li>Cavro CX Syringe Pump</li> <li>VICI or compatible valve selector</li> <li>Windows PC with available COM ports</li> </ul>"},{"location":"#software","title":"Software","text":"<ul> <li>Windows 7 or higher</li> <li>OpenLab CDS ChemStation Edition</li> <li>Python 3.7+</li> <li>Required Python packages (see Getting Started)</li> </ul>"},{"location":"#support-and-contributing","title":"Support and Contributing","text":"<ul> <li>Issues: Report bugs on GitHub Issues</li> <li>Discussions: Join our community discussions</li> <li>Contributing: See our contribution guidelines</li> </ul> <p>Ready to start?</p> <p>Head to Getting Started to install the package and run your first automated analysis!</p>"},{"location":"getting-started/","title":"Getting Started with SIA-CE","text":"<p>This comprehensive guide will help you install the SIA-CE package and run your first automated Sequential Injection - Capillary Electrophoresis analysis.</p>"},{"location":"getting-started/#prerequisites","title":"Prerequisites","text":"<p>Before installing SIA-CE, ensure your system meets these requirements:</p>"},{"location":"getting-started/#software-requirements","title":"Software Requirements","text":"<ul> <li>Python 3.7 or higher with pip package manager</li> <li>Agilent ChemStation software properly configured and licensed</li> <li>Git (optional, for cloning the repository)</li> <li>VSCode (recommended) - Provides enhanced code editing capabilities and debugging tools</li> </ul>"},{"location":"getting-started/#hardware-requirements","title":"Hardware Requirements","text":"<ul> <li>Capillary Electrophoresis system compatible with ChemStation</li> <li>SI components (syringe pump, valve selector)</li> <li>Serial communication ports for device connectivity</li> </ul>"},{"location":"getting-started/#installation-process","title":"Installation Process","text":""},{"location":"getting-started/#step-1-download-the-sia-ce-package","title":"Step 1: Download the SIA-CE Package","text":"<p>Choose one of the following methods:</p>"},{"location":"getting-started/#option-a-clone-with-git-recommended","title":"Option A: Clone with Git (Recommended)","text":"<pre><code>git clone https://github.com/Xixaus/SIA-CE-code.git\ncd SIA-CE-code\n</code></pre>"},{"location":"getting-started/#option-b-download-zip","title":"Option B: Download ZIP","text":"<ol> <li>Navigate to: https://github.com/Xixaus/SIA-CE-code</li> <li>Click \"Code\" \u2192 \"Download ZIP\"</li> <li>Extract to your desired location (e.g., <code>C:\\SIA-CE\\</code>)</li> <li>Open a terminal/command prompt in the extracted directory</li> </ol>"},{"location":"getting-started/#step-2-install-the-package","title":"Step 2: Install the Package","text":"<p>The package includes all necessary dependencies. Install it using pip in development mode:</p> <pre><code># Windows - using the provided batch file\ninstall.bat\n\n# Or manually with pip\npython -m pip install -e .\n</code></pre> <p>Development Mode Installation</p> <p>The <code>-e</code> flag installs the package in \"editable\" mode, allowing you to modify the code without reinstalling. This is useful for customizing workflows or debugging.</p> <p>The installation will automatically install all required dependencies:</p> <ul> <li><code>pyserial</code> (\u22653.5) - Serial communication with SIA hardware</li> <li><code>tqdm</code> (\u22654.60.0) - Progress bars for long-running operations  </li> <li><code>pandas</code> (\u22651.2.0) - Data manipulation and analysis</li> <li><code>pywin32</code> (\u2265300) - Windows-specific functionality (Windows only)</li> </ul>"},{"location":"getting-started/#step-3-install-optional-development-tools","title":"Step 3: Install Optional Development Tools","text":"<p>For enhanced script development and testing:</p> <pre><code># Jupyter for interactive development\npython -m pip install jupyter notebook\n\n# Development tools (optional)\npython -m pip install pytest pytest-cov black flake8\n</code></pre>"},{"location":"getting-started/#step-4-verify-installation","title":"Step 4: Verify Installation","text":"<p>Test that the package is correctly installed:</p> <pre><code># Test import of main modules\nimport ChemstationAPI\nimport SIA_API\n\nprint(\"SIA-CE package successfully installed!\")\nprint(f\"ChemstationAPI version: {ChemstationAPI.__version__ if hasattr(ChemstationAPI, '__version__') else 'Not specified'}\")\n</code></pre>"},{"location":"getting-started/#chemstation-configuration","title":"ChemStation Configuration","text":""},{"location":"getting-started/#step-1-locate-installation-directory","title":"Step 1: Locate Installation Directory","text":"<p>Find your SIA-CE installation path:</p> <pre><code>import os\nimport ChemstationAPI\n\n# Get the absolute path to the ChemstationAPI module\napi_path = os.path.dirname(ChemstationAPI.__file__)\nmacro_path = os.path.join(api_path, \"core\", \"ChemPyConnect.mac\")\nprint(f\"Macro location: {macro_path}\")\n</code></pre>"},{"location":"getting-started/#step-2-load-the-communication-macro","title":"Step 2: Load the Communication Macro","text":"<ol> <li>Open ChemStation and ensure it's fully loaded</li> <li>Navigate to the command line interface</li> <li>Execute the macro loading command using the path from Step 1:</li> </ol> <pre><code>macro \"C:\\path\\to\\SIA-CE\\ChemstationAPI\\core\\ChemPyConnect.mac\"; Python_Run\n</code></pre> <p>Successful Macro Loading</p> <p>When the macro loads correctly, ChemStation will display: <pre><code>Start Python communication\n</code></pre> This confirms the communication bridge is active and ready.</p> <p>Critical Path Configuration</p> <p>Use the exact path from Step 1! The path will vary based on your installation location.</p> <p>Example paths: - Pip install: <code>C:\\Users\\[username]\\AppData\\Local\\Programs\\Python\\Python39\\Lib\\site-packages\\ChemstationAPI\\core\\ChemPyConnect.mac</code> - Development install: <code>C:\\SIA-CE\\ChemstationAPI\\core\\ChemPyConnect.mac</code></p>"},{"location":"getting-started/#step-3-verify-chemstation-integration","title":"Step 3: Verify ChemStation Integration","text":"<p>Test the connection between Python and ChemStation:</p> <pre><code>from ChemstationAPI.ChemstationAPI import ChemstationAPI\n\n# Initialize ChemStation communication\nchemstation = ChemstationAPI()\n\n# Test basic communication\nresponse = chemstation.send(\"response$ = _METHPATH$\")\nprint(f\"ChemStation method path: {response}\")\nprint(\"ChemStation connection established successfully!\")\n</code></pre> <p>Auto-Fix for Connection Errors</p> <p>If initialization fails, the error message will show the EXACT macro command you need to run in ChemStation: <pre><code>ConnectionError: Failed to establish communication with ChemStation.\nPlease ensure:\n1. ChemStation is running\n2. Communication macro is loaded: macro \"C:\\your\\actual\\path\\ChemPyConnect.mac\"; Python_Run\n</code></pre> Simply copy the macro command from the error message and paste it into ChemStation!</p>"},{"location":"getting-started/#hardware-configuration","title":"Hardware Configuration","text":""},{"location":"getting-started/#step-1-identify-com-ports","title":"Step 1: Identify COM Ports","text":"<p>Discover available serial communication ports on your system:</p> <pre><code>import serial.tools.list_ports\n\nprint(\"Available COM Ports:\")\nprint(\"-\" * 40)\n\nports = serial.tools.list_ports.comports()\nfor port in ports:\n    print(f\"{port.device}: {port.description}\")\n    print(f\"  Hardware ID: {port.hwid}\")\n    print()\n</code></pre> <p>Example output: <pre><code>Available COM Ports:\n----------------------------------------\nCOM3: USB Serial Device (COM3)\n  Hardware ID: USB\\VID_0403&amp;PID_6001\n\nCOM4: Prolific USB-to-Serial Comm Port (COM4)  \n  Hardware ID: USB\\VID_067B&amp;PID_2303\n</code></pre></p>"},{"location":"getting-started/#step-2-configure-syringe-controller","title":"Step 2: Configure Syringe Controller","text":"<p>Test and configure your syringe pump:</p> <pre><code>from SIA_API.devices import SyringeController\nimport time\n\n# Initialize syringe with appropriate parameters\nsyringe = SyringeController(\n    port=\"COM3\",           # Use your identified COM port\n    syringe_size=1000,     # Syringe volume in microliters\n    baudrate=9600          # Match your device settings\n)\n\n# Perform initialization sequence\nsyringe.initialization()  # Initialize syringe pump\nprint(\"Syringe controller ready!\")\n\n# Test basic functionality\nsyringe.print_volume_in_syringe()  # Display current volume status\n</code></pre>"},{"location":"getting-started/#step-3-configure-valve-selector","title":"Step 3: Configure Valve Selector","text":"<p>Test and configure your valve selector:</p> <pre><code>from SIA_API.devices import ValveSelector\nimport time\n\n# Initialize valve selector\nvalve = ValveSelector(\n    port=\"COM4\",           # Use your identified COM port  \n    num_positions=8,       # Number of valve positions\n    baudrate=9600          # Match your device settings\n)\n\n# Test valve movement\nprint(\"Testing valve positions...\")\nfor position in range(1, 4):  # Test first 3 positions\n    valve.position(position)\n    print(f\"Moved to position {position}\")\n    time.sleep(1)  # Brief pause between movements\n\nprint(\"Valve selector configured successfully!\")\n</code></pre>"},{"location":"getting-started/#verification-and-testing","title":"Verification and Testing","text":""},{"location":"getting-started/#complete-system-test","title":"Complete System Test","text":"<p>Run this comprehensive test to verify all components:</p> <pre><code>import time\nfrom ChemstationAPI.ChemstationAPI import ChemstationAPI\nfrom SIA_API.devices import SyringeController, ValveSelector\n\ndef system_test():\n    \"\"\"Complete system functionality test\"\"\"\n\n    print(\"=== SIA-CE System Test ===\")\n\n    # Test 1: ChemStation Communication\n    print(\"\\n1. Testing ChemStation communication...\")\n    try:\n        chemstation = ChemstationAPI()\n        response = chemstation.send(\"response$ = _METHPATH$\")\n        print(f\"\u2713 ChemStation connected. Method path: {response}\")\n    except Exception as e:\n        print(f\"\u2717 ChemStation error: {e}\")\n        return False\n\n    # Test 2: Syringe Controller\n    print(\"\\n2. Testing syringe controller...\")\n    try:\n        syringe = SyringeController(port=\"COM3\", syringe_size=1000)\n        syringe.initialization()\n        print(\"\u2713 Syringe controller ready\")\n    except Exception as e:\n        print(f\"\u2717 Syringe error: {e}\")\n        return False\n\n    # Test 3: Valve Selector  \n    print(\"\\n3. Testing valve selector...\")\n    try:\n        valve = ValveSelector(port=\"COM4\", num_positions=8)\n        valve.position(1)\n        print(\"\u2713 Valve selector operational\")\n    except Exception as e:\n        print(f\"\u2717 Valve error: {e}\")\n        return False\n\n    print(\"\\n\ud83c\udf89 All systems operational! Ready for automated analysis.\")\n    return True\n\n# Run the test\nif __name__ == \"__main__\":\n    system_test()\n</code></pre>"},{"location":"getting-started/#common-installation-issues","title":"Common Installation Issues","text":""},{"location":"getting-started/#python-package-not-found","title":"Python Package Not Found","text":"<p><code>ModuleNotFoundError: No module named 'ChemstationAPI'</code></p> <p>Fix: Reinstall the package: <pre><code>cd C:\\path\\to\\SIA-CE\npython -m pip install -e . --force-reinstall\n</code></pre></p>"},{"location":"getting-started/#chemstation-connection-problems","title":"ChemStation Connection Problems","text":"<p><code>ConnectionError: Failed to establish communication with ChemStation</code></p> <p>Fix: The error message shows the exact macro command needed. Copy and run it in ChemStation: <pre><code>macro \"C:\\your\\path\\ChemPyConnect.mac\"; Python_Run\n</code></pre></p>"},{"location":"getting-started/#com-port-access-issues","title":"COM Port Access Issues","text":"<p><code>SerialException: could not open port COM3</code></p> <p>Fix:  - Run Python as Administrator - Close other serial monitors (Arduino IDE, etc.) - Check correct port in Device Manager</p>"},{"location":"getting-started/#hardware-communication-timeouts","title":"Hardware Communication Timeouts","text":"<p><code>TimeoutError: Device did not respond</code></p> <p>Fix: Test different baudrates: <pre><code>for baud in [9600, 19200, 38400, 115200]:\n    try:\n        syringe = SyringeController(port=\"COM3\", baudrate=baud)\n        print(f\"\u2713 Working baudrate: {baud}\")\n        break\n    except:\n        continue\n</code></pre></p>"},{"location":"getting-started/#quick-configuration-template","title":"Quick Configuration Template","text":"<p>Create a <code>config.py</code> file for your project settings:</p> <pre><code># config.py - System configuration\nSYRINGE_PORT = \"COM3\"\nVALVE_PORT = \"COM4\"\nSYRINGE_SIZE = 1000  # microliters\nVALVE_POSITIONS = 8\nBAUDRATE = 9600\n</code></pre> <p>Use it in your scripts: <pre><code>from config import *\nfrom SIA_API.devices import SyringeController, ValveSelector\n\nsyringe = SyringeController(port=SYRINGE_PORT, syringe_size=SYRINGE_SIZE)\nvalve = ValveSelector(port=VALVE_PORT, num_positions=VALVE_POSITIONS)\n</code></pre></p>"},{"location":"getting-started/#next-steps","title":"Next Steps","text":"<p>Installation Complete!</p> <p>Your SIA-CE system is ready for automated analysis!</p> <p>Start with the First Analysis Tutorial or explore: - ChemStation API Documentation - SIA Workflows - Troubleshooting Guide</p>"},{"location":"api-reference/chemstation-api/","title":"ChemStation API","text":"<p>Main API controller for ChemStation integration.</p>"},{"location":"api-reference/chemstation-api/#ChemstationAPI.ChemstationAPI.ChemstationAPI","title":"ChemstationAPI.ChemstationAPI.ChemstationAPI","text":"<pre><code>ChemstationAPI(config: Optional[CommunicationConfig] = None)\n</code></pre> <p>               Bases: <code>ChemstationCommunicator</code></p> <p>Main API controller for ChemStation.</p> <p>Serves as a unified gateway for all ChemStation functionality, organizing different  aspects of CE instrument control into logical modules. This class does not perform  business logic directly, but forwards calls to appropriate specialized modules.</p> <p>The API provides access to five main functional areas: - CE Module: Carousel vial handling, capillary operations, pressure control - Method Module: CE method management, parameter editing, method execution - Sequence Module: Sequence table editing, batch analysis management - System Module: Instrument status monitoring, run control, diagnostics - Validation Module: Input validation, file existence checks, system state validation</p> Communication Protocol <p>Uses file-based communication where commands are written to a command file and responses are read from a response file. ChemStation monitors the command file through a macro and executes commands via the Command Processor (CP).</p> <p>Attributes:</p> Name Type Description <code>ce</code> <code>CEModule</code> <p>Capillary Electrophoresis instrument control and vial management.</p> <code>method</code> <code>MethodsModule</code> <p>CE method loading, saving, parameter editing and execution.</p> <code>sequence</code> <code>SequenceModule</code> <p>Sequence table management and batch analysis control.</p> <code>system</code> <code>SystemModule</code> <p>System status monitoring and diagnostic functions.</p> <code>validation</code> <code>ValidationModule</code> <p>Input validation and system state checking.</p> Example <p>Basic instrument control workflow:</p> <p>Initialize ChemStation API controller.</p> <p>Sets up communication with ChemStation and initializes all functional modules. By default, tests the connection on startup to ensure ChemStation is responding.</p> <p>Parameters:</p> Name Type Description Default <code>config</code> <code>Optional[CommunicationConfig]</code> <p>Communication configuration settings. If None, uses default configuration    with standard file paths and communication parameters.</p> <code>None</code> <p>Raises:</p> Type Description <code>ConfigurationError</code> <p>If communication setup fails or paths are invalid.</p> <code>ConnectionError</code> <p>If ChemStation connection test fails (when test_on_init=True).            This typically indicates ChemStation is not running or the            communication macro is not loaded.</p> Note <p>Before using the API, ensure ChemStation is running and execute this command in ChemStation's command line to start the communication macro:</p> <p>macro \"path\\to\\ChemPyConnect.mac\"; Python_Run</p>"},{"location":"api-reference/chemstation-api/#ChemstationAPI.ChemstationAPI.ChemstationAPI--initialize-api-connection","title":"Initialize API connection","text":"<p>api = ChemstationAPI()</p>"},{"location":"api-reference/chemstation-api/#ChemstationAPI.ChemstationAPI.ChemstationAPI--load-vial-to-inlet-position-for-analysis","title":"Load vial to inlet position for analysis","text":"<p>api.ce.load_vial_to_position(15, \"inlet\")</p>"},{"location":"api-reference/chemstation-api/#ChemstationAPI.ChemstationAPI.ChemstationAPI--load-and-execute-a-ce-method","title":"Load and execute a CE method","text":"<p>api.method.load(\"CE_Analysis_Method\") api.method.run(\"Sample_001\")</p>"},{"location":"api-reference/chemstation-api/#ChemstationAPI.ChemstationAPI.ChemstationAPI--monitor-analysis-progress","title":"Monitor analysis progress","text":"<p>while api.system.method_on(): ...     remaining = api.system.get_remaining_analysis_time() ...     print(f\"Analysis remaining: {remaining:.1f} minutes\") ...     time.sleep(30)</p>"},{"location":"api-reference/chemstation-api/#ChemstationAPI.ChemstationAPI.ChemstationAPI--direct-chemstation-command-execution","title":"Direct ChemStation command execution","text":"<p>current_voltage = api.send('response$ = VAL$(ObjHdrVal(RCCE1Status[1], \"Voltage_actual\"))') print(f\"Current HV: {current_voltage} kV\")</p>"},{"location":"api-reference/chemstation-api/#ChemstationAPI.ChemstationAPI.ChemstationAPI-functions","title":"Functions","text":""},{"location":"api-reference/chemstation-api/#ChemstationAPI.ChemstationAPI.ChemstationAPI.send","title":"send","text":"<pre><code>send(command: str, timeout: float = 5.0) -&gt; Optional[str]\n</code></pre> <p>Send command directly to ChemStation Command Processor.</p> <p>Executes raw ChemStation commands through the Command Processor (CP). This method provides direct access to ChemStation's scripting capabilities for advanced operations not covered by the specialized modules.</p> <p>For commands that should return a value, prefix the command with \"response$ = \" to capture the result. Commands without this prefix execute but return None.</p> <p>Parameters:</p> Name Type Description Default <code>command</code> <code>str</code> <p>ChemStation CP command string to execute. Can include:     - Variable assignments: SetTabHdrText, SetTabVal, SetObjHdrText     - Data retrieval: _METHPATH$, _DATAPATH$, ACQSTATUS$     - Module commands: WriteModule, SendModule$      - Macro calls: macro path; macro_name parameters     - System commands: LoadMethod, SaveMethod, RunMethod</p> required <code>timeout</code> <code>float</code> <p>Maximum time to wait for command response in seconds.     Increase for long-running operations like method execution.</p> <code>5.0</code> <p>Returns:</p> Type Description <code>Optional[str]</code> <p>String response from ChemStation if command starts with \"response$ = ...\",</p> <code>Optional[str]</code> <p>otherwise None for commands that don't return values.</p> <p>Raises:</p> Type Description <code>CommandError</code> <p>If ChemStation reports command execution failure.</p> <code>TimeoutError</code> <p>If no response received within timeout period.</p> <code>ChemstationError</code> <p>If ChemStation returns an error message.</p> <p>Examples:</p> <p>Get current method path:</p> <pre><code>&gt;&gt;&gt; path = api.send(\"response$ = _METHPATH$\")\n&gt;&gt;&gt; print(f\"Method directory: {path}\")\n</code></pre> <p>Get current high voltage:</p> <pre><code>&gt;&gt;&gt; voltage = api.send('response$ = VAL$(ObjHdrVal(RCCE1Status[1], \"Voltage_actual\"))')\n&gt;&gt;&gt; print(f\"Current voltage: {voltage} kV\")\n</code></pre> <p>Load a specific method:</p> <pre><code>&gt;&gt;&gt; api.send('LoadMethod _METHPATH$, \"MyMethod.M\"')\n</code></pre> <p>Execute a macro with parameters:</p> <pre><code>&gt;&gt;&gt; api.send('macro \"c:\\macros\\mymacro.mac\"; my_macro_name 15, \"Sample001\"')\n</code></pre> <p>Send module command to CE instrument:</p> <pre><code>&gt;&gt;&gt; api.send('WriteModule \"CE1\", \"FLSH 60.0,-2,-2\"')  # 60s flush\n</code></pre>"},{"location":"api-reference/chemstation-ce/","title":"CE Module","text":"<p>Capillary Electrophoresis instrument control module.</p>"},{"location":"api-reference/chemstation-ce/#ChemstationAPI.controllers.ce_module.CEModule","title":"ChemstationAPI.controllers.ce_module.CEModule","text":"<pre><code>CEModule(communicator: ChemstationCommunicator)\n</code></pre> <p>Agilent 7100 CE instrument control for vial handling and capillary operations.</p> <p>Provides high-level interface for controlling the CE instrument's sample handling system, capillary conditioning, and pressure operations. Manages the 50-position carousel and three lift positions through ChemStation communication.</p> <p>The system operates under strict safety constraints where carousel operations are only available during voltage application (analysis runtime) and completely blocked during pressure operations or when instrument doors are open.</p> Vial States <ul> <li>\"carousel\": In tray position, ready for loading</li> <li>\"inlet\": At inlet lift (sample/buffer introduction, positive electrode)</li> <li>\"outlet\": At outlet lift (waste/collection, ground electrode)  </li> <li>\"replenishment\": At replenishment lift (buffer system maintenance)</li> <li>\"out_system\": Not detected in system</li> </ul> <p>Attributes:</p> Name Type Description <code>comm</code> <p>ChemStation communicator for sending commands to CE1 module</p> <code>validation</code> <p>Input validation and system state checking module</p> <p>Initialize CE module with ChemStation communicator.</p> <p>Parameters:</p> Name Type Description Default <code>communicator</code> <code>ChemstationCommunicator</code> <p>ChemStation communication interface for sending          commands and receiving responses from CE1 module</p> required"},{"location":"api-reference/chemstation-ce/#ChemstationAPI.controllers.ce_module.CEModule-functions","title":"Functions","text":""},{"location":"api-reference/chemstation-ce/#ChemstationAPI.controllers.ce_module.CEModule.load_vial_to_position","title":"load_vial_to_position","text":"<pre><code>load_vial_to_position(vial: int, position: str = 'replenishment') -&gt; None\n</code></pre> <p>Load vial from carousel to specified lift position.</p> <p>Transfers a vial from its carousel slot to one of the three lift positions for CE operations. The system automatically rotates the carousel to bring the vial to the front and lifts it to the target position. Includes automatic vial presence verification and mechanical stabilization time.</p> <p>Parameters:</p> Name Type Description Default <code>vial</code> <code>int</code> <p>Carousel position number (1-48 for samples, 49 for parking)</p> required <code>position</code> <code>str</code> <p>Target lift position:      - \"inlet\": Sample injection, positive electrode contact      - \"outlet\": Waste collection, negative electrode (ground)      - \"replenishment\": Buffer system maintenance</p> <code>'replenishment'</code> <p>Raises:</p> Type Description <code>VialError</code> <p>If vial not present in carousel or loading operation fails</p> <code>ValueError</code> <p>If invalid position specified</p> <code>SystemError</code> <p>If carousel unavailable (doors open or pressure operations active)</p> <p>Examples:</p> <pre><code>&gt;&gt;&gt; # Load sample for analysis\n&gt;&gt;&gt; ce.load_vial_to_position(15, \"inlet\")\n&gt;&gt;&gt; # Load waste collection vial  \n&gt;&gt;&gt; ce.load_vial_to_position(20, \"outlet\")\n</code></pre> Note <p>Carousel operations only work during voltage application (analysis runtime). Completely blocked during pressure operations (injection, conditioning, flushing).</p>"},{"location":"api-reference/chemstation-ce/#ChemstationAPI.controllers.ce_module.CEModule.unload_vial_from_position","title":"unload_vial_from_position","text":"<pre><code>unload_vial_from_position(position: str = 'replenishment') -&gt; None\n</code></pre> <p>Return vial from lift position back to its original carousel slot.</p> <p>Lowers the vial from the specified lift position and returns it to its original carousel position. The system automatically identifies which vial number to return based on the current lift position contents.</p> <p>Parameters:</p> Name Type Description Default <code>position</code> <code>str</code> <p>Lift position to unload from:      - \"inlet\": Return sample vial      - \"outlet\": Return waste vial      - \"replenishment\": Return buffer vial</p> <code>'replenishment'</code> <p>Raises:</p> Type Description <code>ValueError</code> <p>If invalid position specified</p> <p>Examples:</p> <pre><code>&gt;&gt;&gt; # Return vials after analysis completion\n&gt;&gt;&gt; ce.unload_vial_from_position(\"inlet\")\n&gt;&gt;&gt; ce.unload_vial_from_position(\"outlet\")\n</code></pre> Warning <p>NEVER unload inlet or outlet vials during voltage application! This can cause severe electrical damage to the instrument's electrode system. Replenishment vials can be safely unloaded during voltage application.</p>"},{"location":"api-reference/chemstation-ce/#ChemstationAPI.controllers.ce_module.CEModule.get_vial_state","title":"get_vial_state","text":"<pre><code>get_vial_state(vial: int) -&gt; str\n</code></pre> <p>Get current position and state of a vial within the CE system.</p> <p>Queries the instrument hardware to determine the real-time location of a specific vial. Essential for tracking sample positions and validating system state before operations.</p> <p>Parameters:</p> Name Type Description Default <code>vial</code> <code>int</code> <p>Vial position number to check (1-50)</p> required <p>Returns:</p> Type Description <code>str</code> <p>Current vial state:</p> <code>str</code> <ul> <li>\"carousel\": Available in tray position, ready for loading</li> </ul> <code>str</code> <ul> <li>\"inlet\": At inlet lift (sample/buffer introduction)</li> </ul> <code>str</code> <ul> <li>\"outlet\": At outlet lift (waste/collection)</li> </ul> <code>str</code> <ul> <li>\"replenishment\": At replenishment lift (buffer maintenance)</li> </ul> <code>str</code> <ul> <li>\"out_system\": Not detected anywhere in the system</li> </ul> <p>Raises:</p> Type Description <code>ValueError</code> <p>If vial number outside valid range (1-50)</p> <code>SystemError</code> <p>If unable to query vial state from instrument</p> <p>Examples:</p> <pre><code>&gt;&gt;&gt; # Check sample preparation status\n&gt;&gt;&gt; if ce.get_vial_state(15) == \"inlet\":\n...     print(\"Sample ready for injection\")\n&gt;&gt;&gt; # Monitor multiple vials\n&gt;&gt;&gt; for vial in [10, 11, 12]:\n...     print(f\"Vial {vial}: {ce.get_vial_state(vial)}\")\n</code></pre>"},{"location":"api-reference/chemstation-ce/#ChemstationAPI.controllers.ce_module.CEModule.flush_capillary","title":"flush_capillary","text":"<pre><code>flush_capillary(time_flush: float, wait: bool = True) -&gt; None\n</code></pre> <p>Perform high-pressure capillary conditioning flush.</p> <p>Executes capillary conditioning using maximum internal pressure (~950 mbar) to remove air bubbles, clean contaminants, and condition the capillary surface. Buffer is drawn from the inlet vial and expelled through the outlet.</p> <p>Parameters:</p> Name Type Description Default <code>time_flush</code> <code>float</code> <p>Flush duration in seconds.</p> required <code>wait</code> <code>bool</code> <p>If True, shows progress bar and waits for completion.   If False, starts flush operation and returns immediately.</p> <code>True</code> <p>Raises:</p> Type Description <code>ValueError</code> <p>If flush time is not positive</p> Requirements <ul> <li>Buffer vial must be loaded at inlet position</li> <li>Adequate buffer volume for specified flush duration</li> </ul> Note <p>Uses maximum system pressure (~950 mbar). Carousel completely blocked during operation due to active pressure application.</p>"},{"location":"api-reference/chemstation-ce/#ChemstationAPI.controllers.ce_module.CEModule.apply_pressure_to_capillary","title":"apply_pressure_to_capillary","text":"<pre><code>apply_pressure_to_capillary(pressure: float, time_pressure: float, wait: bool = True) -&gt; None\n</code></pre> <p>Apply precise pressure to capillary for controlled operations.</p> <p>Provides exact pressure control for sample injection, gentle conditioning, or specialized treatments. Unlike flush_capillary(), allows precise pressure specification within the safe operating range. Commonly used for hydrodynamic sample injection where pressure directly affects injected sample volume.</p> <p>Parameters:</p> Name Type Description Default <code>pressure</code> <code>float</code> <p>Pressure in mbar (range: -100 to +100)      - Positive: Pushes liquid from inlet toward outlet      - Negative: Creates vacuum, pulls liquid toward inlet</p> required <code>time_pressure</code> <code>float</code> <p>Duration of pressure application in seconds</p> required <code>wait</code> <code>bool</code> <p>If True, shows progress bar and waits for completion.   If False, starts pressure and returns immediately.</p> <code>True</code> <p>Raises:</p> Type Description <code>ValueError</code> <p>If pressure outside safe range (\u00b1100 mbar) or time not positive</p> Note <p>Injection pressure directly affects sample volume and peak shape. Carousel blocked during pressure application - position vials beforehand.</p>"},{"location":"api-reference/chemstation-exceptions/","title":"Exceptions","text":"<p>Custom exception classes for error handling.</p>"},{"location":"api-reference/chemstation-exceptions/#ChemstationAPI.exceptions","title":"ChemstationAPI.exceptions","text":"<p>ChemStation API Exception Classes - Specialized error handling for CE operations.</p> <p>This module defines a hierarchy of exception classes for precise error handling in ChemStation operations. Each exception type represents a specific category of failure, enabling targeted error handling and clear diagnostic messages.</p> Exception Hierarchy <p>ChemstationError (base) \u251c\u2500\u2500 CommunicationError - File-based communication failures \u251c\u2500\u2500 CommandError - ChemStation command execution failures \u251c\u2500\u2500 FileOperationError - File system operation failures \u251c\u2500\u2500 SequenceError - Sequence management and execution failures \u251c\u2500\u2500 MethodError - CE method operation failures \u251c\u2500\u2500 VialError - Vial handling and validation failures \u251c\u2500\u2500 ConfigurationError - System configuration failures \u251c\u2500\u2500 ValidationError - Input validation and prerequisite failures \u2514\u2500\u2500 TimeoutError - Operation timeout failures</p> <p>Error Categories: - Communication: Protocol-level failures between Python and ChemStation - Validation: Pre-operation checking failures (missing files, invalid parameters) - Instrument: Physical instrument operation failures (vial loading, method execution) - System: Configuration and setup failures - Timing: Timeout and synchronization failures</p> <p>.. moduleauthor:: Richard Mar\u0161ala</p>"},{"location":"api-reference/chemstation-exceptions/#ChemstationAPI.exceptions-classes","title":"Classes","text":""},{"location":"api-reference/chemstation-exceptions/#ChemstationAPI.exceptions.ChemstationError","title":"ChemstationError","text":"<p>               Bases: <code>Exception</code></p> <p>Base exception class for all ChemStation-related errors.</p> <p>This is the root exception class that all other ChemStation exceptions inherit from. It can be used to catch any ChemStation-related error in broad exception handling scenarios.</p> Usage <p>try:     # ChemStation operations     api.ce.load_vial_to_position(15, \"inlet\")     api.method.run(\"Sample001\") except ChemstationError as e:     print(f\"ChemStation operation failed: {e}\")     # Handle any ChemStation-related error</p>"},{"location":"api-reference/chemstation-exceptions/#ChemstationAPI.exceptions.CommunicationError","title":"CommunicationError","text":"<p>               Bases: <code>ChemstationError</code></p> <p>Raised when file-based communication system fails.</p> <p>This exception indicates problems with the underlying communication protocol between Python and ChemStation, including file access issues, protocol synchronization failures, and communication setup problems.</p> Common Causes <ul> <li>ChemStation communication macro not running</li> <li>Communication files directory not accessible</li> <li>File permission issues</li> <li>Protocol synchronization errors</li> <li>ChemStation not responding to commands</li> </ul> <p>Examples:</p> <p>Communication setup failure:</p> <pre><code>&gt;&gt;&gt; try:\n...     api = ChemstationAPI()\n... except CommunicationError as e:\n...     print(\"Failed to establish ChemStation communication\")\n...     print(\"Ensure ChemStation is running and macro is loaded\")\n</code></pre> <p>Protocol synchronization error:</p> <pre><code>&gt;&gt;&gt; try:\n...     response = api.send(\"complex_command\", timeout=1.0)\n... except CommunicationError:\n...     print(\"Communication protocol error - try restarting connection\")\n</code></pre>"},{"location":"api-reference/chemstation-exceptions/#ChemstationAPI.exceptions.CommandError","title":"CommandError","text":"<p>               Bases: <code>ChemstationError</code></p> <p>Raised when ChemStation Command Processor reports command failure.</p> <p>This exception occurs when ChemStation successfully receives a command but cannot execute it due to syntax errors, invalid parameters, or instrument state conflicts.</p> Common Causes <ul> <li>Invalid ChemStation command syntax</li> <li>Wrong parameter values or types</li> <li>Command not available in current ChemStation mode</li> <li>Instrument state conflicts (e.g., method running)</li> <li>Module-specific command failures</li> </ul> <p>Examples:</p> <p>Invalid command syntax:</p> <pre><code>&gt;&gt;&gt; try:\n...     api.send(\"InvalidCommand parameter\")\n... except CommandError as e:\n...     print(f\"ChemStation rejected command: {e}\")\n</code></pre> <p>Instrument state conflict:</p> <pre><code>&gt;&gt;&gt; try:\n...     api.send('WriteModule \"CE1\", \"INVALID_COMMAND\"')\n... except CommandError:\n...     print(\"CE module rejected command - check instrument state\")\n</code></pre>"},{"location":"api-reference/chemstation-exceptions/#ChemstationAPI.exceptions.FileOperationError","title":"FileOperationError","text":"<p>               Bases: <code>ChemstationError</code></p> <p>Raised when file system operations fail during communication.</p> <p>This exception covers failures in reading from or writing to the command and response files used for ChemStation communication, as well as other file operations like method and sequence file access.</p> Common Causes <ul> <li>Insufficient file system permissions</li> <li>Disk space exhaustion</li> <li>File locked by another process</li> <li>Network drive connectivity issues</li> <li>File corruption or access conflicts</li> </ul> <p>Examples:</p> <p>File write failure:</p> <pre><code>&gt;&gt;&gt; try:\n...     api.method.save(\"NewMethod\")\n... except FileOperationError as e:\n...     print(f\"Cannot save method file: {e}\")\n...     print(\"Check disk space and file permissions\")\n</code></pre> <p>Communication file access:</p> <pre><code>&gt;&gt;&gt; try:\n...     api.send(\"response$ = _METHPATH$\")\n... except FileOperationError:\n...     print(\"Communication file access failed\")\n...     print(\"Check communication directory permissions\")\n</code></pre>"},{"location":"api-reference/chemstation-exceptions/#ChemstationAPI.exceptions.SequenceError","title":"SequenceError","text":"<p>               Bases: <code>ChemstationError</code></p> <p>Raised when sequence management or execution operations fail.</p> <p>This exception covers failures in sequence file operations, sequence table editing, Excel import operations, and sequence execution control.</p> Common Causes <ul> <li>Sequence file not found or corrupted</li> <li>Invalid sequence table parameters</li> <li>Excel file format or access issues</li> <li>Sequence execution state conflicts</li> <li>Row index out of range</li> <li>Missing method files referenced in sequence</li> </ul> <p>Examples:</p> <p>Sequence loading failure:</p> <pre><code>&gt;&gt;&gt; try:\n...     api.sequence.load_sequence(\"MissingSequence\")\n... except SequenceError as e:\n...     print(f\"Cannot load sequence: {e}\")\n</code></pre> <p>Excel import failure:</p> <pre><code>&gt;&gt;&gt; try:\n...     api.sequence.prepare_sequence_table(\"invalid.xlsx\")\n... except SequenceError as e:\n...     print(f\"Excel import failed: {e}\")\n...     print(\"Check Excel file format and accessibility\")\n</code></pre> <p>Sequence execution control:</p> <pre><code>&gt;&gt;&gt; try:\n...     api.sequence.start()\n... except SequenceError:\n...     print(\"Cannot start sequence - check instrument status\")\n</code></pre>"},{"location":"api-reference/chemstation-exceptions/#ChemstationAPI.exceptions.MethodError","title":"MethodError","text":"<p>               Bases: <code>ChemstationError</code></p> <p>Raised when CE method operations fail.</p> <p>This exception covers failures in method file operations, method execution, parameter modification, and method validation.</p> Common Causes <ul> <li>Method file not found or corrupted</li> <li>Method execution startup failure</li> <li>Invalid method parameters</li> <li>Instrument not ready for method execution</li> <li>Method file access or permission issues</li> <li>Parameter validation failures</li> </ul> <p>Examples:</p> <p>Method loading failure:</p> <pre><code>&gt;&gt;&gt; try:\n...     api.method.load(\"NonexistentMethod\")\n... except MethodError as e:\n...     print(f\"Method loading failed: {e}\")\n</code></pre> <p>Method execution failure:</p> <pre><code>&gt;&gt;&gt; try:\n...     api.method.run(\"Sample001\")\n... except MethodError as e:\n...     print(f\"Method execution failed: {e}\")\n...     print(\"Check instrument status and method parameters\")\n</code></pre> <p>Parameterized execution failure:</p> <pre><code>&gt;&gt;&gt; try:\n...     api.method.execution_method_with_parameters(99, \"Method\", \"Sample\")\n... except MethodError:\n...     print(\"Method execution with parameters failed\")\n...     print(\"Check vial presence and method validity\")\n</code></pre>"},{"location":"api-reference/chemstation-exceptions/#ChemstationAPI.exceptions.VialError","title":"VialError","text":"<p>               Bases: <code>ChemstationError</code></p> <p>Raised when vial handling or validation operations fail.</p> <p>This exception covers failures in vial presence checking, carousel operations, lift position management, and vial state validation.</p> Common Causes <ul> <li>Vial not present in specified carousel position</li> <li>Vial loading/unloading mechanical failure</li> <li>Carousel position out of range</li> <li>Lift position occupied when expected empty</li> <li>Vial sensor malfunction or calibration issues</li> <li>Multiple vials missing for batch operations</li> </ul> <p>Examples:</p> <p>Vial presence failure:</p> <pre><code>&gt;&gt;&gt; try:\n...     api.ce.load_vial_to_position(15, \"inlet\")\n... except VialError as e:\n...     print(f\"Vial operation failed: {e}\")\n...     print(\"Check vial is properly seated in carousel\")\n</code></pre> <p>Batch vial validation failure:</p> <pre><code>&gt;&gt;&gt; try:\n...     api.validation.list_vial_validation([1, 2, 3, 4, 5])\n... except VialError as e:\n...     print(f\"Missing vials detected: {e}\")\n...     print(\"Load missing vials before starting sequence\")\n</code></pre> <p>Position validation failure:</p> <pre><code>&gt;&gt;&gt; try:\n...     api.validation.vial_in_position(\"inlet\")\n... except VialError:\n...     print(\"No vial at inlet position\")\n...     print(\"Load sample vial before injection\")\n</code></pre>"},{"location":"api-reference/chemstation-exceptions/#ChemstationAPI.exceptions.ConfigurationError","title":"ConfigurationError","text":"<p>               Bases: <code>ChemstationError</code></p> <p>Raised when system configuration or setup fails.</p> <p>This exception covers failures in API configuration, communication setup, directory creation, and system initialization.</p> Common Causes <ul> <li>Invalid configuration parameters</li> <li>Communication directory creation failure</li> <li>Path configuration errors</li> <li>System permission issues</li> <li>Missing required files or directories</li> <li>Configuration file corruption</li> </ul> <p>Examples:</p> <p>API initialization failure:</p> <pre><code>&gt;&gt;&gt; try:\n...     api = ChemstationAPI(invalid_config)\n... except ConfigurationError as e:\n...     print(f\"Configuration error: {e}\")\n...     print(\"Check configuration parameters and paths\")\n</code></pre> <p>Directory access failure:</p> <pre><code>&gt;&gt;&gt; try:\n...     config = CommunicationConfig(comm_dir=\"/invalid/path\")\n...     api = ChemstationAPI(config)\n... except ConfigurationError:\n...     print(\"Cannot access communication directory\")\n...     print(\"Check path and permissions\")\n</code></pre>"},{"location":"api-reference/chemstation-exceptions/#ChemstationAPI.exceptions.ValidationError","title":"ValidationError","text":"<p>               Bases: <code>ChemstationError</code></p> <p>Raised when input validation or prerequisite checking fails.</p> <p>This exception covers failures in parameter validation, file existence checking, system state validation, and prerequisite verification.</p> Common Causes <ul> <li>Method or sequence file not found</li> <li>Invalid parameter values or ranges</li> <li>System state not ready for operation</li> <li>Missing prerequisites for operations</li> <li>File name or path validation failures</li> <li>Case-sensitive filename issues</li> </ul> <p>Examples:</p> <p>File existence validation:</p> <pre><code>&gt;&gt;&gt; try:\n...     api.validation.validate_method_name(\"NonexistentMethod\")\n... except ValidationError as e:\n...     print(f\"Method validation failed: {e}\")\n...     print(\"Check method name and directory\")\n</code></pre> <p>System state validation:</p> <pre><code>&gt;&gt;&gt; try:\n...     api.validation.validate_use_carousel()\n... except ValidationError as e:\n...     print(f\"Carousel not available: {e}\")\n...     print(\"Wait for instrument to reach ready state\")\n</code></pre> <p>Parameter validation:</p> <pre><code>&gt;&gt;&gt; try:\n...     api.ce.load_vial_to_position(15, \"invalid_position\")\n... except ValidationError:\n...     print(\"Invalid position specified\")\n...     print(\"Use 'inlet', 'outlet', or 'replenishment'\")\n</code></pre>"},{"location":"api-reference/chemstation-exceptions/#ChemstationAPI.exceptions.TimeoutError","title":"TimeoutError","text":"<p>               Bases: <code>ChemstationError</code></p> <p>Raised when operations exceed specified timeout periods.</p> <p>This exception covers timeouts in communication, method execution monitoring, system status polling, and other time-sensitive operations.</p> Common Causes <ul> <li>ChemStation not responding to commands</li> <li>Long-running operations exceeding timeout</li> <li>Communication protocol delays</li> <li>System busy with other operations</li> <li>Network or file system delays</li> <li>Instrument hardware response delays</li> </ul> <p>Examples:</p> <p>Communication timeout:</p> <pre><code>&gt;&gt;&gt; try:\n...     response = api.send(\"complex_command\", timeout=1.0)\n... except TimeoutError as e:\n...     print(f\"Command timeout: {e}\")\n...     print(\"Increase timeout or check ChemStation status\")\n</code></pre> <p>System ready timeout:</p> <pre><code>&gt;&gt;&gt; try:\n...     ready = api.system.wait_for_ready(timeout=30)\n... except TimeoutError:\n...     print(\"System did not reach ready state\")\n...     print(\"Check for instrument errors or long conditioning\")\n</code></pre> <p>Method execution timeout:</p> <pre><code>&gt;&gt;&gt; try:\n...     api.method.run(\"LongAnalysis\")\n...     # Wait with timeout monitoring\n... except TimeoutError:\n...     print(\"Method execution monitoring timeout\")\n...     print(\"Check method status manually\")\n</code></pre>"},{"location":"api-reference/chemstation-methods/","title":"Methods Module","text":"<p>CE method management and execution.</p>"},{"location":"api-reference/chemstation-methods/#ChemstationAPI.controllers.methods_module.MethodsModule","title":"ChemstationAPI.controllers.methods_module.MethodsModule","text":"<pre><code>MethodsModule(communicator: ChemstationCommunicator)\n</code></pre> <p>CE method management for analytical method control and execution.</p> <p>Provides comprehensive method management for ChemStation CE methods including file operations, parameter editing, and execution with custom parameters. Methods are stored as .M files containing instrument parameters, acquisition  settings, and data analysis rules.</p> Method Execution Modes <ol> <li>Direct execution: Run current method with existing parameters</li> <li>Custom execution: Run method with specified data filename  </li> <li>Parameterized execution: Run method with custom vial/sample information</li> </ol> File Management <ul> <li>Methods stored as .M files in ChemStation method directory</li> <li>Runtime parameter access through RC.NET registers</li> <li>Template execution with parameter modification</li> </ul> <p>Attributes:</p> Name Type Description <code>comm</code> <p>ChemStation communicator for command execution</p> <code>validation</code> <p>Method existence and parameter validation</p> <code>system</code> <p>System state monitoring and control</p> <p>Initialize Methods module with ChemStation communicator.</p> <p>Parameters:</p> Name Type Description Default <code>communicator</code> <code>ChemstationCommunicator</code> <p>ChemStation communication interface for method operations          and system commands</p> required"},{"location":"api-reference/chemstation-methods/#ChemstationAPI.controllers.methods_module.MethodsModule-functions","title":"Functions","text":""},{"location":"api-reference/chemstation-methods/#ChemstationAPI.controllers.methods_module.MethodsModule.load","title":"load","text":"<pre><code>load(method_name: str, method_path: str = '_METHODPATHS$') -&gt; None\n</code></pre> <p>Load CE method from file into ChemStation active memory.</p> <p>Loads the specified method file and makes it the current active method. All instrument parameters are updated including voltage, temperature,  vial assignments, and detection settings. Previous unsaved changes are lost.</p> <p>Parameters:</p> Name Type Description Default <code>method_name</code> <code>str</code> <p>Method filename without .M extension         Examples: \"CE_Protein_Analysis\", \"MEKC_SmallMolecules\"</p> required <code>method_path</code> <code>str</code> <p>Directory containing methods. Defaults to ChemStation         method directory (_METHPATH$)</p> <code>'_METHODPATHS$'</code> <p>Raises:</p> Type Description <code>MethodError</code> <p>If method file cannot be loaded or is corrupted</p> <code>ValidationError</code> <p>If method file doesn't exist in specified directory</p> <code>FileNotFoundError</code> <p>If method path is invalid</p> <p>Examples:</p> <pre><code>&gt;&gt;&gt; # Load standard analysis method\n&gt;&gt;&gt; methods.load(\"CE_Protein_Analysis\")\n&gt;&gt;&gt; # Load method from custom directory  \n&gt;&gt;&gt; methods.load(\"TestMethod\", \"C:\\Custom\\Methods\\\")\n</code></pre> Note <p>Method loading overwrites current instrument settings and includes automatic validation of method file existence before loading.</p>"},{"location":"api-reference/chemstation-methods/#ChemstationAPI.controllers.methods_module.MethodsModule.save","title":"save","text":"<pre><code>save(method_name: str = '_METHFILE$', method_path: str = '_METHODPATHS$', comment: str = '\" \"') -&gt; None\n</code></pre> <p>Save current method with specified name and optional comment.</p> <p>Saves the currently loaded method with all current parameter settings to a .M file. If no name specified, overwrites the current method file. Comment is stored in method file metadata for documentation purposes.</p> <p>Parameters:</p> Name Type Description Default <code>method_name</code> <code>str</code> <p>Filename for saved method (without .M extension)         Defaults to current method name (_METHFILE$)         Examples: \"Modified_CE_Method\", \"Optimized_Analysis_v3\"</p> <code>'_METHFILE$'</code> <code>method_path</code> <code>str</code> <p>Directory for saving method. Defaults to ChemStation         method directory (_METHPATH$)</p> <code>'_METHODPATHS$'</code> <code>comment</code> <code>str</code> <p>Optional comment describing method changes or purpose.     Use quotes for multi-word comments</p> <code>'\" \"'</code> <p>Raises:</p> Type Description <code>MethodError</code> <p>If method cannot be saved due to file permissions</p> <code>ValidationError</code> <p>If method name contains invalid characters</p> <code>PermissionError</code> <p>If insufficient write permissions to directory</p> <p>Examples:</p> <pre><code>&gt;&gt;&gt; # Save current method with new name\n&gt;&gt;&gt; methods.save(\"Optimized_CE_Method\", comment=\"Improved resolution\")\n&gt;&gt;&gt; # Overwrite current method\n&gt;&gt;&gt; methods.save()\n</code></pre> Note <p>Existing files with same name are overwritten without warning. Method name should follow Windows filename conventions.</p>"},{"location":"api-reference/chemstation-methods/#ChemstationAPI.controllers.methods_module.MethodsModule.run","title":"run","text":"<pre><code>run(data_name: str, data_dir: str = '_DATAPATH$') -&gt; None\n</code></pre> <p>Execute current method and save data with specified name.</p> <p>Runs the currently loaded method using existing method parameters including vial assignments, sample information, and all analytical conditions from the previous analysis setup. Only the output data filename is changed.</p> <p>Parameters:</p> Name Type Description Default <code>data_name</code> <code>str</code> <p>Name for the data file (without extension)       Examples: \"Sample001\", \"QC_Standard_20240315\", \"Blank_Run\"</p> required <code>data_dir</code> <code>str</code> <p>Directory for data storage. Defaults to ChemStation      data directory (_DATAPATH$)</p> <code>'_DATAPATH$'</code> <p>Raises:</p> Type Description <code>MethodError</code> <p>If method execution fails or cannot start</p> <code>ValidationError</code> <p>If data directory is invalid or required vials missing</p> <code>SystemError</code> <p>If instrument is not ready for analysis</p> <p>Examples:</p> <pre><code>&gt;&gt;&gt; # Run analysis with descriptive name\n&gt;&gt;&gt; methods.run(\"Protein_Sample_001\")\n&gt;&gt;&gt; # Run QC standard with custom directory\n&gt;&gt;&gt; methods.run(\"QC_Standard_Daily\", \"C:\\QC_Data\\\")\n</code></pre> Requirements <ul> <li>Method must be loaded before execution</li> <li>Required vials must be present and positioned</li> <li>Instrument must be in ready state</li> </ul> Note <p>All other parameters (vials, method settings, sample info) remain the same as previous analysis. Progress can be monitored via system.method_on().</p>"},{"location":"api-reference/chemstation-methods/#ChemstationAPI.controllers.methods_module.MethodsModule.execution_method_with_parameters","title":"execution_method_with_parameters","text":"<pre><code>execution_method_with_parameters(vial: int, method_name: str, sample_name: str = '', comment: str = '', subdirectory_name: str = '') -&gt; None\n</code></pre> <p>Execute CE method with custom vial and sample parameters.</p> <p>Executes a method with specified sample parameters by creating a temporary method register, modifying sample information, and running the analysis. Allows running the same method on different samples without manually editing method files.</p> <p>Process workflow: 1. Creates temporary register (TemporaryRegisterMethod) 2. Loads specified method and copies parameters 3. Modifies vial number and sample information 4. Executes analysis with custom parameters 5. Data saved with automatic filename generation</p> <p>Parameters:</p> Name Type Description Default <code>vial</code> <code>int</code> <p>Carousel position for sample (1-48). Must contain sample vial</p> required <code>method_name</code> <code>str</code> <p>Method to execute (without .M extension)         Examples: \"CE_Protein\", \"MEKC_Drugs\", \"CZE_Inorganics\"</p> required <code>sample_name</code> <code>str</code> <p>Descriptive sample name for data file and records         Examples: \"BSA_1mg_ml\", \"Drug_Standard_Mix\", \"Unknown_001\"</p> <code>''</code> <code>comment</code> <code>str</code> <p>Path to text file containing method comment/description.     File content will be embedded in the method documentation</p> <code>''</code> <code>subdirectory_name</code> <code>str</code> <p>Optional subdirectory for data organization.              If empty, uses current data subdirectory</p> <code>''</code> <p>Raises:</p> Type Description <code>MethodError</code> <p>If method execution fails or method not found</p> <code>VialError</code> <p>If specified vial is not present in carousel</p> <code>ValidationError</code> <p>If method name is invalid or doesn't exist</p> <p>Examples:</p> <pre><code>&gt;&gt;&gt; # Analyze protein sample with comment file\n&gt;&gt;&gt; methods.execution_method_with_parameters(\n...     vial=15,\n...     method_name=\"CE_Protein_Analysis\", \n...     sample_name=\"BSA_Standard_1mg_ml\",\n...     comment=\"C:\\Comments\\protein_method.txt\"\n... )\n&gt;&gt;&gt; \n&gt;&gt;&gt; # Run development sample in organized subdirectory\n&gt;&gt;&gt; methods.execution_method_with_parameters(\n...     vial=22,\n...     method_name=\"Development_CZE\",\n...     sample_name=\"Test_Sample_v3\",\n...     subdirectory_name=\"Method_Development\"\n... )\n</code></pre> Requirements <ul> <li>Method file must exist in method directory</li> <li>Vial must be physically present in carousel</li> <li>Instrument must be ready for analysis</li> </ul> Note <p>Data filename generated automatically with timestamp. Sample information stored in data file metadata. Temporary register cleaned up after execution. Comment file validation needs to be implemented.</p>"},{"location":"api-reference/chemstation-sequence/","title":"Sequence Module","text":"<p>Batch analysis and sequence management.</p>"},{"location":"api-reference/chemstation-sequence/#ChemstationAPI.controllers.sequence_module.SequenceModule","title":"ChemstationAPI.controllers.sequence_module.SequenceModule","text":"<pre><code>SequenceModule(communicator: ChemstationCommunicator)\n</code></pre> <p>Sequence management for automated batch analysis execution.</p> <p>Provides comprehensive sequence management including Excel-based sequence creation, row-by-row editing, file operations, and execution control. Sequences enable automated analysis of multiple samples with different methods and parameters.</p> Sequence Table Structure <ul> <li>VialNumber: Carousel position for sample (1-48)</li> <li>Method: CE method name for analysis (.M file)</li> <li>SampleName: Descriptive name for sample identification</li> <li>SampleInfo: Additional sample metadata and notes</li> <li>DataFileName: Custom data file naming (optional)</li> <li>InjVial: Alternative injection vial (for special applications)</li> </ul> Excel Integration <ul> <li>Import sequence parameters from Excel spreadsheets</li> <li>Flexible column mapping for different Excel formats</li> <li>Automatic method validation during import</li> <li>Support for custom data organization schemes</li> </ul> Execution Control <ul> <li>Start/pause/resume sequence execution</li> <li>Progress monitoring and time estimation</li> <li>Error handling with automatic continuation</li> <li>Manual intervention capability during runs</li> </ul> <p>Attributes:</p> Name Type Description <code>comm</code> <p>ChemStation communicator for sequence operations.</p> <code>method</code> <p>Methods module for method validation and operations.</p> <p>Initialize Sequence module with communicator and methods access.</p> <p>Parameters:</p> Name Type Description Default <code>communicator</code> <code>ChemstationCommunicator</code> <p>ChemStation communication interface for sequence operations.</p> required"},{"location":"api-reference/chemstation-sequence/#ChemstationAPI.controllers.sequence_module.SequenceModule-functions","title":"Functions","text":""},{"location":"api-reference/chemstation-sequence/#ChemstationAPI.controllers.sequence_module.SequenceModule.modify_sequence_row","title":"modify_sequence_row","text":"<pre><code>modify_sequence_row(row: int, vial_sample: str = '', method: str = '', sample_name: str = '', sample_info: str = '', data_file_name: str = '') -&gt; None\n</code></pre> <p>Modify parameters in specific sequence table row.</p> <p>Updates individual row in the sequence table with new parameters. Only specified parameters are modified; empty parameters remain unchanged. This allows selective editing of sequence entries without affecting other rows.</p> <p>Parameters:</p> Name Type Description Default <code>row</code> <code>int</code> <p>Row number in sequence table (1-based indexing). Corresponds to analysis order in the sequence.</p> required <code>vial_sample</code> <code>str</code> <p>Carousel position for sample vial (1-48).         Empty string leaves current value unchanged.</p> <code>''</code> <code>method</code> <code>str</code> <p>CE method name (without .M extension) for this analysis.    Examples: \"CE_Protein\", \"MEKC_Drugs\", \"CZE_Inorganics\"</p> <code>''</code> <code>sample_name</code> <code>str</code> <p>Descriptive sample name for identification and data files.         Examples: \"BSA_Standard\", \"Unknown_001\", \"QC_Sample\"</p> <code>''</code> <code>sample_info</code> <code>str</code> <p>Additional sample metadata, experimental conditions, or notes.         Examples: \"pH 7.4 buffer\", \"Dilution 1:10\", \"Replicate 3\"</p> <code>''</code> <code>data_file_name</code> <code>str</code> <p>Custom data filename (optional, auto-generated if empty).</p> <code>''</code> <p>Raises:</p> Type Description <code>SequenceError</code> <p>If sequence modification fails or row doesn't exist.</p> <code>ValidationError</code> <p>If method name is invalid or doesn't exist.</p> <code>ValueError</code> <p>If row number is out of valid range.</p> <p>Examples:</p> <p>Modify sample vial and method:</p> <pre><code>&gt;&gt;&gt; seq.modify_sequence_row(\n...     row=1,\n...     vial_sample=\"15\",\n...     method=\"CE_Protein_Analysis\"\n... )\n</code></pre> <p>Update sample information only:</p> <pre><code>&gt;&gt;&gt; seq.modify_sequence_row(\n...     row=3,\n...     sample_name=\"Unknown_Sample_001\",\n...     sample_info=\"Customer sample, urgent analysis\"\n... )\n</code></pre> <p>Change method for specific analysis:</p> <pre><code>&gt;&gt;&gt; seq.modify_sequence_row(\n...     row=5,\n...     method=\"MEKC_SmallMolecules\"\n... )\n</code></pre> Note <ul> <li>Sequence must be loaded before modification</li> <li>Changes are made to memory, use save_sequence() to persist</li> <li>Method validation performed if method parameter provided</li> <li>Row numbering starts from 1 (not 0)</li> </ul>"},{"location":"api-reference/chemstation-sequence/#ChemstationAPI.controllers.sequence_module.SequenceModule.prepare_sequence_table","title":"prepare_sequence_table","text":"<pre><code>prepare_sequence_table(excel_file_path: str, sequence_name: str = None, sheet_name: int = 0, vial_column: str = None, method_column: str = None, filename_column: str = None, sample_name_column: str = None, sample_info_column: str = None, replicate_column: str = None) -&gt; None\n</code></pre> <p>Import and create sequence table from Excel spreadsheet.</p> <p>Loads sequence parameters from Excel file and creates/updates ChemStation sequence table. Provides flexible column mapping to accommodate different Excel formats and naming conventions. Excel application is briefly opened during processing to ensure proper data handling.</p> Column Mapping <p>Each parameter maps Excel columns to sequence table fields: - vial_column \u2192 VialNumber: Carousel positions - method_column \u2192 Method: CE method names - sample_name_column \u2192 SampleName: Sample identifiers - sample_info_column \u2192 SampleInfo: Additional metadata - filename_column \u2192 DataFileName: Custom data file names - replicate_column \u2192 InjVial: Replicate/injection parameters</p> <p>Parameters:</p> Name Type Description Default <code>excel_file_path</code> <code>str</code> <p>Full path to Excel file containing sequence data.             File should contain headers in first row.</p> required <code>sequence_name</code> <code>str</code> <p>Existing sequence to load before modification.           If None, modifies currently loaded sequence.</p> <code>None</code> <code>sheet_name</code> <code>int</code> <p>Excel worksheet index to read (0-based, default: first sheet).</p> <code>0</code> <code>vial_column</code> <code>str</code> <p>Excel column name containing vial positions.         Examples: \"Vial\", \"Position\", \"Vial_Number\"</p> <code>None</code> <code>method_column</code> <code>str</code> <p>Excel column name containing method names.           Examples: \"Method\", \"CE_Method\", \"Analysis_Method\"</p> <code>None</code> <code>sample_name_column</code> <code>str</code> <p>Excel column name containing sample names.                Examples: \"Sample\", \"Sample_Name\", \"ID\"</p> <code>None</code> <code>sample_info_column</code> <code>str</code> <p>Excel column name containing sample metadata.                Examples: \"Info\", \"Description\", \"Notes\"</p> <code>None</code> <code>filename_column</code> <code>str</code> <p>Excel column name containing custom filenames.             Examples: \"Filename\", \"Data_File\", \"Output_Name\"</p> <code>None</code> <code>replicate_column</code> <code>str</code> <p>Excel column name containing replicate information.              Examples: \"Replicate\", \"Injection\", \"Rep_Number\"</p> <code>None</code> <p>Raises:</p> Type Description <code>FileNotFoundError</code> <p>If Excel file doesn't exist at specified path.</p> <code>ValidationError</code> <p>If referenced methods don't exist in method directory.</p> <code>SequenceError</code> <p>If sequence loading or Excel processing fails.</p> <code>PermissionError</code> <p>If unable to access Excel file or create temp files.</p> <p>Examples:</p> <p>Basic sequence import:</p> <pre><code>&gt;&gt;&gt; seq.prepare_sequence_table(\n...     excel_file_path=\"C:\\Data\\sample_list.xlsx\",\n...     vial_column=\"Vial_Position\",\n...     method_column=\"Analysis_Method\",\n...     sample_name_column=\"Sample_ID\"\n... )\n</code></pre> <p>Import with existing sequence:</p> <pre><code>&gt;&gt;&gt; seq.prepare_sequence_table(\n...     excel_file_path=\"sequence_data.xlsx\",\n...     sequence_name=\"Protein_Analysis_Batch\",\n...     sheet_name=1,  # Second worksheet\n...     vial_column=\"Pos\",\n...     method_column=\"Method\",\n...     sample_name_column=\"Sample\",\n...     sample_info_column=\"Notes\"\n... )\n</code></pre> <p>Complex mapping with all parameters:</p> <pre><code>&gt;&gt;&gt; seq.prepare_sequence_table(\n...     excel_file_path=\"complex_sequence.xlsx\",\n...     vial_column=\"Carousel_Position\",\n...     method_column=\"CE_Method_Name\", \n...     sample_name_column=\"Sample_Identifier\",\n...     sample_info_column=\"Experimental_Conditions\",\n...     filename_column=\"Custom_Filename\",\n...     replicate_column=\"Injection_Number\"\n... )\n</code></pre> Note <ul> <li>Excel file must be accessible (not open in another application)</li> <li>Method names are validated against method directory</li> <li>Temporary Excel file created during processing</li> <li>Sequence is automatically saved after import</li> <li>Excel application briefly visible during processing</li> </ul>"},{"location":"api-reference/chemstation-sequence/#ChemstationAPI.controllers.sequence_module.SequenceModule.start","title":"start","text":"<pre><code>start() -&gt; None\n</code></pre> <p>Start execution of the current sequence.</p> <p>Begins automated execution of the loaded sequence, processing samples in order according to the sequence table. The sequence will run continuously until completion, pause, or error.</p> <p>Raises:</p> Type Description <code>SequenceError</code> <p>If sequence cannot start or no sequence is loaded.</p> <code>SystemError</code> <p>If instrument is not ready for sequence execution.</p> Example <p>seq.start()</p> Note <ul> <li>Sequence must be loaded and validated before starting</li> <li>Instrument enters sequence mode with limited manual control</li> <li>Progress can be monitored via system status methods</li> <li>Use pause() to temporarily halt sequence execution</li> </ul>"},{"location":"api-reference/chemstation-sequence/#ChemstationAPI.controllers.sequence_module.SequenceModule.pause","title":"pause","text":"<pre><code>pause() -&gt; None\n</code></pre> <p>Pause the currently running sequence.</p> <p>Pauses sequence execution after the current method completes. The sequence will not abort the current analysis but will stop before starting the next sample in the sequence.</p> <p>Raises:</p> Type Description <code>SequenceError</code> <p>If no sequence is running or pause fails.</p> Example <p>seq.pause()</p> Note <ul> <li>Current analysis completes before pausing</li> <li>Sequence can be resumed with resume() method</li> <li>Manual operations possible while paused</li> <li>Pause takes effect between sequence entries</li> </ul>"},{"location":"api-reference/chemstation-sequence/#ChemstationAPI.controllers.sequence_module.SequenceModule.resume","title":"resume","text":"<pre><code>resume() -&gt; None\n</code></pre> <p>Resume a paused sequence from where it stopped.</p> <p>Continues sequence execution from the next pending sample in the sequence table. All remaining samples will be processed according to their specified parameters.</p> <p>Raises:</p> Type Description <code>SequenceError</code> <p>If no sequence is paused or resume fails.</p> Example <p>seq.resume()</p> Note <ul> <li>Resumes from next unprocessed sample</li> <li>All sequence parameters remain unchanged</li> <li>Instrument returns to automated sequence mode</li> <li>Manual changes made during pause are preserved</li> </ul>"},{"location":"api-reference/chemstation-sequence/#ChemstationAPI.controllers.sequence_module.SequenceModule.load_sequence","title":"load_sequence","text":"<pre><code>load_sequence(seq_name: str, seq_dir: str = '_SEQPATH$') -&gt; None\n</code></pre> <p>Load an existing sequence from file.</p> <p>Loads a saved sequence file (.S) into ChemStation memory, making it the current active sequence for editing or execution.</p> <p>Parameters:</p> Name Type Description Default <code>seq_name</code> <code>str</code> <p>Sequence filename (without .S extension).      Examples: \"Protein_Batch_Analysis\", \"Daily_QC_Sequence\"</p> required <code>seq_dir</code> <code>str</code> <p>Directory containing sequence files.     Defaults to ChemStation sequence directory (_SEQPATH$).</p> <code>'_SEQPATH$'</code> <p>Raises:</p> Type Description <code>SequenceError</code> <p>If sequence file cannot be loaded.</p> <code>ValidationError</code> <p>If sequence file doesn't exist.</p> <code>FileNotFoundError</code> <p>If sequence directory is invalid.</p> <p>Examples:</p> <p>Load standard sequence:</p> <pre><code>&gt;&gt;&gt; seq.load_sequence(\"Protein_Analysis_Batch\")\n</code></pre> <p>Load from custom directory:</p> <pre><code>&gt;&gt;&gt; seq.load_sequence(\"TestSeq\", \"C:\\Custom\\Sequences\\\")\n</code></pre> Note <ul> <li>Sequence loading overwrites current sequence in memory</li> <li>All unsaved changes to current sequence are lost</li> <li>Sequence parameters become active immediately</li> </ul>"},{"location":"api-reference/chemstation-sequence/#ChemstationAPI.controllers.sequence_module.SequenceModule.save_sequence","title":"save_sequence","text":"<pre><code>save_sequence(seq_name: str = '_SEQFILE$', seq_dir: str = '_SEQPATH$') -&gt; None\n</code></pre> <p>Save current sequence to file.</p> <p>Saves the sequence table and parameters to a .S file for later use. If no name specified, overwrites the current sequence file.</p> <p>Parameters:</p> Name Type Description Default <code>seq_name</code> <code>str</code> <p>Filename for saved sequence (without .S extension).      Defaults to current sequence name (_SEQFILE$).</p> <code>'_SEQFILE$'</code> <code>seq_dir</code> <code>str</code> <p>Directory for saving sequence.     Defaults to ChemStation sequence directory (_SEQPATH$).</p> <code>'_SEQPATH$'</code> <p>Raises:</p> Type Description <code>SequenceError</code> <p>If sequence cannot be saved.</p> <code>PermissionError</code> <p>If insufficient write permissions.</p> <p>Examples:</p> <p>Save with new name:</p> <pre><code>&gt;&gt;&gt; seq.save_sequence(\"Modified_Protein_Sequence\")\n</code></pre> <p>Overwrite current sequence:</p> <pre><code>&gt;&gt;&gt; seq.save_sequence()  # Updates current sequence file\n</code></pre> Note <ul> <li>Saved sequence includes all table data and parameters</li> <li>Existing files with same name are overwritten</li> <li>.S extension added automatically</li> </ul>"},{"location":"api-reference/chemstation-system/","title":"System Module","text":"<p>System monitoring and status management.</p>"},{"location":"api-reference/chemstation-system/#ChemstationAPI.controllers.system_module.SystemModule","title":"ChemstationAPI.controllers.system_module.SystemModule","text":"<pre><code>SystemModule(communicator: ChemstationCommunicator)\n</code></pre> <p>System monitoring and diagnostic control for ChemStation CE operations.</p> <p>Provides comprehensive system status monitoring, method execution tracking, and diagnostic capabilities for the CE instrument. Essential for automated workflows, user interfaces, and system diagnostics.</p> <p>Key monitoring capabilities include real-time acquisition status tracking, method execution state monitoring, analysis timing information, and instrument readiness validation.</p> Diagnostic Tools <ul> <li>Register browser for system debugging and parameter inspection</li> <li>Error condition monitoring and emergency abort capabilities</li> <li>System readiness validation with timeout handling</li> <li>Performance timing analysis for optimization</li> </ul> RC Status Integration <p>Direct access to RC.NET status registers provides detailed instrument status including run states, error conditions, and operational modes for comprehensive system monitoring.</p> <p>Attributes:</p> Name Type Description <code>comm</code> <p>ChemStation communicator for system command execution and status queries</p> <p>Initialize system monitoring module with ChemStation communicator.</p> <p>Parameters:</p> Name Type Description Default <code>communicator</code> <code>ChemstationCommunicator</code> <p>ChemStation communication interface for status queries          and system command execution</p> required"},{"location":"api-reference/chemstation-system/#ChemstationAPI.controllers.system_module.SystemModule-functions","title":"Functions","text":""},{"location":"api-reference/chemstation-system/#ChemstationAPI.controllers.system_module.SystemModule.method_on","title":"method_on","text":"<pre><code>method_on() -&gt; bool\n</code></pre> <p>Check if an analytical method is currently executing.</p> <p>Monitors ChemStation's _MethodOn system variable to determine if any analysis is actively running. Covers all method phases including preconditioning, injection, separation, detection, and postconditioning.</p> <p>Returns:</p> Type Description <code>bool</code> <p>True if a method is currently executing (any phase), False if idle</p> <p>Examples:</p> <pre><code>&gt;&gt;&gt; # Wait for method completion\n&gt;&gt;&gt; while system.method_on():\n...     print(\"Analysis in progress...\")\n...     time.sleep(30)\n&gt;&gt;&gt; \n&gt;&gt;&gt; # Check before starting new analysis\n&gt;&gt;&gt; if not system.method_on():\n...     api.method.run(\"NewSample\")\n</code></pre> Note <p>Essential for automation workflows to prevent overlapping analyses. Use with status() for detailed phase information.</p>"},{"location":"api-reference/chemstation-system/#ChemstationAPI.controllers.system_module.SystemModule.status","title":"status","text":"<pre><code>status() -&gt; str\n</code></pre> <p>Get current ChemStation acquisition status.</p> <p>Returns detailed acquisition status from ChemStation's ACQSTATUS$ system variable, providing specific information about the current operational state and analysis phase.</p> <p>Returns:</p> Type Description <code>str</code> <p>Current acquisition status:</p> <code>str</code> <ul> <li>\"STANDBY\": System idle, ready for new analysis</li> </ul> <code>str</code> <ul> <li>\"PRERUN\": Pre-analysis conditioning and preparation  </li> </ul> <code>str</code> <ul> <li>\"RUN\": Active separation and detection phase</li> </ul> <code>str</code> <ul> <li>\"POSTRUN\": Post-analysis conditioning and cleanup</li> </ul> <code>str</code> <ul> <li>\"ERROR\": Error condition requiring attention</li> </ul> <code>str</code> <ul> <li>\"ABORT\": Analysis aborted or interrupted</li> </ul> <p>Examples:</p> <pre><code>&gt;&gt;&gt; # Monitor analysis phases\n&gt;&gt;&gt; status = system.status()\n&gt;&gt;&gt; if status == \"RUN\":\n...     print(\"Separation in progress\")\n&gt;&gt;&gt; elif status == \"STANDBY\":\n...     print(\"Ready for new sample\")\n&gt;&gt;&gt; \n&gt;&gt;&gt; # Wait for specific phase\n&gt;&gt;&gt; while system.status() != \"RUN\":\n...     time.sleep(5)\n</code></pre> Note <p>Status updates in real-time. STANDBY indicates readiness for new analysis. Includes automatic retry logic for communication reliability.</p>"},{"location":"api-reference/chemstation-system/#ChemstationAPI.controllers.system_module.SystemModule.RC_status","title":"RC_status","text":"<pre><code>RC_status(module: str = 'CE1') -&gt; str\n</code></pre> <p>Get current RC.NET module status for detailed instrument monitoring.</p> <p>Queries RC.NET status registers for detailed instrument status including run states, error conditions, and operational modes. Provides more granular status information than basic acquisition status.</p> <p>Parameters:</p> Name Type Description Default <code>module</code> <code>str</code> <p>RC.NET module identifier. Default \"CE1\" for CE instrument.    Other modules: \"DAD1\" (detector), \"PUMP1\", etc.</p> <code>'CE1'</code> <p>Returns:</p> Type Description <code>str</code> <p>Current RC module run state:</p> <code>str</code> <ul> <li>\"Idle\": Module ready and available for operations</li> </ul> <code>str</code> <ul> <li>\"Run\": Module actively executing operations</li> </ul> <code>str</code> <ul> <li>\"NotReady\": Module initializing or in error state</li> </ul> <code>str</code> <ul> <li>\"Error\": Module error condition requiring attention</li> </ul> <code>str</code> <ul> <li>\"Maintenance\": Module in maintenance mode</li> </ul> <p>Examples:</p> <pre><code>&gt;&gt;&gt; # Monitor CE instrument status\n&gt;&gt;&gt; if system.RC_status(\"CE1\") == \"Idle\":\n...     print(\"CE instrument ready\")\n&gt;&gt;&gt; \n&gt;&gt;&gt; # Check multiple modules\n&gt;&gt;&gt; for module in [\"CE1\", \"DAD1\"]:\n...     print(f\"{module}: {system.RC_status(module)}\")\n</code></pre> Note <p>More detailed than acquisition status. Useful for troubleshooting and system diagnostics. Includes automatic retry logic.</p>"},{"location":"api-reference/chemstation-system/#ChemstationAPI.controllers.system_module.SystemModule.ready_to_start_analysis","title":"ready_to_start_analysis","text":"<pre><code>ready_to_start_analysis(modules=['CE1', 'DAD1'], timeout=None, verbose=True)\n</code></pre> <p>Wait for all specified modules to reach ready state for analysis.</p> <p>Monitors multiple RC.NET modules until all reach \"Idle\" state with no \"NotReady\" conditions. Essential for ensuring instrument readiness before starting automated analysis sequences.</p> <p>The function continuously polls module status and displays real-time progress when verbose mode is enabled. Modules must have both RunState=\"Idle\" and empty NotReadyState_Description to be considered ready.</p> <p>Parameters:</p> Name Type Description Default <code>modules</code> <p>List of module identifiers to check (default: [\"CE1\", \"DAD1\"])     Common modules: \"CE1\" (capillary electrophoresis), \"DAD1\" (detector)</p> <code>['CE1', 'DAD1']</code> <code>timeout</code> <p>Maximum waiting time in seconds. None = wait indefinitely     Typical values: 10s (quick check), 60s (standard), 300s (long methods)</p> <code>None</code> <code>verbose</code> <p>Display real-time status updates during waiting (default: True)</p> <code>True</code> <p>Returns:</p> Type Description <p>None (function returns when all modules ready)</p> <p>Raises:</p> Type Description <code>TimeoutError</code> <p>If modules not ready within specified timeout period</p> <p>Examples:</p> <pre><code>&gt;&gt;&gt; # Quick readiness check before analysis\n&gt;&gt;&gt; system.ready_to_start_analysis(timeout=10, verbose=False)\n&gt;&gt;&gt; \n&gt;&gt;&gt; # Wait for CE and detector with status updates\n&gt;&gt;&gt; system.ready_to_start_analysis([\"CE1\", \"DAD1\"], timeout=60)\n&gt;&gt;&gt; \n&gt;&gt;&gt; # Wait indefinitely with progress display\n&gt;&gt;&gt; system.ready_to_start_analysis(verbose=True)\n</code></pre> Note <p>Displays progress in top menu bar area when verbose=True. Modules must be both \"Idle\" and have no NotReady conditions to pass validation.</p>"},{"location":"api-reference/chemstation-system/#ChemstationAPI.controllers.system_module.SystemModule.add_register_reader","title":"add_register_reader","text":"<pre><code>add_register_reader(register_reader_macro: str = 'ChemstationAPI\\\\controllers\\\\macros\\\\register_reader.mac') -&gt; None\n</code></pre> <p>Add comprehensive register inspection tool to ChemStation Debug menu.</p> <p>Add a powerful register browser tool in ChemStation's top menu bar that enables interactive inspection and modification of ChemStation registers. Invaluable for debugging, system analysis, advanced parameter editing, and understanding ChemStation's internal data structures.</p> <p>The register browser provides a user-friendly interface for exploring complex register hierarchies including RC.NET objects, sequence tables, method parameters, and system variables.</p> Register Browser Features <ul> <li>Browse all ChemStation registers (RC.NET, sequence, method, system)</li> <li>Inspect object structures and data tables interactively</li> <li>View and modify header values and text fields</li> <li>Navigate complex register hierarchies with tree view</li> <li>Export register contents for analysis</li> </ul> <p>Parameters:</p> Name Type Description Default <code>register_reader_macro</code> <code>str</code> <p>Path to register reader macro file.                   Default uses included comprehensive register_reader.mac</p> <code>'ChemstationAPI\\\\controllers\\\\macros\\\\register_reader.mac'</code> <p>Examples:</p> <pre><code>&gt;&gt;&gt; # Add register browser with default comprehensive tool\n&gt;&gt;&gt; system.add_register_reader()\n&gt;&gt;&gt; \n&gt;&gt;&gt; # Use custom register reader\n&gt;&gt;&gt; system.add_register_reader(\"C:\\Custom\\debug_tools.mac\")\n</code></pre> Usage <p>After execution, look for \"Show Registers\" item in ChemStation's Debug menu (top menu bar). Tool provides full register browsing capabilities for advanced users and developers.</p> Note <p>Tool remains available until ChemStation restart. Exercise caution when modifying system registers as changes affect instrument operation.</p>"},{"location":"api-reference/chemstation-system/#ChemstationAPI.controllers.system_module.SystemModule.abort_run","title":"abort_run","text":"<pre><code>abort_run() -&gt; None\n</code></pre> <p>Immediately abort current analysis or sequence execution.</p> <p>Sends emergency abort command to ChemStation that immediately terminates the current analysis, sequence, or operation. Used for emergency stops, error recovery, or when immediate termination is required.</p> <p>The abort process immediately stops the current analysis phase, disables high voltage and pressure systems, and returns the instrument to a safe idle state. All method execution flags are cleared.</p> <p>Raises:</p> Type Description <code>SystemError</code> <p>If abort command fails to execute</p> <p>Examples:</p> <pre><code>&gt;&gt;&gt; # Emergency stop\n&gt;&gt;&gt; system.abort_run()\n&gt;&gt;&gt; \n&gt;&gt;&gt; # Conditional abort on error detection\n&gt;&gt;&gt; if error_detected:\n...     system.abort_run()\n...     print(\"Analysis aborted due to error\")\n</code></pre> Warning <p>Results in immediate termination without post-run conditioning. Data up to abort point may be saved. Instrument requires manual return to ready state after abort.</p>"},{"location":"api-reference/chemstation-system/#ChemstationAPI.controllers.system_module.SystemModule.wait_for_ready","title":"wait_for_ready","text":"<pre><code>wait_for_ready(timeout: int = 60) -&gt; bool\n</code></pre> <p>Wait for ChemStation to reach ready state for new analysis.</p> <p>Continuously polls system status until it reaches a state ready for new analysis (STANDBY or PRERUN) or until timeout expires. Essential for automated workflows that need to wait for instrument availability between analyses.</p> <p>Parameters:</p> Name Type Description Default <code>timeout</code> <code>int</code> <p>Maximum waiting time in seconds. Default 60 seconds.     Increase for methods with long post-run conditioning.     Typical values: 60s (standard), 300s (long methods), 600s (very long)</p> <code>60</code> <p>Returns:</p> Type Description <code>bool</code> <p>True if system reaches ready state within timeout,</p> <code>bool</code> <p>False if timeout expires before ready state achieved</p> <p>Examples:</p> <pre><code>&gt;&gt;&gt; # Standard workflow with timeout\n&gt;&gt;&gt; if system.wait_for_ready():\n...     api.method.run(\"NextSample\")\n... else:\n...     print(\"Timeout - check instrument status\")\n&gt;&gt;&gt; \n&gt;&gt;&gt; # Extended wait for long conditioning methods\n&gt;&gt;&gt; if system.wait_for_ready(timeout=300):  # 5 minutes\n...     start_next_analysis()\n&gt;&gt;&gt; \n&gt;&gt;&gt; # Sequence automation\n&gt;&gt;&gt; for sample in sample_list:\n...     if system.wait_for_ready(timeout=120):\n...         process_sample(sample)\n</code></pre> Note <p>Polls status every second to minimize system load. Both STANDBY and PRERUN are considered ready states. Returns immediately if already ready.</p>"},{"location":"api-reference/chemstation-system/#ChemstationAPI.controllers.system_module.SystemModule.get_elapsed_analysis_time","title":"get_elapsed_analysis_time","text":"<pre><code>get_elapsed_analysis_time() -&gt; float\n</code></pre> <p>Get elapsed separation time since current analysis started.</p> <p>Returns the time elapsed since the actual separation phase began in the current analysis. Excludes pre-run conditioning, injection, and preparation phases - measures only electrophoretic separation runtime.</p> <p>Returns:</p> Type Description <code>float</code> <p>Elapsed separation time in minutes as float. Returns 0.0 if no</p> <code>float</code> <p>analysis is running or separation hasn't started yet.</p> <p>Examples:</p> <pre><code>&gt;&gt;&gt; # Monitor analysis progress\n&gt;&gt;&gt; elapsed = system.get_elapsed_analysis_time()\n&gt;&gt;&gt; total = system.get_analysis_time()\n&gt;&gt;&gt; progress = (elapsed / total) * 100\n&gt;&gt;&gt; print(f\"Analysis {progress:.1f}% complete\")\n&gt;&gt;&gt; \n&gt;&gt;&gt; # Real-time monitoring with updates\n&gt;&gt;&gt; while system.method_on():\n...     elapsed = system.get_elapsed_analysis_time()\n...     print(f\"Running for {elapsed:.2f} minutes\")\n...     time.sleep(30)\n</code></pre> Note <p>Measures only separation phase, not total method time including conditioning. Updates in real-time with precision to 0.01 minutes.</p>"},{"location":"api-reference/chemstation-system/#ChemstationAPI.controllers.system_module.SystemModule.get_analysis_time","title":"get_analysis_time","text":"<pre><code>get_analysis_time() -&gt; float\n</code></pre> <p>Get total expected separation duration for current method.</p> <p>Returns the programmed separation duration from the currently loaded method's stoptime parameter. This represents the expected separation runtime and is used for progress calculations and time estimation.</p> <p>Returns:</p> Type Description <code>float</code> <p>Total separation duration in minutes as float</p> <p>Examples:</p> <pre><code>&gt;&gt;&gt; # Calculate remaining time\n&gt;&gt;&gt; total_time = system.get_analysis_time()\n&gt;&gt;&gt; elapsed_time = system.get_elapsed_analysis_time()\n&gt;&gt;&gt; remaining = total_time - elapsed_time\n&gt;&gt;&gt; print(f\"Analysis completes in {remaining:.2f} minutes\")\n&gt;&gt;&gt; \n&gt;&gt;&gt; # Check method duration before starting\n&gt;&gt;&gt; duration = system.get_analysis_time()\n&gt;&gt;&gt; if duration &gt; 60:  # More than 1 hour\n...     confirm = input(f\"Long analysis ({duration:.1f}min). Continue? \")\n</code></pre> Note <p>Based on method's programmed stoptime parameter. Does not include conditioning or injection time. Remains constant during execution.</p>"},{"location":"api-reference/chemstation-system/#ChemstationAPI.controllers.system_module.SystemModule.get_remaining_analysis_time","title":"get_remaining_analysis_time","text":"<pre><code>get_remaining_analysis_time() -&gt; float\n</code></pre> <p>Get remaining separation time until current analysis completes.</p> <p>Calculates time remaining until separation phase completes by subtracting elapsed time from total expected duration. Provides real-time countdown for analysis completion and progress monitoring.</p> <p>Returns:</p> Type Description <code>float</code> <p>Remaining separation time in minutes as float. Returns 0.0 if no</p> <code>float</code> <p>analysis running. May be negative if analysis exceeds expected duration.</p> <p>Examples:</p> <pre><code>&gt;&gt;&gt; # Display countdown\n&gt;&gt;&gt; remaining = system.get_remaining_analysis_time()\n&gt;&gt;&gt; print(f\"Analysis completes in {remaining:.1f} minutes\")\n&gt;&gt;&gt; \n&gt;&gt;&gt; # Progress monitoring with updates\n&gt;&gt;&gt; while system.method_on():\n...     remaining = system.get_remaining_analysis_time()\n...     if remaining &gt; 0:\n...         print(f\"Time remaining: {remaining:.2f} minutes\")\n...     time.sleep(60)\n&gt;&gt;&gt; \n&gt;&gt;&gt; # Automated scheduling\n&gt;&gt;&gt; if system.get_remaining_analysis_time() &lt; 5:  # Less than 5 minutes\n...     prepare_next_sample()\n</code></pre> Note <p>Updates continuously during analysis. Useful for progress bars and time estimation in automated workflows.</p>"},{"location":"api-reference/chemstation-validation/","title":"Validation Module","text":"<p>Input validation and system state checking.</p>"},{"location":"api-reference/chemstation-validation/#ChemstationAPI.controllers.validation.ValidationModule","title":"ChemstationAPI.controllers.validation.ValidationModule","text":"<pre><code>ValidationModule(communicator: ChemstationCommunicator)\n</code></pre> <p>Comprehensive validation and system state checking for ChemStation operations.</p> <p>Provides validation methods for all aspects of ChemStation operation including file system validation, instrument state checking, vial management validation, and method execution verification. All validation methods follow consistent patterns and raise specific exceptions for different failure modes.</p> Validation Philosophy <ul> <li>Fail fast: Detect problems before they cause system errors</li> <li>Specific exceptions: Different failure modes have different exception types</li> <li>Case-insensitive: File and method name checking handles case variations</li> <li>Comprehensive checking: Validate all prerequisites before operations</li> </ul> File System Validation <ul> <li>Method file existence in ChemStation directories</li> <li>Sequence file existence and accessibility</li> <li>Case-insensitive filename matching</li> <li>Path validation and accessibility checking</li> </ul> Instrument State Validation <ul> <li>System readiness for operations</li> <li>Carousel availability and operational state</li> <li>Method execution state verification</li> <li>Error condition detection and reporting</li> </ul> Vial Management Validation <ul> <li>Individual vial presence checking</li> <li>Batch vial validation for sequences</li> <li>Position occupancy verification</li> <li>Carousel state comprehensive monitoring</li> </ul> <p>Attributes:</p> Name Type Description <code>comm</code> <p>ChemStation communicator for validation queries.</p> <p>Initialize validation module with ChemStation communicator.</p> <p>Parameters:</p> Name Type Description Default <code>communicator</code> <code>ChemstationCommunicator</code> <p>ChemStation communication interface for validation queries.</p> required"},{"location":"api-reference/chemstation-validation/#ChemstationAPI.controllers.validation.ValidationModule-functions","title":"Functions","text":""},{"location":"api-reference/chemstation-validation/#ChemstationAPI.controllers.validation.ValidationModule.validate_sequence_name","title":"validate_sequence_name","text":"<pre><code>validate_sequence_name(sequence: str, dir_path: str = '_SEQPATH$') -&gt; None\n</code></pre> <p>Validate that sequence file exists in specified directory.</p> <p>Performs case-insensitive validation of sequence file existence in the ChemStation sequence directory. This prevents errors when loading sequences with different case variations in filenames.</p> <p>Parameters:</p> Name Type Description Default <code>sequence</code> <code>str</code> <p>Sequence name (without .S extension).      Examples: \"protein_analysis\", \"DAILY_QC\", \"Method_Development\"</p> required <code>dir_path</code> <code>str</code> <p>Path to sequence directory. Defaults to ChemStation      sequence directory (_SEQPATH$). Can specify custom path.</p> <code>'_SEQPATH$'</code> <p>Raises:</p> Type Description <code>ValidationError</code> <p>If sequence file doesn't exist in specified directory.            Error message includes actual directory path for debugging.</p> <code>FileNotFoundError</code> <p>If sequence directory doesn't exist or isn't accessible.</p> <p>Examples:</p> <p>Validate before loading:</p> <pre><code>&gt;&gt;&gt; validation.validate_sequence_name(\"Protein_Analysis\")\n&gt;&gt;&gt; seq.load_sequence(\"Protein_Analysis\")  # Safe to load\n</code></pre> <p>Validate custom directory:</p> <pre><code>&gt;&gt;&gt; validation.validate_sequence_name(\"TestSeq\", \"C:\\Custom\\Sequences\\\")\n</code></pre> Note <ul> <li>Case-insensitive matching (protein_analysis matches Protein_Analysis.S)</li> <li>Automatically appends .S extension for checking</li> <li>Validates directory accessibility before file checking</li> <li>Essential for preventing sequence loading failures</li> </ul>"},{"location":"api-reference/chemstation-validation/#ChemstationAPI.controllers.validation.ValidationModule.validate_method","title":"validate_method","text":"<pre><code>validate_method(method: str, dir_path: str = '_METHODPATHS$', check_vials: bool = False) -&gt; None\n</code></pre> <p>Validate that CE method file exists in specified directory.</p> <p>Parameters:</p> Name Type Description Default <code>method</code> <code>str</code> <p>Method name (without .M extension).</p> required <code>dir_path</code> <code>str</code> <p>Path to method directory. Defaults to _METHPATH$.</p> <code>'_METHODPATHS$'</code> <code>check_vials</code> <code>bool</code> <p>If True, also validates that method's vials are in carousel.</p> <code>False</code> <p>Raises:</p> Type Description <code>ValidationError</code> <p>If method file doesn't exist.</p> <code>VialError</code> <p>If check_vials=True and required vials are missing.</p>"},{"location":"api-reference/chemstation-validation/#ChemstationAPI.controllers.validation.ValidationModule.validate_vials_in_method","title":"validate_vials_in_method","text":"<pre><code>validate_vials_in_method(method: str = '_METHFILE$', dir_path: str = '_METHODPATHS$') -&gt; None\n</code></pre> <p>Validate that all vials required by the method are present in carousel.</p> <p>Parameters:</p> Name Type Description Default <code>method</code> <code>str</code> <p>Method name (without .M extension) or \"_METHFILE$\" for currently loaded method.</p> <code>'_METHFILE$'</code> <code>dir_path</code> <code>str</code> <p>Path to method directory. Defaults to _METHODPATHS$.</p> <code>'_METHODPATHS$'</code> <p>Raises:</p> Type Description <code>VialError</code> <p>If required vials are missing from carousel.</p>"},{"location":"api-reference/chemstation-validation/#ChemstationAPI.controllers.validation.ValidationModule.validate_vial_in_system","title":"validate_vial_in_system","text":"<pre><code>validate_vial_in_system(vial: int) -&gt; None\n</code></pre> <p>Validate that specified vial is present somewhere in the CE system.</p> <p>Checks that a vial is physically present in the CE system, either in the carousel or loaded at one of the lift positions. This prevents operations on missing vials that would cause instrument errors.</p> <p>Parameters:</p> Name Type Description Default <code>vial</code> <code>int</code> <p>Vial position number to check (1-50).  Position 49 is typically reserved for replenishment parking.</p> required <p>Raises:</p> Type Description <code>VialError</code> <p>If vial is not detected anywhere in the system.       This indicates the vial is missing or not properly seated.</p> <code>SystemError</code> <p>If unable to query vial state from instrument.</p> <p>Examples:</p> <p>Validate before loading:</p> <pre><code>&gt;&gt;&gt; validation.validate_vial_in_system(15)\n&gt;&gt;&gt; ce.load_vial_to_position(15, \"inlet\")  # Safe to load\n</code></pre> <p>Validate sample list:</p> <pre><code>&gt;&gt;&gt; sample_vials = [10, 11, 12, 15, 20]\n&gt;&gt;&gt; for vial in sample_vials:\n...     validation.validate_vial_in_system(vial)\n</code></pre> Note <ul> <li>Checks all possible vial locations (carousel + lift positions)</li> <li>State \"4\" (out_system) indicates vial not detected</li> <li>Essential before any vial manipulation operations</li> <li>Prevents instrument errors from missing vials</li> </ul>"},{"location":"api-reference/chemstation-validation/#ChemstationAPI.controllers.validation.ValidationModule.validate_method_run","title":"validate_method_run","text":"<pre><code>validate_method_run() -&gt; None\n</code></pre> <p>Validate that method execution started successfully.</p> <p>Checks the ChemStation _MethodOn system variable to verify that method execution actually started after a run command. This catches method startup failures that would otherwise go undetected.</p> <p>Raises:</p> Type Description <code>MethodError</code> <p>If method is not running, indicating startup failure.         This could be due to instrument not ready, parameter errors,         or system conflicts.</p> <p>Examples:</p> <p>Validate after method start:</p> <pre><code>&gt;&gt;&gt; method.run(\"Sample001\")\n&gt;&gt;&gt; validation.validate_method_run()  # Confirm it started\n</code></pre> <p>Use in automated workflows:</p> <pre><code>&gt;&gt;&gt; try:\n...     method.execution_method_with_parameters(15, \"CE_Method\", \"Sample\")\n...     validation.validate_method_run()\n...     print(\"Method started successfully\")\n... except MethodError:\n...     print(\"Method failed to start - check instrument status\")\n</code></pre> Note <ul> <li>Should be called shortly after method start commands</li> <li>_MethodOn=1 indicates successful method execution</li> <li>Essential for detecting silent method startup failures</li> <li>Allows early detection of configuration problems</li> </ul>"},{"location":"api-reference/chemstation-validation/#ChemstationAPI.controllers.validation.ValidationModule.vial_in_position","title":"vial_in_position","text":"<pre><code>vial_in_position(position: str) -&gt; None\n</code></pre> <p>Validate that a vial is loaded at the specified lift position.</p> <p>Checks that a vial is actually present at the specified lift position before operations that require vial contact (injection, electrode contact). This prevents operations that would fail due to missing vials.</p> <p>Parameters:</p> Name Type Description Default <code>position</code> <code>str</code> <p>Lift position to check. Valid positions:      - \"inlet\": Sample injection position      - \"outlet\": Waste/collection position      - \"replenishment\": Buffer replenishment position</p> required <p>Raises:</p> Type Description <code>VialError</code> <p>If no vial is loaded at the specified position.</p> <code>ValueError</code> <p>If invalid position is specified.</p> <p>Examples:</p> <p>Check before injection:</p> <pre><code>&gt;&gt;&gt; validation.vial_in_position(\"inlet\")\n&gt;&gt;&gt; ce.apply_pressure_to_capillary(50.0, 5.0)  # Safe injection\n</code></pre> <p>Verify setup before analysis:</p> <pre><code>&gt;&gt;&gt; validation.vial_in_position(\"inlet\")   # Sample vial\n&gt;&gt;&gt; validation.vial_in_position(\"outlet\")  # Waste vial\n&gt;&gt;&gt; method.run(\"Analysis\")  # Safe to run\n</code></pre> Note <ul> <li>Essential before operations requiring vial contact</li> <li>Lift must have vial loaded, not just carousel presence</li> <li>Different from vial_in_system which checks any location</li> <li>Prevents electrode contact failures and injection errors</li> </ul>"},{"location":"api-reference/chemstation-validation/#ChemstationAPI.controllers.validation.ValidationModule.validate_use_carousel","title":"validate_use_carousel","text":"<pre><code>validate_use_carousel(num_attempt=3) -&gt; None\n</code></pre> <p>Validate that carousel is available for vial operations.</p> <p>Checks the CE instrument RC status to ensure the carousel system is available for vial loading/unloading operations. This prevents carousel operations during incompatible instrument states.</p> <p>Parameters:</p> Name Type Description Default <code>num_attempt</code> <code>int</code> <p>Number of validation attempts before raising error.             Default is 2. Each attempt is separated by 2 second delay.</p> <code>3</code> <p>Raises:</p> Type Description <code>SystemError</code> <p>If carousel is not available for use after all attempts.         This occurs during method execution, error states,         or maintenance modes that lock carousel access.</p> <p>Examples:</p> <p>Check before vial operations with default attempts:</p> <pre><code>&gt;&gt;&gt; validation.validate_use_carousel()\n&gt;&gt;&gt; ce.load_vial_to_position(15, \"inlet\")  # Safe to load\n</code></pre> <p>Check with custom number of attempts:</p> <pre><code>&gt;&gt;&gt; validation.validate_use_carousel(num_attempt=5)\n&gt;&gt;&gt; ce.load_vial_to_position(15, \"inlet\")  # Safe to load\n</code></pre> <p>Validate before batch operations:</p> <pre><code>&gt;&gt;&gt; validation.validate_use_carousel()\n&gt;&gt;&gt; for vial in vial_list:\n...     ce.load_vial_to_position(vial, \"inlet\")\n</code></pre> Note <ul> <li>\"Idle\" state allows carousel operations</li> <li>\"Run\" state may allow limited carousel access</li> <li>Other states (Error, Maintenance) block carousel use</li> <li>Function waits 1 second between validation attempts</li> <li>Essential before any automated vial handling</li> </ul>"},{"location":"api-reference/chemstation-validation/#ChemstationAPI.controllers.validation.ValidationModule.get_vialtable","title":"get_vialtable","text":"<pre><code>get_vialtable() -&gt; Dict[int, bool]\n</code></pre> <p>Get comprehensive status of all carousel positions.</p> <p>Queries the CE instrument for the presence status of all 48 carousel positions and returns a dictionary mapping position numbers to presence status. This provides a complete overview of vial distribution.</p> <p>Returns:</p> Type Description <code>Dict[int, bool]</code> <p>Dictionary mapping position numbers (1-48) to boolean presence status.</p> <code>Dict[int, bool]</code> <p>True indicates vial is present (in carousel or at lift position),</p> <code>Dict[int, bool]</code> <p>False indicates position is empty.</p> <p>Raises:</p> Type Description <code>VialError</code> <p>If vial table cannot be read from instrument.</p> <code>SystemError</code> <p>If communication with carousel system fails.</p> <p>Examples:</p> <p>Get complete vial overview:</p> <pre><code>&gt;&gt;&gt; vial_table = validation.get_vialtable()\n&gt;&gt;&gt; occupied_positions = [pos for pos, present in vial_table.items() if present]\n&gt;&gt;&gt; print(f\"Vials present at positions: {occupied_positions}\")\n</code></pre> <p>Check specific positions:</p> <pre><code>&gt;&gt;&gt; vial_table = validation.get_vialtable()\n&gt;&gt;&gt; for pos in [10, 11, 12]:\n...     if vial_table[pos]:\n...         print(f\"Vial at position {pos} ready\")\n</code></pre> <p>Find empty positions:</p> <pre><code>&gt;&gt;&gt; vial_table = validation.get_vialtable()\n&gt;&gt;&gt; empty_positions = [pos for pos, present in vial_table.items() if not present]\n</code></pre> Note <ul> <li>Includes positions 1-48 (position 49 handled separately)</li> <li>True means vial detected (any location in system)</li> <li>Useful for sequence planning and vial management</li> <li>Updates reflect real-time carousel status</li> </ul>"},{"location":"api-reference/chemstation-validation/#ChemstationAPI.controllers.validation.ValidationModule.list_vial_validation","title":"list_vial_validation","text":"<pre><code>list_vial_validation(vials: list) -&gt; None\n</code></pre> <p>Validate that all vials in list are present in carousel system.</p> <p>Performs batch validation of multiple vials for sequence operations or batch analysis. This ensures all required vials are present before starting automated workflows that would fail on missing vials.</p> <p>Parameters:</p> Name Type Description Default <code>vials</code> <code>list</code> <p>List of vial position numbers to validate.   Examples: [1, 2, 3], [10, 15, 20, 25], range(1, 49)</p> required <p>Raises:</p> Type Description <code>VialError</code> <p>If any vials are missing from the carousel.       Error message lists all missing vial positions for       easy identification and correction.</p> <p>Examples:</p> <p>Validate sequence vials:</p> <pre><code>&gt;&gt;&gt; sequence_vials = [10, 11, 12, 15, 20]\n&gt;&gt;&gt; validation.list_vial_validation(sequence_vials)\n&gt;&gt;&gt; # Safe to start sequence with these vials\n</code></pre> <p>Validate range of positions:</p> <pre><code>&gt;&gt;&gt; validation.list_vial_validation(list(range(1, 25)))  # Check 1-24\n</code></pre> <p>Handle validation errors:</p> <pre><code>&gt;&gt;&gt; try:\n...     validation.list_vial_validation([1, 2, 3, 4, 5])\n... except VialError as e:\n...     print(f\"Missing vials: {e}\")\n...     # Load missing vials before continuing\n</code></pre> Note <ul> <li>Efficient batch checking using single carousel query</li> <li>Reports all missing vials simultaneously</li> <li>Essential before sequence execution</li> <li>Prevents partial sequence failures due to missing vials</li> </ul>"},{"location":"api-reference/chemstation-validation/#ChemstationAPI.controllers.validation.ValidationModule.extract_vials_from_xml","title":"extract_vials_from_xml","text":"<pre><code>extract_vials_from_xml(method_path)\n</code></pre> <p>Extract vial numbers from CE method XML configuration file.</p> <p>Parses ChemStation CE method XML files to extract all vial position numbers referenced in the method configuration. This includes vials used for inlet/outlet positions, preconditioning programs, injection programs, and any other method operations requiring vial access.</p> <p>Parameters:</p> Name Type Description Default <code>method_path</code> <code>str</code> <p>Path to the CE method directory (.M folder).             Function automatically looks for the standard             \"AgilentCEDriver1.RapidControl.MethodXML.xml\" file             within this directory.</p> required <p>Returns:</p> Name Type Description <code>list</code> <p>Sorted list of unique vial position numbers (integers). Only positive vial numbers are included (negative values like -1 are filtered out as they represent \"no vial\" conditions). Empty list if no valid vials found or file reading fails.</p> <p>Examples:</p> <p>Extract vials from method:</p> <pre><code>&gt;&gt;&gt; vials = extract_vials_from_xml(\"C:/Methods/CE_Protein.M\")\n&gt;&gt;&gt; print(f\"Method requires vials: {vials}\")\n[1, 5, 6, 7]\n</code></pre> <p>Use with method validation:</p> <pre><code>&gt;&gt;&gt; method_dir = os.path.join(methods_path, \"CE_Protein.M\")\n&gt;&gt;&gt; required_vials = extract_vials_from_xml(method_dir)\n&gt;&gt;&gt; validation.list_vial_validation(required_vials)\n</code></pre> Note <ul> <li>Automatically constructs path to AgilentCEDriver1.RapidControl.MethodXML.xml</li> <li>File is read with UTF-16 encoding (ChemStation XML standard)</li> <li>Searches for all  tags in the XML</li> <li>Automatically filters negative vial numbers (-1, etc.)</li> <li>Returns empty list on file read errors (with error message printed)</li> <li>Essential for method vial dependency validation before execution</li> </ul>"},{"location":"api-reference/sia-config/","title":"SIA Configuration","text":"<p>System configuration and parameter management.</p>"},{"location":"api-reference/sia-config/#SIA_API.methods.config.SIConfig","title":"SIA_API.methods.config.SIConfig  <code>dataclass</code>","text":"<pre><code>SIConfig(waste_port: int = 1, air_port: int = 2, di_port: int = 3, transfer_port: int = 4, meoh_port: int = 5, naoh_port: int = 6, buffer_port: int = 7, sample_port: int = 8, wash_vial: int = 48, dry_vial: int = 49, waste_vial: int = 50, cleaning_solution_vial: int = 47, default_bubble_volume: int = 15, default_transfer_line_volume: int = 600, default_holding_coil_volume: int = 1000, default_needle_flush: int = 50, default_cleaning_solution_volume: int = 350, default_air_flush: int = 30, default_homogenization_volume: int = 320, speed_air: int = 5000, speed_fast: int = 3500, speed_normal: int = 2000, speed_slow: int = 1500, speed_cleaning: int = 2500, speed_homogenization_aspirate: int = 2000, speed_homogenization_dispense: int = 2000, homogenization_liquid_cycles: int = 2, homogenization_air_cycles: int = 3, homogenization_clean_after: bool = False, wait_vial_load: float = 2.0, wait_vial_unload: float = 1.0, wait_after_aspirate: float = 1.0, wait_after_dispense: float = 0.5, wait_homogenization_settle: float = 5.0, wait_cleaning_reaction: float = 3.0, verbose: bool = True)\n</code></pre> <p>Complete configuration for SI (Sequential Injection) system.</p> <p>This dataclass contains all adjustable parameters organized into logical groups. All parameters have sensible defaults that work for most applications, but can be customized as needed.</p> <p>The configuration covers: - Port assignments for different reagents and functions - Standard vial positions for system components - Volume parameters for various operations - Speed settings for different types of flows - Timing parameters for system operations - Homogenization settings - Display and logging preferences</p> <p>Attributes are grouped logically and documented individually below.</p>"},{"location":"api-reference/sia-config/#SIA_API.methods.config.SIConfig-attributes","title":"Attributes","text":""},{"location":"api-reference/sia-config/#SIA_API.methods.config.SIConfig.waste_port","title":"waste_port  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>waste_port: int = 1\n</code></pre> <p>Port connected to waste line (typically port 1)</p>"},{"location":"api-reference/sia-config/#SIA_API.methods.config.SIConfig.air_port","title":"air_port  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>air_port: int = 2\n</code></pre> <p>Port for air aspiration (typically port 2)</p>"},{"location":"api-reference/sia-config/#SIA_API.methods.config.SIConfig.di_port","title":"di_port  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>di_port: int = 3\n</code></pre> <p>Port connected to deionized water reservoir (typically port 3)</p>"},{"location":"api-reference/sia-config/#SIA_API.methods.config.SIConfig.transfer_port","title":"transfer_port  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>transfer_port: int = 4\n</code></pre> <p>Port connected to transfer line leading to sample needle (typically port 4)</p>"},{"location":"api-reference/sia-config/#SIA_API.methods.config.SIConfig.meoh_port","title":"meoh_port  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>meoh_port: int = 5\n</code></pre> <p>Port connected to methanol reservoir for cleaning (typically port 5)</p>"},{"location":"api-reference/sia-config/#SIA_API.methods.config.SIConfig.naoh_port","title":"naoh_port  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>naoh_port: int = 6\n</code></pre> <p>Port connected to sodium hydroxide solution for cleaning (typically port 6)</p>"},{"location":"api-reference/sia-config/#SIA_API.methods.config.SIConfig.buffer_port","title":"buffer_port  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>buffer_port: int = 7\n</code></pre> <p>Port connected to buffer solution reservoir (typically port 7)</p>"},{"location":"api-reference/sia-config/#SIA_API.methods.config.SIConfig.sample_port","title":"sample_port  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>sample_port: int = 8\n</code></pre> <p>Port connected to sample input line (typically port 8)</p>"},{"location":"api-reference/sia-config/#SIA_API.methods.config.SIConfig.wash_vial","title":"wash_vial  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>wash_vial: int = 48\n</code></pre> <p>Carousel position for needle wash vial (contains wash solution)</p>"},{"location":"api-reference/sia-config/#SIA_API.methods.config.SIConfig.dry_vial","title":"dry_vial  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>dry_vial: int = 49\n</code></pre> <p>Carousel position for dry/empty vial (for air aspiration if needed)</p>"},{"location":"api-reference/sia-config/#SIA_API.methods.config.SIConfig.waste_vial","title":"waste_vial  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>waste_vial: int = 50\n</code></pre> <p>Carousel position for waste collection vial</p>"},{"location":"api-reference/sia-config/#SIA_API.methods.config.SIConfig.cleaning_solution_vial","title":"cleaning_solution_vial  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>cleaning_solution_vial: int = 47\n</code></pre> <p>Carousel position for cleaning solution vial (e.g., NaOH solution)</p>"},{"location":"api-reference/sia-config/#SIA_API.methods.config.SIConfig.default_bubble_volume","title":"default_bubble_volume  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>default_bubble_volume: int = 15\n</code></pre> <p>Default volume for separating air bubbles between different solutions (\u00b5L)</p>"},{"location":"api-reference/sia-config/#SIA_API.methods.config.SIConfig.default_transfer_line_volume","title":"default_transfer_line_volume  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>default_transfer_line_volume: int = 600\n</code></pre> <p>Volume of the transfer line from valve to sample needle (\u00b5L)</p>"},{"location":"api-reference/sia-config/#SIA_API.methods.config.SIConfig.default_holding_coil_volume","title":"default_holding_coil_volume  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>default_holding_coil_volume: int = 1000\n</code></pre> <p>Volume of the holding coil in the flow injection system (\u00b5L)</p>"},{"location":"api-reference/sia-config/#SIA_API.methods.config.SIConfig.default_needle_flush","title":"default_needle_flush  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>default_needle_flush: int = 50\n</code></pre> <p>Default volume for flushing the sample needle to prevent contamination (\u00b5L)</p>"},{"location":"api-reference/sia-config/#SIA_API.methods.config.SIConfig.default_cleaning_solution_volume","title":"default_cleaning_solution_volume  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>default_cleaning_solution_volume: int = 350\n</code></pre> <p>Default volume of cleaning solution (e.g., NaOH) for system cleaning (\u00b5L)</p>"},{"location":"api-reference/sia-config/#SIA_API.methods.config.SIConfig.default_air_flush","title":"default_air_flush  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>default_air_flush: int = 30\n</code></pre> <p>Default volume of air for flushing operations (\u00b5L)</p>"},{"location":"api-reference/sia-config/#SIA_API.methods.config.SIConfig.default_homogenization_volume","title":"default_homogenization_volume  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>default_homogenization_volume: int = 320\n</code></pre> <p>Default volume to aspirate/dispense during sample homogenization (\u00b5L)</p>"},{"location":"api-reference/sia-config/#SIA_API.methods.config.SIConfig.speed_air","title":"speed_air  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>speed_air: int = 5000\n</code></pre> <p>High speed for air aspiration and fast transfers (\u00b5L/min)</p>"},{"location":"api-reference/sia-config/#SIA_API.methods.config.SIConfig.speed_fast","title":"speed_fast  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>speed_fast: int = 3500\n</code></pre> <p>Fast flow rate for routine liquid transfers (\u00b5L/min)</p>"},{"location":"api-reference/sia-config/#SIA_API.methods.config.SIConfig.speed_normal","title":"speed_normal  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>speed_normal: int = 2000\n</code></pre> <p>Normal flow rate for standard operations (\u00b5L/min)</p>"},{"location":"api-reference/sia-config/#SIA_API.methods.config.SIConfig.speed_slow","title":"speed_slow  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>speed_slow: int = 1500\n</code></pre> <p>Slow flow rate for precise operations or viscous liquids (\u00b5L/min)</p>"},{"location":"api-reference/sia-config/#SIA_API.methods.config.SIConfig.speed_cleaning","title":"speed_cleaning  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>speed_cleaning: int = 2500\n</code></pre> <p>Flow rate for cleaning operations (\u00b5L/min)</p>"},{"location":"api-reference/sia-config/#SIA_API.methods.config.SIConfig.speed_homogenization_aspirate","title":"speed_homogenization_aspirate  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>speed_homogenization_aspirate: int = 2000\n</code></pre> <p>Flow rate for aspirating during sample homogenization (\u00b5L/min)</p>"},{"location":"api-reference/sia-config/#SIA_API.methods.config.SIConfig.speed_homogenization_dispense","title":"speed_homogenization_dispense  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>speed_homogenization_dispense: int = 2000\n</code></pre> <p>Flow rate for dispensing during sample homogenization (\u00b5L/min)</p>"},{"location":"api-reference/sia-config/#SIA_API.methods.config.SIConfig.homogenization_liquid_cycles","title":"homogenization_liquid_cycles  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>homogenization_liquid_cycles: int = 2\n</code></pre> <p>Number of aspiration/dispense cycles for liquid-based homogenization</p>"},{"location":"api-reference/sia-config/#SIA_API.methods.config.SIConfig.homogenization_air_cycles","title":"homogenization_air_cycles  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>homogenization_air_cycles: int = 3\n</code></pre> <p>Number of aspiration/dispense cycles for air bubble-based homogenization</p>"},{"location":"api-reference/sia-config/#SIA_API.methods.config.SIConfig.homogenization_clean_after","title":"homogenization_clean_after  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>homogenization_clean_after: bool = False\n</code></pre> <p>Whether to automatically clean the transfer line after homogenization</p>"},{"location":"api-reference/sia-config/#SIA_API.methods.config.SIConfig.wait_vial_load","title":"wait_vial_load  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>wait_vial_load: float = 2.0\n</code></pre> <p>Wait time after loading a vial to replenishment position (seconds)</p>"},{"location":"api-reference/sia-config/#SIA_API.methods.config.SIConfig.wait_vial_unload","title":"wait_vial_unload  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>wait_vial_unload: float = 1.0\n</code></pre> <p>Wait time after unloading a vial from replenishment position (seconds)</p>"},{"location":"api-reference/sia-config/#SIA_API.methods.config.SIConfig.wait_after_aspirate","title":"wait_after_aspirate  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>wait_after_aspirate: float = 1.0\n</code></pre> <p>Wait time after liquid aspiration for system stabilization (seconds)</p>"},{"location":"api-reference/sia-config/#SIA_API.methods.config.SIConfig.wait_after_dispense","title":"wait_after_dispense  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>wait_after_dispense: float = 0.5\n</code></pre> <p>Wait time after liquid dispensing for system stabilization (seconds)</p>"},{"location":"api-reference/sia-config/#SIA_API.methods.config.SIConfig.wait_homogenization_settle","title":"wait_homogenization_settle  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>wait_homogenization_settle: float = 5.0\n</code></pre> <p>Wait time for sample settling during homogenization operations (seconds)</p>"},{"location":"api-reference/sia-config/#SIA_API.methods.config.SIConfig.wait_cleaning_reaction","title":"wait_cleaning_reaction  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>wait_cleaning_reaction: float = 3.0\n</code></pre> <p>Wait time for cleaning solution to react before flushing (seconds)</p>"},{"location":"api-reference/sia-config/#SIA_API.methods.config.SIConfig.verbose","title":"verbose  <code>class-attribute</code> <code>instance-attribute</code>","text":"<pre><code>verbose: bool = True\n</code></pre> <p>Global verbose setting - controls whether status messages are displayed</p>"},{"location":"api-reference/sia-config/#configuration-functions","title":"Configuration Functions","text":""},{"location":"api-reference/sia-config/#SIA_API.methods.config","title":"SIA_API.methods.config","text":"<p>Configuration management for SI (Sequential Injection) system.</p> <p>This module provides centralized configuration for all adjustable parameters used in SI workflows. The SIConfig dataclass contains all system parameters organized into logical groups for easy maintenance and customization.</p> Example <p>from config import SIConfig, DEFAULT_CONFIG</p>"},{"location":"api-reference/sia-config/#SIA_API.methods.config--use-default-configuration","title":"Use default configuration","text":"<p>config = DEFAULT_CONFIG</p>"},{"location":"api-reference/sia-config/#SIA_API.methods.config--create-custom-configuration","title":"Create custom configuration","text":"<p>custom_config = SIAConfig( ...     speed_normal=1800, ...     verbose=False, ...     homogenization_liquid_cycles=3 ... )</p>"},{"location":"api-reference/sia-config/#SIA_API.methods.config--modify-existing-configuration","title":"Modify existing configuration","text":"<p>config.speed_fast = 4000 config.default_bubble_volume = 20</p>"},{"location":"api-reference/sia-config/#SIA_API.methods.config-functions","title":"Functions","text":""},{"location":"api-reference/sia-config/#SIA_API.methods.config.validate_config","title":"validate_config","text":"<pre><code>validate_config(config) -&gt; list\n</code></pre> <p>Validate a SIConfig instance and return any issues found.</p> <p>Parameters:</p> Name Type Description Default <code>config</code> <p>The SIConfig instance to validate</p> required <p>Returns:</p> Type Description <code>list</code> <p>List of validation error messages (empty if no issues)</p> Example <p>config = SIConfig(speed_normal=-100)  # Invalid negative speed errors = validate_config(config) if errors: ...     print(\"Configuration issues:\", errors)</p>"},{"location":"api-reference/sia-config/#SIA_API.methods.config.create_config_from_dict","title":"create_config_from_dict","text":"<pre><code>create_config_from_dict(config_dict: dict) -&gt; SIConfig\n</code></pre> <p>Create a SIConfig instance from a dictionary.</p> <p>Useful for loading configuration from JSON files or other sources. Unknown keys in the dictionary are ignored.</p> <p>Parameters:</p> Name Type Description Default <code>config_dict</code> <code>dict</code> <p>Dictionary with configuration parameters</p> required <p>Returns:</p> Type Description <code>SIConfig</code> <p>New SIConfig instance with specified parameters</p> Example <p>config_data = { ...     'speed_normal': 1800, ...     'verbose': False, ...     'default_bubble_volume': 20 ... } config = create_config_from_dict(config_data)</p>"},{"location":"api-reference/sia-config/#SIA_API.methods.config.config_to_dict","title":"config_to_dict","text":"<pre><code>config_to_dict(config: SIConfig) -&gt; dict\n</code></pre> <p>Convert a SIConfig instance to a dictionary.</p> <p>Useful for saving configuration to JSON files or other formats.</p> <p>Parameters:</p> Name Type Description Default <code>config</code> <code>SIConfig</code> <p>The SIConfig instance to convert</p> required <p>Returns:</p> Type Description <code>dict</code> <p>Dictionary representation of the configuration</p> Example <p>config = SIConfig(speed_normal=1800) config_dict = config_to_dict(config) import json json.dump(config_dict, open('config.json', 'w'), indent=2)</p>"},{"location":"api-reference/sia-config/#SIA_API.methods.config.create_high_throughput_config","title":"create_high_throughput_config","text":"<pre><code>create_high_throughput_config() -&gt; SIConfig\n</code></pre> <p>Create a configuration optimized for high-throughput operations.</p> <p>This preset uses faster flow rates and shorter wait times to maximize sample processing speed, at the cost of some precision.</p> <p>Returns:</p> Type Description <code>SIConfig</code> <p>SIConfig instance optimized for speed</p>"},{"location":"api-reference/sia-config/#SIA_API.methods.config.create_precision_config","title":"create_precision_config","text":"<pre><code>create_precision_config() -&gt; SIConfig\n</code></pre> <p>Create a configuration optimized for high-precision operations.</p> <p>This preset uses slower flow rates and longer wait times to maximize precision and reproducibility, at the cost of throughput.</p> <p>Returns:</p> Type Description <code>SIConfig</code> <p>SIConfig instance optimized for precision</p>"},{"location":"api-reference/sia-config/#SIA_API.methods.config.create_cleaning_intensive_config","title":"create_cleaning_intensive_config","text":"<pre><code>create_cleaning_intensive_config() -&gt; SIConfig\n</code></pre> <p>Create a configuration with enhanced cleaning procedures.</p> <p>This preset includes more thorough cleaning steps and larger cleaning volumes, suitable for applications requiring minimal cross-contamination.</p> <p>Returns:</p> Type Description <code>SIConfig</code> <p>SIConfig instance with enhanced cleaning</p>"},{"location":"api-reference/sia-valve/","title":"Valve Selector","text":"<p>Multi-position valve control for fluid routing.</p>"},{"location":"api-reference/sia-valve/#SIA_API.devices.valve_selector.ValveSelector","title":"SIA_API.devices.valve_selector.ValveSelector","text":"<pre><code>ValveSelector(port: str, num_positions: int = 8, prefix: str = '/Z', address: str = '', baudrate: int = 9600)\n</code></pre> <p>               Bases: <code>CommandSender</code></p> <p>Control multi-position valve selectors for automated fluid routing.</p> <p>Supports VICI and compatible valve selectors with 2-12 positions. Provides reliable positioning with automatic retry and validation.</p> <p>Attributes:</p> Name Type Description <code>num_positions</code> <code>int</code> <p>Number of valve positions available</p> <p>Examples:</p> <p>Basic valve control:</p> <pre><code>&gt;&gt;&gt; valve = ValveSelector(port=\"COM4\", num_positions=8)\n&gt;&gt;&gt; valve.position(1)  # Move to position 1\n&gt;&gt;&gt; valve.position(5)  # Move to position 5\n</code></pre> <p>Custom configuration:</p> <pre><code>&gt;&gt;&gt; valve = ValveSelector(\n...     port=\"COM4\", \n...     num_positions=6,\n...     prefix=\"/Z\",\n...     baudrate=19200\n... )\n</code></pre> <p>Initialize valve selector controller.</p> <p>Parameters:</p> Name Type Description Default <code>port</code> <code>str</code> <p>COM port for valve selector (e.g., \"COM4\")</p> required <code>num_positions</code> <code>int</code> <p>Number of valve positions</p> <code>8</code> <code>prefix</code> <code>str</code> <p>Command prefix for valve protocol (default: \"/Z\")</p> <code>'/Z'</code> <code>address</code> <code>str</code> <p>Device address (usually empty for valve selectors)</p> <code>''</code> <code>baudrate</code> <code>int</code> <p>Serial communication speed (default: 9600)</p> <code>9600</code> <p>Raises:</p> Type Description <code>ValueError</code> <p>If num_positions is outside valid range</p> <code>SerialException</code> <p>If COM port cannot be opened</p> Note <p>Most VICI valve selectors use \"/Z\" prefix and empty address. Some models may require different communication parameters.</p>"},{"location":"api-reference/sia-valve/#SIA_API.devices.valve_selector.ValveSelector-functions","title":"Functions","text":""},{"location":"api-reference/sia-valve/#SIA_API.devices.valve_selector.ValveSelector.position","title":"position","text":"<pre><code>position(position: int, num_attempts: int = 3) -&gt; None\n</code></pre> <p>Move valve to specified position.</p> <p>Parameters:</p> Name Type Description Default <code>position</code> <code>int</code> <p>Target position (1 to num_positions)</p> required <code>num_attempts</code> <code>int</code> <p>Number of command attempts for reliability</p> <code>3</code> <p>Raises:</p> Type Description <code>ValueError</code> <p>If position is outside valid range</p> Note <p>Multiple attempts help ensure reliable valve positioning, as some valves may not respond to the first command.</p> <p>Examples:</p> <pre><code>&gt;&gt;&gt; valve.position(1)          # Move to position 1\n&gt;&gt;&gt; valve.position(8, num_attempts=5)  # Extra attempts for reliability\n</code></pre>"},{"location":"api-reference/sia-workflows/","title":"SIA Workflows","text":"<p>High-level workflow methods for automated procedures.</p>"},{"location":"api-reference/sia-workflows/#SIA_API.methods.prepared_methods.PreparedSIMethods","title":"SIA_API.methods.prepared_methods.PreparedSIMethods","text":"<pre><code>PreparedSIMethods(chemstation_controller, syringe_device: SyringeController, valve_device: ValveSelector, config: Optional[SIConfig] = None)\n</code></pre> <p>High-level SI (Sequential Injection) workflows with real-time status feedback.</p> <p>This class provides complete automation workflows for SI systems, handling complex sequences of operations including sample preparation, reagent mixing, cleaning procedures, and sample homogenization. All methods include comprehensive error checking and optional verbose feedback.</p> <p>The class integrates three main components: 1. ChemStation controller for autosampler operations 2. SyringeController for precise fluid handling 3. ValveSelector for reagent/port switching</p> <p>All operations can be customized through the SIConfig instance, allowing fine-tuning of volumes, speeds, timing, and other parameters.</p> <p>Attributes:</p> Name Type Description <code>chemstation</code> <p>ChemStation API controller instance</p> <code>config</code> <p>SIConfig instance with system parameters</p> <code>syringe</code> <p>SyringeController instance for fluid operations</p> <code>valve</code> <p>ValveSelector instance for port switching</p> <code>syringe_size</code> <p>Maximum volume capacity of the syringe (\u00b5L)</p> <code>_interactive_terminal</code> <p>Boolean indicating if running in interactive terminal</p> <p>Initialize SI workflow system with hardware controllers and configuration.</p> <p>Parameters:</p> Name Type Description Default <code>chemstation_controller</code> <p>ChemStation API controller instance for autosampler</p> required <code>syringe_device</code> <code>SyringeController</code> <p>Initialized SyringeController instance</p> required <code>valve_device</code> <code>ValveSelector</code> <p>Initialized ValveSelector instance  </p> required <code>config</code> <code>Optional[SIConfig]</code> <p>SIConfig instance (uses DEFAULT_CONFIG if None)</p> <code>None</code> <p>Raises:</p> Type Description <code>ValidationError</code> <p>If required vials are not present in the system</p> Example <p>workflow = PreparedSIMethods( ...     chemstation_controller=my_controller, ...     syringe_device=my_syringe, ...     valve_device=my_valve, ...     config=custom_config ... )</p>"},{"location":"api-reference/sia-workflows/#SIA_API.methods.prepared_methods.PreparedSIMethods-functions","title":"Functions","text":""},{"location":"api-reference/sia-workflows/#SIA_API.methods.prepared_methods.PreparedSIMethods.load_to_replenishment","title":"load_to_replenishment","text":"<pre><code>load_to_replenishment(vial_number: int, verbose: Optional[bool] = None) -&gt; None\n</code></pre> <p>Load specified vial to replenishment position in CE carousel.</p> <p>The replenishment position is where the sample needle can access the vial contents for aspiration or dispensing operations.</p> <p>Parameters:</p> Name Type Description Default <code>vial_number</code> <code>int</code> <p>Vial position number (1-50 for typical autosamplers)</p> required <code>verbose</code> <code>Optional[bool]</code> <p>Show status messages (uses config.verbose if None)</p> <code>None</code> <p>Raises:</p> Type Description <code>ValueError</code> <p>If vial_number is outside valid range</p> <code>SystemError</code> <p>If autosampler operation fails</p> Example <p>workflow.load_to_replenishment(vial_number=25) Loading vial 25 to replenishment position...</p>"},{"location":"api-reference/sia-workflows/#SIA_API.methods.prepared_methods.PreparedSIMethods.unload_from_replenishment","title":"unload_from_replenishment","text":"<pre><code>unload_from_replenishment(verbose: Optional[bool] = None) -&gt; None\n</code></pre> <p>Unload vial from replenishment position back to carousel.</p> <p>Returns the currently loaded vial back to its original position in the autosampler carousel.</p> <p>Parameters:</p> Name Type Description Default <code>verbose</code> <code>Optional[bool]</code> <p>Show status messages (uses config.verbose if None)</p> <code>None</code> <p>Raises:</p> Type Description <code>SystemError</code> <p>If autosampler operation fails</p> Example <p>workflow.unload_from_replenishment() Unloading vial from replenishment position...</p>"},{"location":"api-reference/sia-workflows/#SIA_API.methods.prepared_methods.PreparedSIMethods.clean_needle","title":"clean_needle","text":"<pre><code>clean_needle(volume_flush: float, wash_vial: Optional[int] = None, verbose: Optional[bool] = None) -&gt; None\n</code></pre> <p>Clean the dispensing needle to prevent cross-contamination.</p> <p>This procedure uses a wash vial containing cleaning solution to flush the needle exterior and interior, preventing sample carryover between different vials or operations.</p> <p>Parameters:</p> Name Type Description Default <code>volume_flush</code> <code>float</code> <p>Total volume for needle cleaning (\u00b5L)</p> required <code>wash_vial</code> <code>Optional[int]</code> <p>Vial number containing wash solution (uses config default if None)</p> <code>None</code> <code>verbose</code> <code>Optional[bool]</code> <p>Show status messages (uses config.verbose if None)</p> <code>None</code> Note <p>The cleaning is split into two parts: half dispensed into the wash vial (for exterior cleaning) and half dispensed to waste (for interior cleaning).</p> Example <p>workflow.clean_needle(volume_flush=100, wash_vial=48) Cleaning needle with 100 \u00b5L in vial 48...</p>"},{"location":"api-reference/sia-workflows/#SIA_API.methods.prepared_methods.PreparedSIMethods.system_initialization_and_cleaning","title":"system_initialization_and_cleaning","text":"<pre><code>system_initialization_and_cleaning(waste_vial: Optional[int] = None, bubble: int = 20, verbose: Optional[bool] = None) -&gt; None\n</code></pre> <p>Perform complete system initialization and cleaning procedure.</p> <p>This comprehensive procedure prepares the SI system for operation by: 1. Initializing the syringe pump 2. Flushing all lines with appropriate solvents 3. Creating separating bubbles 4. Priming transfer lines</p> <p>This should be run at the beginning of each analytical session.</p> <p>Parameters:</p> Name Type Description Default <code>waste_vial</code> <code>Optional[int]</code> <p>Waste vial number (uses config default if None)</p> <code>None</code> <code>bubble</code> <code>int</code> <p>Separating bubble volume in \u00b5L</p> <code>20</code> <code>verbose</code> <code>Optional[bool]</code> <p>Show status messages (uses config.verbose if None)</p> <code>None</code> <p>Raises:</p> Type Description <code>SystemError</code> <p>If any initialization step fails</p> Example <p>workflow.system_initialization_and_cleaning() [SI] Loading vial 50 to replenishment position... [SI] Initializing syringe pump... [SI] Flushing syringe loop... [SI] Creating 20 \u00b5L air bubble in holding coil... [SI] Flushing system with methanol (250 \u00b5L)... [SI] Flushing with DI water... [SI] Flushing transfer line... [SI] System initialization completed successfully!</p>"},{"location":"api-reference/sia-workflows/#SIA_API.methods.prepared_methods.PreparedSIMethods.prepare_continuous_flow","title":"prepare_continuous_flow","text":"<pre><code>prepare_continuous_flow(solvent_port: int, waste_vial: Optional[int] = None, bubble_volume: int = 10, solvent_holding_coil_volume: int = 10, transfer_coil_flush: int = 500, holding_coil_flush: Optional[int] = None, speed: Optional[int] = None, verbose: Optional[bool] = None) -&gt; None\n</code></pre> <p>Prepare system for continuous flow filling operations.</p> <p>Continuous flow mode maintains a continuous column of solvent from the reservoir through the holding coil to the transfer line. This mode is ideal for multiple fills with the same solvent, providing consistent flow rates and minimal air bubbles.</p> <p>Parameters:</p> Name Type Description Default <code>solvent_port</code> <code>int</code> <p>Port number connected to solvent reservoir</p> required <code>waste_vial</code> <code>Optional[int]</code> <p>Waste vial number (uses config default if None)</p> <code>None</code> <code>bubble_volume</code> <code>int</code> <p>Air bubble volume in \u00b5L for separation</p> <code>10</code> <code>solvent_holding_coil_volume</code> <code>int</code> <p>Solvent volume at end of holding coil</p> <code>10</code> <code>transfer_coil_flush</code> <code>int</code> <p>Volume for transfer coil flushing  </p> <code>500</code> <code>holding_coil_flush</code> <code>Optional[int]</code> <p>Volume for holding coil flushing (uses config default if None)</p> <code>None</code> <code>speed</code> <code>Optional[int]</code> <p>Flow rate in \u00b5L/min (uses config.speed_slow if None)</p> <code>None</code> <code>verbose</code> <code>Optional[bool]</code> <p>Show status messages (uses config.verbose if None)</p> <code>None</code> Note <p>After this preparation, use continuous_fill() for sample dispensing. The system maintains solvent continuity between fills, making it efficient for processing multiple samples with the same solvent.</p> Example <p>workflow.prepare_continuous_flow( ...     solvent_port=3,  # DI water ...     transfer_coil_flush=600 ... ) [SI] Loading vial 50 to replenishment position... [SI] Flushing holding coil with 500 \u00b5L solvent... [SI] Creating 10 \u00b5L air bubble in holding coil... [SI] System ready for continuous flow operations</p>"},{"location":"api-reference/sia-workflows/#SIA_API.methods.prepared_methods.PreparedSIMethods.prepare_batch_flow","title":"prepare_batch_flow","text":"<pre><code>prepare_batch_flow(solvent_port: int, waste_vial: Optional[int] = None, bubble_volume: int = 10, transfer_coil_volume: Optional[int] = None, coil_flush: int = 150, speed: Optional[int] = None, verbose: Optional[bool] = None) -&gt; None\n</code></pre> <p>Prepare system for batch flow (discontinuous) filling operations.</p> <p>Batch flow mode uses air-driven dispensing where the transfer line is filled with air rather than solvent. This mode is suitable for single fills or when changing solvents between operations, as it provides complete separation between different solutions.</p> <p>Parameters:</p> Name Type Description Default <code>solvent_port</code> <code>int</code> <p>Port number connected to solvent reservoir</p> required <code>waste_vial</code> <code>Optional[int]</code> <p>Waste vial number (uses config default if None)</p> <code>None</code> <code>bubble_volume</code> <code>int</code> <p>Air bubble volume in \u00b5L</p> <code>10</code> <code>transfer_coil_volume</code> <code>Optional[int]</code> <p>Transfer line volume in \u00b5L (uses config default if None)</p> <code>None</code> <code>coil_flush</code> <code>int</code> <p>Volume for coil flushing in \u00b5L</p> <code>150</code> <code>speed</code> <code>Optional[int]</code> <p>Flow rate in \u00b5L/min (uses config.speed_slow if None)</p> <code>None</code> <code>verbose</code> <code>Optional[bool]</code> <p>Show status messages (uses config.verbose if None)</p> <code>None</code> Note <p>After this preparation, use batch_fill() methods for sample dispensing. Each fill operation is independent, with air separation preventing cross-contamination between different solvents or samples.</p> Example <p>workflow.prepare_batch_flow( ...     solvent_port=3,  # DI water port ...     transfer_coil_volume=600 ... ) PREPARING BATCH FLOW (Solvent Port: 3) [SI] Loading vial 50 to replenishment position... [SI] Flushing transfer loop with 150 \u00b5L... [SI] Creating 10 \u00b5L air bubble in holding coil... [SI] Filling transfer line with 600 \u00b5L air... [SI] System ready for batch flow operations</p>"},{"location":"api-reference/sia-workflows/#SIA_API.methods.prepared_methods.PreparedSIMethods.continuous_fill","title":"continuous_fill","text":"<pre><code>continuous_fill(vial: int, volume: int, solvent_port: int, flush_needle: Optional[int] = None, wash_vial: Optional[int] = None, speed: Optional[int] = None, verbose: Optional[bool] = None) -&gt; None\n</code></pre> <p>Execute continuous flow filling operation.</p> <p>Performs sample filling using continuous solvent flow from the reservoir through the holding coil to the target vial. This method is efficient for multiple fills with the same solvent and provides consistent flow characteristics.</p> <p>Parameters:</p> Name Type Description Default <code>vial</code> <code>int</code> <p>Target vial number (1-50)</p> required <code>volume</code> <code>int</code> <p>Dispensing volume in \u00b5L</p> required <code>solvent_port</code> <code>int</code> <p>Port number connected to solvent reservoir</p> required <code>flush_needle</code> <code>Optional[int]</code> <p>Optional needle flush volume in \u00b5L (for cleaning)</p> <code>None</code> <code>wash_vial</code> <code>Optional[int]</code> <p>Vial for needle washing (uses config default if None)</p> <code>None</code> <code>speed</code> <code>Optional[int]</code> <p>Flow rate in \u00b5L/min (uses config.speed_normal if None)</p> <code>None</code> <code>verbose</code> <code>Optional[bool]</code> <p>Show status messages (uses config.verbose if None)</p> <code>None</code> Note <p>The system must first be prepared using prepare_continuous_flow(). Large volumes are automatically split into multiple syringe cycles.</p> <p>Raises:</p> Type Description <code>ValueError</code> <p>If volume is negative or vial number is invalid</p> Example <p>workflow.continuous_fill( ...     vial=15,  ...     volume=750,  ...     solvent_port=3, ...     flush_needle=50 ... ) [SI] Continuous fill: Vial 15, Volume 750 \u00b5L, Port 3 [SI] Loading vial 15 to replenishment position... [SI] Cycle 1/2: Aspirating 500 \u00b5L from port 3... [SI] Cycle 1/2: Dispensing 500 \u00b5L to vial 15... [SI] Cycle 2/2: Aspirating 300 \u00b5L from port 3... [SI] Cycle 2/2: Dispensing 250 \u00b5L, keeping 50 \u00b5L for flush... [SI] Cleaning needle with 50 \u00b5L in vial 48... [SI] Continuous fill of vial 15 completed (750 \u00b5L)</p>"},{"location":"api-reference/sia-workflows/#SIA_API.methods.prepared_methods.PreparedSIMethods.batch_fill","title":"batch_fill","text":"<pre><code>batch_fill(vial: int, volume: int, solvent_port: int, transfer_line_volume: Optional[int] = None, bubble_volume: int = 10, flush_needle: Optional[int] = None, speed: Optional[int] = None, unload: bool = True, wait: Optional[int] = None, verbose: Optional[bool] = None) -&gt; None\n</code></pre> <p>Execute batch flow (discontinuous) filling operation.</p> <p>Performs sample filling using batch (discontinuous) flow where solvent is first loaded into the holding coil with an air bubble, then pushed to the target vial using air pressure. This provides complete isolation between different solutions.</p> <p>Parameters:</p> Name Type Description Default <code>vial</code> <code>int</code> <p>Target vial number (1-50)</p> required <code>volume</code> <code>int</code> <p>Dispensing volume in \u00b5L</p> required <code>solvent_port</code> <code>int</code> <p>Port number connected to solvent reservoir</p> required <code>transfer_line_volume</code> <code>Optional[int]</code> <p>Volume of transfer line (uses config default if None)</p> <code>None</code> <code>bubble_volume</code> <code>int</code> <p>Air bubble volume for separation</p> <code>10</code> <code>flush_needle</code> <code>Optional[int]</code> <p>Optional needle flush volume in \u00b5L</p> <code>None</code> <code>speed</code> <code>Optional[int]</code> <p>Flow rate in \u00b5L/min (uses config.speed_normal if None)</p> <code>None</code> <code>unload</code> <code>bool</code> <p>Whether to unload vial after filling</p> <code>True</code> <code>wait</code> <code>Optional[int]</code> <p>Optional wait time after dispensing (seconds)</p> <code>None</code> <code>verbose</code> <code>Optional[bool]</code> <p>Show status messages (uses config.verbose if None)</p> <code>None</code> Note <p>The system must first be prepared using prepare_batch_flow(). Large volumes are automatically split into multiple cycles.</p> Example <p>workflow.batch_fill( ...     vial=20, ...     volume=400, ...     solvent_port=5,  # Methanol ...     bubble_volume=15, ...     wait=2 ... ) [SI] Batch fill: Vial 20, Volume 400 \u00b5L, Port 5 [SI] Loading vial 20 to replenishment position... [SI] Aspirating 15 \u00b5L air bubble... [SI] Cycle 1/1: Aspirating 400 \u00b5L from port 5... [SI] Cycle 1/1: Transferring to line... [SI] Dispensing air bubble... [SI] Pushing with 600 \u00b5L air at high speed... [SI] Dispensing to vial 20... [SI] Waiting 2 seconds... [SI] Batch fill of vial 20 completed (400 \u00b5L)</p>"},{"location":"api-reference/sia-workflows/#SIA_API.methods.prepared_methods.PreparedSIMethods.batch_fill_multiple_solvents","title":"batch_fill_multiple_solvents","text":"<pre><code>batch_fill_multiple_solvents(vial: int, solvent_ports: List[int], volumes: List[int], air_push_volume: int = 15, transfer_line_volume: Optional[int] = None, speed: Optional[int] = None, solvent_speeds: Optional[List[int]] = None, air_speed: Optional[int] = None, flush_needle: Optional[int] = None, wash_vial: Optional[int] = None, unload: bool = True, wait: Optional[int] = None, verbose: Optional[bool] = None) -&gt; None\n</code></pre> <p>Execute batch filling with multiple solvents from different ports.</p> <p>This advanced method allows sequential dispensing of different solvents into a single vial, with air bubble separation between each solvent. Useful for creating solvent mixtures or adding reagents in sequence.</p> <p>Parameters:</p> Name Type Description Default <code>vial</code> <code>int</code> <p>Target vial number (1-50)</p> required <code>solvent_ports</code> <code>List[int]</code> <p>List of port numbers for different solvents</p> required <code>volumes</code> <code>List[int]</code> <p>List of volumes corresponding to each port (\u00b5L)</p> required <code>air_push_volume</code> <code>int</code> <p>Air bubble volume between solvents (\u00b5L)</p> <code>15</code> <code>transfer_line_volume</code> <code>Optional[int]</code> <p>Volume for final air push (uses config default if None)</p> <code>None</code> <code>speed</code> <code>Optional[int]</code> <p>Default flow rate for liquid handling (\u00b5L/min)</p> <code>None</code> <code>solvent_speeds</code> <code>Optional[List[int]]</code> <p>Optional list of speeds for each solvent (\u00b5L/min)</p> <code>None</code> <code>air_speed</code> <code>Optional[int]</code> <p>Flow rate for air aspiration (uses config.speed_air if None)</p> <code>None</code> <code>flush_needle</code> <code>Optional[int]</code> <p>Optional needle flush volume (\u00b5L)</p> <code>None</code> <code>wash_vial</code> <code>Optional[int]</code> <p>Vial for needle washing (uses config default if None)</p> <code>None</code> <code>unload</code> <code>bool</code> <p>Whether to unload vial after filling</p> <code>True</code> <code>wait</code> <code>Optional[int]</code> <p>Optional wait time after dispensing (seconds)</p> <code>None</code> <code>verbose</code> <code>Optional[bool]</code> <p>Show status messages (uses config.verbose if None)</p> <code>None</code> <p>Raises:</p> Type Description <code>ValueError</code> <p>If port and volume lists don't match, or volumes are invalid</p> Example <p>workflow.batch_fill_multiple_solvents( ...     vial=25, ...     solvent_ports=[3, 5, 6],  # DI water, methanol, buffer ...     volumes=[300, 150, 50],   # Different volumes for each ...     solvent_speeds=[2000, 1500, 1000]  # Custom speeds ... ) [SI] Multi-solvent batch fill: Vial 25, Total volume 500 \u00b5L from 3 ports [SI] Loading vial 25 to replenishment position... [SI] Solvent 1/3: Aspirating 15 \u00b5L air bubble... [SI] Solvent 1/3: Aspirating 300 \u00b5L from port 3 at 2000 \u00b5L/min... [SI] Solvent 2/3: Aspirating 150 \u00b5L from port 5 at 1500 \u00b5L/min... [SI] Solvent 3/3: Aspirating 50 \u00b5L from port 6 at 1000 \u00b5L/min... [SI] Final air push: 600 \u00b5L at 5000 \u00b5L/min... [SI] Multi-solvent batch fill completed: 500 \u00b5L total in vial 25</p>"},{"location":"api-reference/sia-workflows/#SIA_API.methods.prepared_methods.PreparedSIMethods.prepare_for_liquid_homogenization","title":"prepare_for_liquid_homogenization","text":"<pre><code>prepare_for_liquid_homogenization(waste_vial: Optional[int] = None, transfer_line_volume: Optional[int] = None, meoh_flush_volume: Optional[int] = 20, air_bubble: Optional[int] = None, verbose: Optional[bool] = None) -&gt; None\n</code></pre> <p>Prepare system for liquid-based homogenization operations.</p> <p>This procedure flushes the transfer line and creates a protective air bubble in the holding coil. Used before liquid homogenization to ensure a clean system and prevent contamination of the holding coil.</p> <p>Parameters:</p> Name Type Description Default <code>waste_vial</code> <code>Optional[int]</code> <p>Waste vial number (uses config default if None)</p> <code>None</code> <code>transfer_line_volume</code> <code>Optional[int]</code> <p>Volume to flush from transfer line (\u00b5L)</p> <code>None</code> <code>meoh_flush_volume</code> <code>Optional[int]</code> <p>Optional methanol flush volume (\u00b5L), None to skip</p> <code>20</code> <code>air_bubble</code> <code>Optional[int]</code> <p>Air bubble volume in holding coil (\u00b5L)</p> <code>None</code> <code>verbose</code> <code>Optional[bool]</code> <p>Show status messages (uses config.verbose if None)</p> <code>None</code> Example <p>workflow.prepare_for_liquid_homogenization(verbose=True) [SI] Preparing for liquid homogenization... [SI] Loading vial 50 to replenishment position... [SI] Flushing transfer line (600 \u00b5L)... [SI] Adding methanol flush (20 \u00b5L)... [SI] Creating air bubble (30 \u00b5L) in holding coil... [SI] System ready for liquid homogenization</p>"},{"location":"api-reference/sia-workflows/#SIA_API.methods.prepared_methods.PreparedSIMethods.homogenize_by_liquid_mixing","title":"homogenize_by_liquid_mixing","text":"<pre><code>homogenize_by_liquid_mixing(vial: int, volume_aspirate: Optional[int] = None, num_cycles: Optional[int] = None, aspirate_speed: Optional[int] = None, dispense_speed: Optional[int] = None, wait_after_aspirate: Optional[float] = None, wait_after_dispense: Optional[float] = None, air_flush: Optional[int] = 10, clean_after: Optional[bool] = None, cleaning_solution_volume: Optional[int] = None, verbose: Optional[bool] = None) -&gt; None\n</code></pre> <p>Homogenize sample by liquid aspiration and dispensing.</p> <p>This gentle homogenization method mixes samples by repeatedly aspirating and dispensing liquid. It's suitable for sensitive samples that might be damaged by vigorous air bubble mixing, and provides precise control over mixing intensity.</p> <p>Parameters:</p> Name Type Description Default <code>vial</code> <code>int</code> <p>Target vial number (1-50)</p> required <code>volume_aspirate</code> <code>Optional[int]</code> <p>Volume to aspirate per cycle (\u00b5L)</p> <code>None</code> <code>num_cycles</code> <code>Optional[int]</code> <p>Number of mixing cycles</p> <code>None</code> <code>aspirate_speed</code> <code>Optional[int]</code> <p>Speed for aspiration (\u00b5L/min)</p> <code>None</code> <code>dispense_speed</code> <code>Optional[int]</code> <p>Speed for dispensing (\u00b5L/min)</p> <code>None</code> <code>wait_after_aspirate</code> <code>Optional[float]</code> <p>Wait time after aspiration (seconds)</p> <code>None</code> <code>wait_after_dispense</code> <code>Optional[float]</code> <p>Wait time after dispensing (seconds)</p> <code>None</code> <code>air_flush</code> <code>Optional[int]</code> <p>Air volume to flush at end (\u00b5L), None to skip</p> <code>10</code> <code>clean_after</code> <code>Optional[bool]</code> <p>Whether to clean transfer line after</p> <code>None</code> <code>cleaning_solution_volume</code> <code>Optional[int]</code> <p>Volume for cleaning (\u00b5L)</p> <code>None</code> <code>verbose</code> <code>Optional[bool]</code> <p>Show status messages (uses config.verbose if None)</p> <code>None</code> <p>Raises:</p> Type Description <code>ValueError</code> <p>If aspirate volume exceeds syringe capacity</p> Example <p>workflow.homogenize_by_liquid_mixing( ...     vial=15, ...     volume_aspirate=400, ...     num_cycles=3, ...     aspirate_speed=1500, ...     dispense_speed=2000, ...     verbose=True ... ) [SI] Loading vial 15 for liquid homogenization... [SI] Cycle 1/3: Aspirating 400 \u00b5L at 1500 \u00b5L/min... [SI] Cycle 1/3: Dispensing at 2000 \u00b5L/min... [SI] Cycle 2/3: Aspirating 400 \u00b5L at 1500 \u00b5L/min... [SI] Cycle 2/3: Dispensing at 2000 \u00b5L/min... [SI] Cycle 3/3: Aspirating 400 \u00b5L at 1500 \u00b5L/min... [SI] Cycle 3/3: Dispensing at 2000 \u00b5L/min... [SI] Flushing needle with 10 \u00b5L air... [SI] Liquid homogenization of vial 15 completed</p>"},{"location":"api-reference/sia-workflows/#SIA_API.methods.prepared_methods.PreparedSIMethods.homogenize_by_air_mixing","title":"homogenize_by_air_mixing","text":"<pre><code>homogenize_by_air_mixing(vial: int, volume_aspirate: Optional[int] = None, num_cycles: Optional[int] = None, aspirate_speed: Optional[int] = None, dispense_speed: Optional[int] = None, air_bubble_volume: Optional[int] = None, wait_between_cycles: float = 3.0, wait_after: float = 0, verbose: Optional[bool] = None) -&gt; None\n</code></pre> <p>Homogenize sample using air bubble mixing.</p> <p>This vigorous homogenization method creates air bubbles in the liquid for aggressive mixing. The air bubbles create turbulence and shearing forces that are effective for viscous samples or when thorough mixing is required.</p> <p>Parameters:</p> Name Type Description Default <code>vial</code> <code>int</code> <p>Target vial number (1-50)</p> required <code>volume_aspirate</code> <code>Optional[int]</code> <p>Liquid volume to aspirate per cycle (\u00b5L)</p> <code>None</code> <code>num_cycles</code> <code>Optional[int]</code> <p>Number of mixing cycles</p> <code>None</code> <code>aspirate_speed</code> <code>Optional[int]</code> <p>Speed for liquid aspiration (\u00b5L/min)</p> <code>None</code> <code>dispense_speed</code> <code>Optional[int]</code> <p>Speed for dispensing (\u00b5L/min)</p> <code>None</code> <code>air_bubble_volume</code> <code>Optional[int]</code> <p>Air volume per cycle (\u00b5L)</p> <code>None</code> <code>wait_between_cycles</code> <code>float</code> <p>Wait time between cycles for bubble mixing (seconds)</p> <code>3.0</code> <code>wait_after</code> <code>float</code> <p>Final wait time after homogenization (seconds)</p> <code>0</code> <code>verbose</code> <code>Optional[bool]</code> <p>Show status messages (uses config.verbose if None)</p> <code>None</code> <p>Raises:</p> Type Description <code>ValueError</code> <p>If total volume exceeds syringe capacity</p> Example <p>workflow.homogenize_by_air_mixing( ...     vial=22, ...     volume_aspirate=300, ...     air_bubble_volume=50, ...     num_cycles=2, ...     wait_between_cycles=8.0, ...     verbose=True ... ) [SI] Loading vial 22 for air bubble homogenization... [SI] Cycle 1/2: Aspirating 50 \u00b5L air... [SI] Cycle 1/2: Aspirating 300 \u00b5L liquid at 1500 \u00b5L/min... [SI] Cycle 1/2: Waiting 8.0 seconds for bubble mixing... [SI] Cycle 1/2: Dispensing mixture at 1500 \u00b5L/min... [SI] Cycle 2/2: Aspirating 50 \u00b5L air... [SI] Cycle 2/2: Aspirating 300 \u00b5L liquid at 1500 \u00b5L/min... [SI] Cycle 2/2: Waiting 8.0 seconds for bubble mixing... [SI] Cycle 2/2: Dispensing mixture at 1500 \u00b5L/min... [SI] Air bubble homogenization of vial 22 completed</p>"},{"location":"api-reference/sia-workflows/#SIA_API.methods.prepared_methods.PreparedSIMethods.clean_transfer_line_after_homogenization","title":"clean_transfer_line_after_homogenization","text":"<pre><code>clean_transfer_line_after_homogenization(waste_vial: Optional[int] = None, flush_volume: Optional[int] = 70, air_bubble: Optional[int] = 50, cleaning_solution_volume: Optional[int] = None, cleaning_solution_vial: Optional[int] = None, verbose: Optional[bool] = None) -&gt; None\n</code></pre> <p>Clean transfer line after homogenization operations.</p> <p>This comprehensive cleaning procedure removes sample residues from the transfer line using optional chemical cleaning followed by thorough rinsing and air bubble creation for system protection.</p> <p>Parameters:</p> Name Type Description Default <code>waste_vial</code> <code>Optional[int]</code> <p>Waste vial number (uses config default if None)</p> <code>None</code> <code>flush_volume</code> <code>Optional[int]</code> <p>Volume to flush from syringe (\u00b5L)</p> <code>70</code> <code>air_bubble</code> <code>Optional[int]</code> <p>Air bubble volume for holding coil protection (\u00b5L)</p> <code>50</code> <code>cleaning_solution_volume</code> <code>Optional[int]</code> <p>Volume of cleaning solution (\u00b5L), None to skip</p> <code>None</code> <code>cleaning_solution_vial</code> <code>Optional[int]</code> <p>Vial with cleaning solution (uses config default if None)</p> <code>None</code> <code>verbose</code> <code>Optional[bool]</code> <p>Show status messages (uses config.verbose if None)</p> <code>None</code> Example <p>workflow.clean_transfer_line_after_homogenization( ...     cleaning_solution_volume=350, ...     verbose=True ... ) [SI] Aspirating air bubble before cleaning... [SI] Loading cleaning solution vial 47... [SI] Cleaning with 350 \u00b5L solution... [SI] Waiting 3.0 seconds for cleaning reaction... [SI] Flushing 70 \u00b5L to waste... [SI] Creating 50 \u00b5L air bubble in holding coil... [SI] Transfer line cleaning completed</p>"},{"location":"api-reference/sia-workflows/#SIA_API.methods.prepared_methods.PreparedSIMethods.flush_transfer_line_to_waste","title":"flush_transfer_line_to_waste","text":"<pre><code>flush_transfer_line_to_waste(transfer_line_volume: Optional[int] = None, air_push: int = 30, verbose: Optional[bool] = None) -&gt; None\n</code></pre> <p>Quick flush of transfer line contents to waste.</p> <p>Simple utility method to empty the transfer line without chemical cleaning. Useful for quick changeovers between incompatible solvents or when removing samples before system shutdown.</p> <p>Parameters:</p> Name Type Description Default <code>transfer_line_volume</code> <code>Optional[int]</code> <p>Volume to flush (\u00b5L, uses config default if None)</p> <code>None</code> <code>air_push</code> <code>int</code> <p>Initial air volume for pushing (\u00b5L)</p> <code>30</code> <code>verbose</code> <code>Optional[bool]</code> <p>Show status messages (uses config.verbose if None)</p> <code>None</code> Example <p>workflow.flush_transfer_line_to_waste(verbose=True) [SI] Flushing transfer line to waste (600 \u00b5L)... [SI] Transfer line flushed to waste</p>"},{"location":"api-reference/sia-workflows/#SIA_API.methods.prepared_methods.PreparedSIMethods.get_system_status","title":"get_system_status","text":"<pre><code>get_system_status() -&gt; Dict[str, Any]\n</code></pre> <p>Get current system status and configuration.</p> <p>Returns:</p> Type Description <code>Dict[str, Any]</code> <p>Dictionary containing system configuration and status information</p> Example <p>status = workflow.get_system_status() print(f\"Syringe size: {status['syringe_size']} \u00b5L\") print(f\"Current speed setting: {status['config']['speed_normal']} \u00b5L/min\") print(f\"Interactive terminal: {status['interactive_terminal']}\")</p>"},{"location":"api-reference/sia-workflows/#SIA_API.methods.prepared_methods.PreparedSIMethods.update_config","title":"update_config","text":"<pre><code>update_config(**kwargs) -&gt; None\n</code></pre> <p>Update configuration parameters.</p> <p>Parameters:</p> Name Type Description Default <code>**kwargs</code> <p>Configuration parameters to update</p> <code>{}</code> Example <p>workflow.update_config( ...     speed_normal=1800, ...     verbose=False, ...     homogenization_liquid_cycles=3 ... )</p>"},{"location":"appendix/faq/","title":"Frequently Asked Questions","text":"<p>Common questions and solutions for SI-CE integration workflows.</p>"},{"location":"appendix/faq/#getting-started","title":"\ud83d\ude80 Getting Started","text":""},{"location":"appendix/faq/#what-is-si-ce","title":"What is SI-CE?","text":"<p>Quick Answer: SI-CE is a Python package that integrates Sequential Injection (SI) with Capillary Electrophoresis (CE) through Agilent ChemStation for complete laboratory automation.</p> <p>Detailed Explanation:  This comprehensive system enables:</p> <ul> <li>Automated sample preparation - Streamlined sample handling and preparation workflows</li> <li>CE instrument control - Direct communication with ChemStation for method execution</li> <li>Batch analysis workflows - Process multiple samples with minimal manual intervention  </li> <li>Complete analytical automation - End-to-end automation from sample prep to data analysis</li> </ul> <p>Related Topics: Getting Started, System Architecture</p>"},{"location":"appendix/faq/#what-hardware-is-compatible","title":"What hardware is compatible?","text":"<p>Quick Answer: The system supports Agilent CE systems with OpenLab ChemStation C.01.07 SR2 and VICI/Valco valve selectors.</p> <p>Detailed Explanation:</p> <p>Supported ChemStation Systems:</p> <ul> <li>Developed and tested on OpenLab ChemStation ver. C.01.07 SR2 [255] with CE 7100</li> <li>Interface functionality tested on other ChemStation versions, but full compatibility is not guaranteed</li> <li>Not compatible with OpenLab CDS 2.x due to absence of command processor and lack of macro support</li> </ul> <p>SIA Components:</p> <ul> <li>VICI/Valco valve selectors and switching systems</li> <li>Compatible third-party devices with similar command protocols</li> <li>Additional components can be integrated in future releases</li> </ul>"},{"location":"appendix/faq/#do-i-need-programming-experience","title":"Do I need programming experience?","text":"<p>Quick Answer: Basic Python knowledge is helpful but not required - the package includes high-level methods and copy-paste examples.</p> <p>Detailed Explanation:</p> <p>The package is designed for accessibility with:</p> <ul> <li>High-level workflow methods - Simple functions for complex operations</li> <li>Pre-built analytical procedures - Ready-to-use templates for common analyses</li> <li>Copy-paste examples - Working code snippets you can adapt immediately</li> <li>Comprehensive documentation - Detailed guides and tutorials</li> </ul> <p>AI-Assisted Development: You can leverage generative AI tools (ChatGPT, Claude, etc.) by providing them with the repository link. These tools can help you create custom methods tailored to your specific needs. However, always thoroughly test any AI-generated code before implementation in production workflows.</p> <p>Code Example: <pre><code># Simple one-line operations\nworkflow.continuous_fill(vial=15, volume=1500, solvent_port=5)\nworkflow.homogenize_sample(vial=15, speed=1000, time=30)\n</code></pre></p> <p>Related Topics: First Analysis Tutorial, Basic Operations</p>"},{"location":"appendix/faq/#communication-and-control","title":"\ud83d\udd0c Communication and Control","text":""},{"location":"appendix/faq/#how-can-i-monitor-chemstation-communication","title":"How can I monitor ChemStation communication?","text":"<p>Quick Answer: Enable verbose logging or monitor communication files directly to see all commands and responses.</p> <p>Detailed Explanation: The system uses file-based communication that can be monitored in real-time for debugging and optimization.</p> <p>Code Example: <pre><code># Enable detailed logging\nconfig = CommunicationConfig(verbose=True)\napi = ChemstationAPI(config)\n\n# Monitor communication files directly (PowerShell)\n# Get-Content \"communication_files\\command\" -Wait\n</code></pre></p> <p>Related Topics: File Protocol, Troubleshooting</p>"},{"location":"appendix/faq/#why-does-communication-occasionally-drop","title":"Why does communication occasionally drop?","text":"<p>Quick Answer: Communication drops typically occur when error dialogs appear in ChemStation or when timeout conditions aren't met.</p> <p>Detailed Explanation: Communication drops have been observed in specific cases:</p> <ol> <li> <p>Error dialog appears in ChemStation:</p> <p>May occur when starting a method while another is still running Timeout not met for command execution (see <code>validation.get_vialtable()</code> which uses higher timeout for longer macro execution) After closing the error dialog, operation can continue Always use validation before commands to ensure proper timing</p> </li> <li> <p>Communication deadlock:</p> <p>Some commands called rapidly in succession may occasionally not receive responses Common with <code>system.status()</code> when checking status repeatedly Implementation includes retry logic (3 attempts before error) If this occurs, simply restart the script</p> </li> </ol> <p>Code Example: <pre><code># Robust status checking with retry logic\ndef get_status_with_retry(api, max_retries=3):\n    for attempt in range(max_retries):\n        try:\n            return api.system.status()\n        except TimeoutError:\n            if attempt == max_retries - 1:\n                raise\n            time.sleep(1)\n</code></pre></p> <p>Related Topic: Communication Protocol</p>"},{"location":"appendix/faq/#can-i-send-custom-commands-to-chemstation","title":"Can I send custom commands to ChemStation?","text":"<p>Quick Answer: Yes, use the <code>send()</code> method to execute any valid ChemStation command directly.</p> <p>Detailed Explanation: The API provides direct access to ChemStation's command processor for advanced operations not covered by high-level methods.</p> <p>Code Example: <pre><code># Read current oven temperature\nresponse = api.send('response$ = VAL$(ObjHdrVal(RCCE1Status[1], \"Temperature_actual\"))')\nprint(f\"Current oven temperature: {response}\u00b0C\")\n\n# Get method path\nmethod_path = api.send(\"response$ = _METHPATH$\")\nprint(f\"Active method: {method_path}\")\n\n# Execute custom macro\napi.send('macro \"C:\\\\custom_macro.mac\"; custom_procedure 15, \"parameter\"')\n</code></pre></p> <p>Related Topics: ChemStation Macros, API Reference</p>"},{"location":"appendix/faq/#capillary-electrophoresis-operations","title":"\u2697\ufe0f Capillary Electrophoresis Operations","text":""},{"location":"appendix/faq/#unable-to-load-vials-into-the-carousel","title":"Unable to load vials into the carousel","text":"<p>Quick Answer: Vial loading fails when the CE system is in an incompatible state or when pressure is applied during run.</p> <p>Detailed Explanation:</p> <p>System State Issues:</p> <p>The carousel may be locked in certain states: - IDLE state: Normal operation - carousel accessible   - RUN state: Analysis in progress - carousel may be locked - Apply pressure in run: If pressure is applied at any time (including additional pressure during analysis), the carousel is locked - Other states: Carousel typically locked for safety</p> <p>Missing Vial Validation: The system cannot locate the specified vial in the carousel.</p> <p>Code Example: <pre><code># Wait for appropriate system state before vial operations\nwhile not api.is_carousel_available():\n    time.sleep(5)  # Wait for system to reach appropriate state\n\n# Validate all required vials are present before starting\nrequired_positions = [1, 2, 3, 5, 8]\nmissing_vials = carousel.validate_vials(required_positions)\nif missing_vials:\n    raise ValueError(f\"Missing vials at positions: {missing_vials}\")\n</code></pre></p> <p>Related Topics: Basic Operations, Validation Module</p>"},{"location":"appendix/faq/#can-i-modify-method-parameters-programmatically","title":"Can I modify method parameters programmatically?","text":"<p>Quick Answer: Yes, method parameters can be modified using ChemStation registry commands, though this feature is experimental.</p> <p>Detailed Explanation: Method parameters are stored in RC{module}Method[1] registers and can be modified directly. During RC.Net log analysis (see ChemStation Macros tutorial), commands for parameter modification were discovered. When these commands are executed, parameters are successfully updated. However, this approach has not been thoroughly tested.</p> <p>Code Example: <pre><code># Example: Modify separation voltage (experimental - test thoroughly)\napi.send('SetObjHdrVal RCCE1Method[1], \"Voltage\", 10')\n\n# Upload method, modify, download\napi.send('UploadRCMethod CE1')\napi.send('SetObjHdrVal RCCE1Method[1], \"Temperature\", 25')\napi.send('DownloadRCMethod CE1')\n</code></pre></p> <p>Additional Resources:</p> <ul> <li>See tutorial/chemstation_scripting section on Registry RCNET</li> <li>Reference implementation: HPLC Method Optimization GUI</li> </ul> <p>Related Topics: ChemStation Macros, Methods Module</p>"},{"location":"appendix/faq/#sequential-injection-components","title":"\ud83d\udc89 Sequential Injection Components","text":""},{"location":"appendix/faq/#can-i-integrate-additional-components","title":"Can I integrate additional components?","text":"<p>Quick Answer: Yes, additional components (stirrers, pumps, etc.) can be integrated using the common communication interface in SIA_API/Core.</p> <p>Detailed Explanation:</p> <ul> <li>The SIA_API/Core provides a common communication interface for sending and receiving commands via COM port</li> <li>Most SI components like pumps, valves, or microcontrollers (Arduino, ESP32) communicate through this interface</li> <li>To add new components, you need to identify their control commands and test them thoroughly before deployment</li> </ul> <p>Background: Current control modules were developed from the source code of CocoSoft 7.2, which could control additional components. Unfortunately, this software is no longer accessible.</p> <p>Code Example: <pre><code># Example: Adding a custom stirrer component\nclass StirrerController:\n    def __init__(self, port, baudrate=9600):\n        self.device = SerialDevice(port, baudrate)\n\n    def set_speed(self, rpm):\n        self.device.send_command(f\"SPEED {rpm}\")\n\n    def start(self):\n        self.device.send_command(\"START\")\n</code></pre></p> <p>Related Topics: Port Configuration, Device Integration</p>"},{"location":"appendix/faq/#getting-syringe-volume-tracking-errors","title":"Getting syringe volume tracking errors","text":"<p>Quick Answer: Check current syringe volume, reset tracking if needed, or perform complete reinitialization.</p> <p>Detailed Explanation:</p> <p>The API automatically tracks syringe volume but errors can occur due to: - Mismatch between actual and tracked volume - Incomplete operations - Communication interruptions</p> <p>Code Example: <pre><code># Check current syringe volume counter\nsyringe.print_volume_in_syringe()\n\n# Reset volume tracking - empty syringe completely\nsyringe.dispense()  # Empty and reset internal counter\n\n# Get actual volume and update counter\nsyringe.get_actual_volume()  # Return drawn volume and overwrite counter\n\n# Complete reinitialization\nsyringe.initialize()  # Full reset to home position\n</code></pre></p> <p>Related Topics: Basic SIA Operations, Troubleshooting</p>"},{"location":"appendix/faq/#troubleshooting-guide","title":"\ud83d\udee0\ufe0f Troubleshooting Guide","text":""},{"location":"appendix/faq/#systematic-diagnosis-approach","title":"Systematic Diagnosis Approach","text":"<p>Quick Answer: Follow the diagnostic sequence: verify connections \u2192 validate software \u2192 analyze errors \u2192 test components.</p> <p>Detailed Explanation:</p> <p>1. Verify Physical Connections</p> <ul> <li>Confirm power status on all devices</li> <li>Check cable connections and COM port assignments</li> <li>Test basic communication with each component</li> </ul> <p>2. Validate Software Prerequisites</p> <ul> <li>ChemStation running and responsive</li> <li>Required macros loaded and active</li> <li>All specified vials present in carousel</li> <li>Target methods exist and are accessible</li> </ul> <p>3. Analyze Error Messages</p> <ul> <li>Note specific exception types and error codes</li> <li>Look for recurring error patterns</li> <li>Enable verbose mode for detailed diagnostics</li> </ul> <p>Code Example: <pre><code># Component-level testing\ndef test_all_components():\n    results = {}\n\n    # Test syringe\n    try:\n        syringe.initialize()\n        results['syringe'] = \"\u2713 OK\"\n    except Exception as e:\n        results['syringe'] = f\"\u2717 Error: {e}\"\n\n    # Test valve\n    try:\n        valve.position(1)\n        results['valve'] = \"\u2713 OK\"\n    except Exception as e:\n        results['valve'] = f\"\u2717 Error: {e}\"\n\n    # Test ChemStation\n    try:\n        response = api.send(\"response$ = _METHPATH$\")\n        results['chemstation'] = f\"\u2713 OK: {response}\"\n    except Exception as e:\n        results['chemstation'] = f\"\u2717 Error: {e}\"\n\n    return results\n</code></pre></p> <p>Related Topics: Troubleshooting Guide, Error Handling</p>"},{"location":"appendix/faq/#common-issues-quick-reference","title":"Common Issues Quick Reference","text":"<p>Quick Answer: 90% of issues stem from: macro not loaded, incorrect COM ports, missing vials/methods, or insufficient timeouts.</p> <p>Most Frequent Problems:</p> <ol> <li>ChemStation macro not running \u2192 Reload macro in ChemStation command line</li> <li>Incorrect COM port configuration \u2192 Use device manager to verify port assignments  </li> <li>Missing vials or methods \u2192 Implement validation checks at workflow start</li> <li>Timeout settings too short \u2192 Increase timeout values for complex operations</li> <li>Volume tracking errors \u2192 Reset syringe and reinitialize volume counter</li> </ol> <p>Code Example: <pre><code># Complete system reset procedure\ndef full_system_reset():\n    print(\"Performing full system reset...\")\n\n    # 1. Abort any running operations\n    try:\n        api.system.abort_run()\n    except:\n        pass\n\n    # 2. Unload all vials\n    for position in [\"inlet\", \"outlet\", \"replenishment\"]:\n        try:\n            api.ce.unload_vial_from_position(position)\n        except:\n            pass\n\n    # 3. Reinitialize\n    time.sleep(5)\n    api = ChemstationAPI()\n    syringe.initialize()\n\n    return api\n</code></pre></p> <p>Related Topics: Getting Started, System Recovery</p>"},{"location":"appendix/faq/#getting-support","title":"\ud83d\udcda Getting Support","text":""},{"location":"appendix/faq/#available-resources","title":"Available Resources","text":"<ul> <li>GitHub Issues: Report bugs, request features, and track development</li> <li>Documentation: Comprehensive guides covering all package functionality</li> <li>Tutorial Examples: Working code examples for common workflows</li> </ul>"},{"location":"appendix/faq/#reporting-issues-effectively","title":"Reporting Issues Effectively","text":"<p>When requesting support, please include:</p> <ul> <li>Environment Details: Python version, package version, operating system</li> <li>Hardware Configuration: CE model, SIA components, COM port assignments  </li> <li>Error Information: Complete error messages and stack traces</li> <li>Minimal Example: Simplified code that reproduces the issue</li> <li>Context: What you were trying to accomplish and what happened instead</li> </ul> <p>Quick Resolution Tips</p> <p>Always check these fundamentals first: 1. ChemStation macro properly loaded and running 2. COM port conflicts or incorrect assignments 3. Missing physical components (vials, methods) 4. Insufficient timeout values for complex operations</p>"},{"location":"chemstation-api/basic-operations/","title":"Basic ChemStation Operations","text":"<p>This guide covers the most common operations for chemstation, konkr\u00e9tn\u011b pro CE</p>"},{"location":"chemstation-api/basic-operations/#initializing-the-api","title":"Initializing the API","text":"<pre><code>from ChemstationAPI import ChemstationAPI\n\n# Basic initialization\napi = ChemstationAPI()\n\nrozd\u011blit na 2 okna\n# With custom configuration\nfrom ChemstationAPI.core.communication_config import CommunicationConfig\n\nconfig = CommunicationConfig(verbose=True, test_on_init=False)\napi = ChemstationAPI(config)\n</code></pre>"},{"location":"chemstation-api/basic-operations/#vial-management","title":"Vial Management","text":""},{"location":"chemstation-api/basic-operations/#understanding-vial-positions","title":"Understanding Vial Positions","text":"<p>The CE system has several vial locations:</p> <ul> <li>Carousel: 48 positions for samples (1-48) + special positions</li> <li>Inlet: Sample injection position (positive electrode)</li> <li>Outlet: Waste collection position (negative electrode)</li> <li>Replenishment: Buffer replenishment position</li> </ul>"},{"location":"chemstation-api/basic-operations/#loading-and-unloading-vials","title":"Loading and Unloading Vials","text":"<pre><code># Load vial to inlet for analysis\napi.ce.load_vial_to_position(vial=15, position=\"inlet\")\n\n# Load waste vial to outlet\napi.ce.load_vial_to_position(vial=48, position=\"outlet\")\n\n# Load buffer vial for replenishment\napi.ce.load_vial_to_position(vial=49, position=\"replenishment\")\n\n# Return vial to carousel\napi.ce.unload_vial_from_position(\"inlet\")\n</code></pre>"},{"location":"chemstation-api/basic-operations/#checking-vial-status","title":"Checking Vial Status","text":"<pre><code># Check where a vial is located\nstate = api.ce.get_vial_state(15)\nprint(f\"Vial 15 is at: {state}\")\n# Possible states: \"carousel\", \"inlet\", \"outlet\", \"replenishment\", \"out_system\"\n\n# Check all vial positions\nvial_table = api.validation.get_vialtable()\nfor position, present in vial_table.items():\n    if present:\n        print(f\"Vial present at position {position}\")\n</code></pre>"},{"location":"chemstation-api/basic-operations/#capillary-operations","title":"Capillary Operations","text":""},{"location":"chemstation-api/basic-operations/#capillary-conditioning","title":"Capillary Conditioning","text":"<pre><code># Standard 1-minute flush at high pressure\napi.ce.flush_capillary(time_flush=60.0)\n\n# Quick bubble removal\napi.ce.flush_capillary(time_flush=10.0)\n\n# Long conditioning for new capillary\napi.ce.flush_capillary(time_flush=300.0)  # 5 minutes\n</code></pre>"},{"location":"chemstation-api/basic-operations/#pressure-operations","title":"Pressure Operations","text":"<pre><code># Hydrodynamic injection (50 mbar for 5 seconds)\napi.ce.apply_pressure_to_capillary(pressure=50.0, time_pressure=5.0)\n\n# Gentle conditioning\napi.ce.apply_pressure_to_capillary(pressure=25.0, time_pressure=30.0)\n\n# Vacuum application\napi.ce.apply_pressure_to_capillary(pressure=-50.0, time_pressure=10.0)\n</code></pre>"},{"location":"chemstation-api/basic-operations/#method-operations","title":"Method Operations","text":""},{"location":"chemstation-api/basic-operations/#loading-methods","title":"Loading Methods","text":"<pre><code># Load method from default directory\napi.method.load(\"CE_Standard_Method\")\n\n# Load from specific directory\napi.method.load(\"TestMethod\", method_path=\"C:\\\\Methods\\\\Development\\\\\")\n</code></pre>"},{"location":"chemstation-api/basic-operations/#running-methods","title":"Running Methods","text":"<pre><code># Simple method execution\napi.method.run(\"Sample_001\")\n\n# Run with custom data directory\napi.method.run(\"Sample_001\", data_dir=\"C:\\\\Data\\\\Project_X\\\\\")\n\n# Run with all parameters\napi.method.execution_method_with_parameters(\n    vial=15,\n    method_name=\"CE_Protein_Analysis\",\n    sample_name=\"BSA_1mg_ml\",\n    comment=\"pH 8.5 buffer\",\n    subdirectory_name=\"Protein_Study\"\n)\n</code></pre>"},{"location":"chemstation-api/basic-operations/#saving-methods","title":"Saving Methods","text":"<pre><code># Save current method with new name\napi.method.save(\"Modified_Method\", comment=\"Increased voltage to 25kV\")\n\n# Overwrite current method\napi.method.save()\n</code></pre>"},{"location":"chemstation-api/basic-operations/#system-monitoring","title":"System Monitoring","text":""},{"location":"chemstation-api/basic-operations/#check-system-status","title":"Check System Status","text":"<pre><code># Is method running?\nif api.system.method_on():\n    print(\"Analysis in progress\")\nelse:\n    print(\"System idle\")\n\n# Get detailed status\nstatus = api.system.status()\nprint(f\"Current status: {status}\")\n# Returns: \"STANDBY\", \"PRERUN\", \"RUN\", \"POSTRUN\", etc.\n\n# Check CE module status\nrc_status = api.system.RC_status()\nprint(f\"CE module: {rc_status}\")\n# Returns: \"Idle\", \"Run\", \"NotReady\", \"Error\"\n</code></pre>"},{"location":"chemstation-api/basic-operations/#monitor-analysis-progress","title":"Monitor Analysis Progress","text":"<pre><code># Real-time monitoring\nwhile api.system.method_on():\n    elapsed = api.system.get_elapsed_analysis_time()\n    total = api.system.get_analysis_time()\n    remaining = api.system.get_remaining_analysis_time()\n\n    progress = (elapsed / total) * 100 if total &gt; 0 else 0\n    print(f\"Progress: {progress:.1f}% - {remaining:.1f} min remaining\")\n\n    time.sleep(30)  # Update every 30 seconds\n\nprint(\"Analysis complete!\")\n</code></pre>"},{"location":"chemstation-api/basic-operations/#validation-operations","title":"Validation Operations","text":""},{"location":"chemstation-api/basic-operations/#pre-flight-checks","title":"Pre-flight Checks","text":"<pre><code># Validate before starting analysis\ndef prepare_for_analysis(sample_vial, waste_vial, method_name):\n    # Check vials are present\n    api.validation.validate_vial_in_system(sample_vial)\n    api.validation.validate_vial_in_system(waste_vial)\n\n    # Check method exists\n    api.validation.validate_method_name(method_name)\n\n    # Check carousel is available\n    api.validation.validate_use_carousel()\n\n    # Check system is ready\n    if api.system.status() != \"STANDBY\":\n        raise SystemError(\"System not ready\")\n\n    print(\"All checks passed - ready for analysis!\")\n\n# Use the validation\nprepare_for_analysis(15, 48, \"CE_Standard_Method\")\n</code></pre>"},{"location":"chemstation-api/basic-operations/#batch-validation","title":"Batch Validation","text":"<pre><code># Validate multiple vials for sequence\nsample_vials = [10, 11, 12, 13, 14, 15]\napi.validation.list_vial_validation(sample_vials)\nprint(\"All sample vials present\")\n</code></pre>"},{"location":"chemstation-api/basic-operations/#direct-chemstation-commands","title":"Direct ChemStation Commands","text":"<p>For advanced operations, send commands directly:</p> <pre><code># Get system paths\nmethod_path = api.send(\"response$ = _METHPATH$\")\ndata_path = api.send(\"response$ = _DATAPATH$\")\nprint(f\"Methods: {method_path}\")\nprint(f\"Data: {data_path}\")\n\n# Get current voltage\nvoltage = api.send('response$ = VAL$(ObjHdrVal(RCCE1Status[1], \"Voltage_actual\"))')\nprint(f\"Current voltage: {voltage} kV\")\n\n# Execute custom macro\napi.send('macro \"C:\\\\custom_macro.mac\"; custom_procedure 15, \"parameter\"')\n</code></pre>"},{"location":"chemstation-api/basic-operations/#complete-analysis-example","title":"Complete Analysis Example","text":"<p>Here's a complete workflow for a single sample:</p> <pre><code>def analyze_sample(sample_vial, sample_name, method_name):\n    \"\"\"Complete analysis workflow for a single sample.\"\"\"\n\n    # 1. Validate prerequisites\n    print(\"Validating system...\")\n    api.validation.validate_vial_in_system(sample_vial)\n    api.validation.validate_vial_in_system(48)  # waste vial\n    api.validation.validate_method_name(method_name)\n\n    # 2. Wait for system ready\n    print(\"Waiting for system...\")\n    if not api.system.wait_for_ready(timeout=60):\n        raise TimeoutError(\"System not ready\")\n\n    # 3. Load vials\n    print(\"Loading vials...\")\n    api.ce.load_vial_to_position(sample_vial, \"inlet\")\n    api.ce.load_vial_to_position(48, \"outlet\")\n\n    # 4. Condition capillary\n    print(\"Conditioning capillary...\")\n    api.ce.flush_capillary(30.0)\n\n    # 5. Load and run method\n    print(f\"Running analysis for {sample_name}...\")\n    api.method.load(method_name)\n    api.method.run(sample_name)\n\n    # 6. Monitor progress\n    while api.system.method_on():\n        remaining = api.system.get_remaining_analysis_time()\n        print(f\"  {remaining:.1f} minutes remaining\", end='\\r')\n        time.sleep(10)\n\n    # 7. Return vials\n    print(\"\\nCleaning up...\")\n    api.ce.unload_vial_from_position(\"inlet\")\n    api.ce.unload_vial_from_position(\"outlet\")\n\n    print(f\"Analysis of {sample_name} complete!\")\n\n# Run the analysis\nanalyze_sample(\n    sample_vial=15,\n    sample_name=\"Test_Sample_001\",\n    method_name=\"CE_Standard_Method\"\n)\n</code></pre>"},{"location":"chemstation-api/basic-operations/#tips-for-efficient-operation","title":"Tips for Efficient Operation","text":"<ol> <li> <p>Always validate before operations <pre><code># Good practice\napi.validation.validate_vial_in_system(vial)\napi.ce.load_vial_to_position(vial, \"inlet\")\n</code></pre></p> </li> <li> <p>Monitor system state <pre><code># Wait between operations\nwhile api.system.status() != \"STANDBY\":\n    time.sleep(5)\n</code></pre></p> </li> </ol> <p>je\u0161t\u011b n\u011bco p\u0159idej</p> <p>Next Steps</p> <p>Learn about Methods and Sequences for batch analysis automation.</p>"},{"location":"chemstation-api/file-protocol/","title":"File-Based Communication Protocol","text":"<p>Understanding how Python communicates with ChemStation is essential for troubleshooting, optimization, and advanced usage. This guide explains the robust file-based protocol that enables reliable command execution between Python and ChemStation.</p>"},{"location":"chemstation-api/file-protocol/#protocol-overview","title":"Protocol Overview","text":"<p>The ChemStation API uses a file-based communication protocol to ensure reliable, bidirectional communication between Python and ChemStation. This approach provides superior reliability compared to direct socket connections, especially in Windows environments where COM interfaces can be unstable.</p>"},{"location":"chemstation-api/file-protocol/#design-inspiration","title":"Design Inspiration","text":"<p>This communication protocol is adapted and enhanced from the excellent work by the Cronin Group at the University of Glasgow. The original implementation can be found at: https://github.com/croningp/analyticallabware/tree/master/AnalyticalLabware/devices/Agilent</p> <p>Our implementation extends this foundation with additional error handling, timeout management, and CE-specific optimizations.</p>"},{"location":"chemstation-api/file-protocol/#how-it-works","title":"How It Works","text":""},{"location":"chemstation-api/file-protocol/#communication-architecture","title":"Communication Architecture","text":"<p>The protocol operates through two files that act as communication channels between Python and ChemStation:</p> <ul> <li>Command File - Python writes commands here</li> <li>Response File - ChemStation writes responses here  </li> <li>ChemStation Macro - Monitors and executes commands continuously</li> </ul>"},{"location":"chemstation-api/file-protocol/#step-by-step-process","title":"Step-by-Step Process","text":"<ol> <li>Command Writing: Python formats the command with a unique number and writes it to the command file</li> <li>Macro Polling: The ChemStation macro continuously monitors the command file every 200 milliseconds</li> <li>Command Detection: When a new command is detected (higher number than previous), the macro reads it</li> <li>Execution: The macro sends the command to ChemStation's Command Processor for execution</li> <li>Response Writing: Results are written to the response file with the matching command number</li> <li>Response Reading: Python reads the response file and matches the response to the original command</li> </ol>"},{"location":"chemstation-api/file-protocol/#command-format-and-structure","title":"Command Format and Structure","text":""},{"location":"chemstation-api/file-protocol/#basic-commands-no-return-value","title":"Basic Commands (No Return Value)","text":"<p>For commands that perform actions without returning data:</p> <pre><code># Python code\napi.send(\"LoadMethod _METHPATH$, MyMethod.M\")\n\n# Command file content\n123 LoadMethod _METHPATH$, MyMethod.M\n\n# Response file content (indicates successful execution)\n123 None\n</code></pre>"},{"location":"chemstation-api/file-protocol/#commands-with-return-values","title":"Commands with Return Values","text":"<p>To capture return values, prefix the command with <code>response$ =</code>:</p> <pre><code># Python code\nmethod_path = api.send(\"response$ = _METHPATH$\")\nprint(f\"Current method path: {method_path}\")\n\n# Command file content\n124 response$ = _METHPATH$\n\n# Response file content\n124 C:\\Chem32\\1\\Methods\\CE\\Default\\\n</code></pre>"},{"location":"chemstation-api/file-protocol/#complex-commands-with-parameters","title":"Complex Commands with Parameters","text":"<pre><code># Setting system variables\napi.send('_SAMPLE$ = \"Sample_001\"')\n\n# Executing methods with parameters  \napi.send('RunMethod _DATAPATH$,, _SAMPLE$')\n\n# Querying instrument status\nstatus = api.send(\"response$ = VAL$(_MethodOn)\")\nis_running = bool(int(status))\n</code></pre>"},{"location":"chemstation-api/file-protocol/#command-numbering-system","title":"Command Numbering System","text":""},{"location":"chemstation-api/file-protocol/#sequential-numbering","title":"Sequential Numbering","text":"<p>The protocol uses sequential command numbers to ensure proper command-response matching:</p> <ul> <li>Range: Numbers increment from 1 to a configurable maximum (default: 256)</li> <li>Wraparound: Automatically resets to 1 after reaching maximum</li> <li>Uniqueness: Each command gets a unique number within the cycle</li> <li>Synchronization: Prevents response mixing from multiple concurrent commands</li> </ul>"},{"location":"chemstation-api/file-protocol/#numbering-example","title":"Numbering Example","text":"<pre><code># Example command sequence\n1 response$ = _METHPATH$                    # Get method path\n2 LoadMethod _METHPATH$, Test.M            # Load method\n3 response$ = VAL$(_MethodOn)              # Check method status\n4 RunMethod _DATAPATH$,, Sample001         # Run analysis\n...\n255 response$ = ACQSTATUS$                 # Check acquisition\n256 Print \"Analysis complete\"               # Final command\n1 response$ = _DATAPATH$                   # Wraps back to 1\n</code></pre>"},{"location":"chemstation-api/file-protocol/#synchronization-benefits","title":"Synchronization Benefits","text":"<ul> <li>Prevents confusion when multiple commands are sent rapidly</li> <li>Enables debugging by tracking specific command execution</li> <li>Supports concurrent operations without response mixing</li> <li>Provides error isolation for failed commands</li> </ul>"},{"location":"chemstation-api/file-protocol/#file-locations-and-structure","title":"File Locations and Structure","text":""},{"location":"chemstation-api/file-protocol/#default-file-structure","title":"Default File Structure","text":"<pre><code>SIA-CE/\n\u2514\u2500\u2500 ChemstationAPI/\n    \u2514\u2500\u2500 core/\n        \u251c\u2500\u2500 ChemPyConnect.mac              # ChemStation macro\n        \u251c\u2500\u2500 communication_config.py        # Configuration module\n        \u2514\u2500\u2500 communication_files/           # Communication directory\n            \u251c\u2500\u2500 command                   # Commands from Python \u2192 ChemStation\n            \u2514\u2500\u2500 response                  # Responses from ChemStation \u2192 Python\n</code></pre>"},{"location":"chemstation-api/file-protocol/#file-content-examples","title":"File Content Examples","text":"<p>Command File Format: <pre><code>125 response$ = _METHPATH$\n</code></pre></p> <p>Response File Format: <pre><code>125 C:\\Chem32\\1\\Methods\\CE\\Migration\\\n</code></pre></p>"},{"location":"chemstation-api/file-protocol/#monitoring-and-debugging","title":"Monitoring and Debugging","text":""},{"location":"chemstation-api/file-protocol/#enable-verbose-communication-logging","title":"Enable Verbose Communication Logging","text":"<pre><code>from ChemstationAPI.core.communication_config import CommunicationConfig\nfrom ChemstationAPI import ChemstationAPI\n\n# Create configuration with verbose output\nconfig = CommunicationConfig(verbose=True)\napi = ChemstationAPI(config)\n\n# All commands and responses will be logged\nmethod_path = api.send(\"response$ = _METHPATH$\")\n\n# Console output:\n# Sending command 1: response$ = _METHPATH$\n# Received response 1: C:\\Chem32\\1\\Methods\\CE\\Migration\\\n</code></pre>"},{"location":"chemstation-api/file-protocol/#error-handling-and-recovery","title":"Error Handling and Recovery","text":""},{"location":"chemstation-api/file-protocol/#timeout-management","title":"Timeout Management","text":"<pre><code># Standard timeout (5 seconds default)\napi.send(\"LoadMethod _METHPATH$, MyMethod.M\")\n\n# Extended timeout for long operations\napi.send(\"RunMethod _DATAPATH$,, Sample001\", timeout=300.0)  # 5 minutes\n\n# Short timeout for quick checks\nstatus = api.send(\"response$ = VAL$(_MethodOn)\", timeout=1.0)\n</code></pre>"},{"location":"chemstation-api/file-protocol/#chemstation-error-detection","title":"ChemStation Error Detection","text":"<p>The API automatically detects and handles ChemStation errors:</p> <pre><code>try:\n    # Attempt to load non-existent method\n    api.send(\"LoadMethod _METHPATH$, NonExistentMethod.M\")\n\nexcept ChemstationError as e:\n    print(f\"ChemStation Error: {e}\")\n    # Output: ChemStation Error: ERROR: Method file 'NonExistentMethod.M' not found\n\ntry:\n    # Invalid command syntax\n    api.send(\"InvalidCommandSyntax parameter1 parameter2\")\n\nexcept ChemstationError as e:\n    print(f\"Command Error: {e}\")\n    # Output: Command Error: ERROR: Command 'InvalidCommandSyntax' not recognized\n</code></pre>"},{"location":"chemstation-api/file-protocol/#troubleshooting-common-issues","title":"Troubleshooting Common Issues","text":""},{"location":"chemstation-api/file-protocol/#no-response-received-timeouterror","title":"No Response Received (TimeoutError)","text":"<p>Symptoms: - Commands timeout without receiving responses - <code>TimeoutError: No response received within X seconds</code></p> <p>Diagnostic Steps: 1. Verify macro status: <pre><code># Test basic communication\ntry:\n    api.send(\"Print 'Test'\", timeout=1.0)\n    print(\"\u2713 Macro is running\")\nexcept TimeoutError:\n    print(\"\u2717 Macro not responding\")\n</code></pre></p> <ol> <li>Check file permissions: <pre><code>import os\n\ncomm_dir = \"core/communication_files\"\ncmd_file = os.path.join(comm_dir, \"command\")\nresp_file = os.path.join(comm_dir, \"response\")\n\nprint(f\"Command file writable: {os.access(cmd_file, os.W_OK)}\")\nprint(f\"Response file readable: {os.access(resp_file, os.R_OK)}\")\n</code></pre></li> </ol>"},{"location":"chemstation-api/file-protocol/#wrong-response-received","title":"Wrong Response Received","text":"<p>Symptoms: - Responses don't match sent commands - Intermittent incorrect data</p> <p>Solutions: 1. Reset command numbering: <pre><code># Force reset communication state\napi = ChemstationAPI()  # Creates fresh instance\n</code></pre></p> <ol> <li>Check for multiple Python instances:</li> <li>Ensure only one Python script is communicating with ChemStation</li> <li>Close other instances that might be interfering</li> </ol>"},{"location":"chemstation-api/file-protocol/#slow-communication-performance","title":"Slow Communication Performance","text":"<p>Symptoms: - Commands take longer than expected - Overall system feels sluggish</p> <p>Optimization Steps: 1. Reduce polling delay: <pre><code>config = CommunicationConfig(retry_delay=0.05)  # Faster polling\n</code></pre></p> <ol> <li>Check system performance:</li> <li>Monitor disk I/O during communication</li> <li>Ensure antivirus isn't scanning communication files</li> <li>Check ChemStation system resource usage</li> </ol>"},{"location":"chemstation-api/file-protocol/#file-access-issues","title":"File Access Issues","text":"<p>Symptoms: - Permission denied errors - Unable to create communication files</p> <p>Solutions: 1. Run as Administrator: Right-click Python IDE and select \"Run as administrator\" 2. Check directory permissions: Ensure communication directory has full read/write access 3. Antivirus exclusion: Add communication directory to antivirus exclusions</p>"},{"location":"chemstation-api/file-protocol/#protocol-best-practices","title":"Protocol Best Practices","text":""},{"location":"chemstation-api/file-protocol/#efficient-command-execution","title":"Efficient Command Execution","text":"<pre><code># Batch related commands together\napi.send(\"LoadMethod _METHPATH$, MyMethod.M\")\napi.send('_SAMPLE$ = \"Sample_001\"')  \napi.send(\"RunMethod _DATAPATH$,, _SAMPLE$\")\n\n# Use appropriate timeouts\nquick_status = api.send(\"response$ = VAL$(_MethodOn)\", timeout=1.0)\nmethod_result = api.send(\"RunMethod _DATAPATH$,, Sample\", timeout=300.0)\n</code></pre>"},{"location":"chemstation-api/file-protocol/#error-prevention","title":"Error Prevention","text":"<pre><code># Always validate before execution\ndef safe_method_execution(api, method_name, sample_name):\n    \"\"\"Safely execute method with validation\"\"\"\n\n    # Check if method exists\n    try:\n        api.send(f\"LoadMethod _METHPATH$, {method_name}\")\n    except ChemstationError:\n        raise ValueError(f\"Method '{method_name}' not found\")\n\n    # Set sample name\n    api.send(f'_SAMPLE$ = \"{sample_name}\"')\n\n    # Execute with extended timeout\n    api.send(\"RunMethod _DATAPATH$,, _SAMPLE$\", timeout=1800.0)\n\n    return True\n</code></pre> <p>Protocol Reliability</p> <p>The file-based protocol is extremely reliable once properly configured. Most communication issues stem from: 1. Macro not running - Always verify macro status first 2. File permission problems - Ensure proper directory access 3. Multiple Python instances - Avoid concurrent communication attempts</p> <p>Performance Considerations</p> <p>While file-based communication adds slight overhead compared to direct connections, the reliability benefits far outweigh the minimal performance impact. Typical command execution times are 50-200ms depending on command complexity.</p>"},{"location":"chemstation-api/introduction/","title":"ChemStation API Introduction","text":""},{"location":"chemstation-api/introduction/#what-is-the-chemstation-api","title":"What is the ChemStation API?","text":"<p>The ChemStation API provides a comprehensive Python interface for controlling Agilent ChemStation software and CE instruments. It enables complete automation of capillary electrophoresis systems, eliminating the need for manual intervention in routine analytical workflows.</p>"},{"location":"chemstation-api/introduction/#communication-architecture","title":"Communication Architecture","text":"<p>The API operates by sending commands directly to ChemStation's Command Processor (CP). This approach provides:</p> <ul> <li>Direct instrument control through ChemStation's native command structure</li> <li>Simplified operation with pre-built command functions for common tasks</li> <li>Reliable communication via file-based protocol between Python and ChemStation</li> </ul>"},{"location":"chemstation-api/introduction/#development-focus-and-compatibility","title":"Development Focus and Compatibility","text":"<p>While the API is designed as a general ChemStation interface, it has been specifically developed and optimized for Capillary Electrophoresis applications. Many commands and workflows are tailored for CE operations, though the underlying architecture supports broader ChemStation functionality.</p> <p>Testing and Compatibility:</p> <ul> <li>Tested on: ChemStation version C.01.07 SR2 [255]</li> <li>Expected compatibility: Other ChemStation versions should work but have not been extensively tested</li> <li>Requirements: ChemStation must be running with the specialized communication macro loaded</li> </ul> <p>Prerequisites</p> <p>The API requires ChemStation to be running with a special communication macro. See the Getting Started guide for setup instructions.</p>"},{"location":"chemstation-api/introduction/#key-capabilities","title":"Key Capabilities","text":""},{"location":"chemstation-api/introduction/#ce-instrument-control","title":"CE Instrument Control","text":"<p>Vial and Sample Management: - Load and unload vials from carousel to analysis positions (inlet/outlet) - Control vial positioning with precision and error checking - Monitor vial presence and validate positions before operations</p> <p>Capillary Operations: - Automated capillary conditioning and flushing protocols - Pressure-based sample injection with customizable parameters - Rinse cycles and maintenance procedures</p> <p>System Monitoring: - Real-time instrument status monitoring - Position tracking for all moveable components - System readiness validation before operations</p>"},{"location":"chemstation-api/introduction/#method-management","title":"Method Management","text":"<p>Method Operations: - Load existing methods from ChemStation method database - Execute methods with sample-specific information and parameters - Save modified methods with custom settings - Validate method existence before execution</p> <p>Parameter Control: - Modify injection parameters (time, pressure, volume) - Adjust separation conditions (voltage, temperature) - Configure detection settings and data acquisition parameters</p>"},{"location":"chemstation-api/introduction/#sequence-operations","title":"Sequence Operations","text":"<p>Sequence Management: - Load and save sequence files from ChemStation database - Modify sequence tables programmatically - Import sequence tables from Excel spreadsheets with validation - Export results and sequence data for external processing</p> <p>Execution Control: - Start, pause, and resume sequence execution - Monitor sequence progress with real-time updates - Handle sequence interruptions and error recovery - Generate execution reports and logs</p>"},{"location":"chemstation-api/introduction/#system-monitoring-and-control","title":"System Monitoring and Control","text":"<p>Real-Time Status: - Continuous monitoring of instrument status and health - Analysis progress tracking with time estimates - Temperature, pressure, and voltage monitoring - Error detection with detailed diagnostic information</p> <p>State Management: - System readiness validation before starting operations - Automatic state recovery after interruptions - Preventive checks to avoid operational conflicts</p>"},{"location":"chemstation-api/introduction/#how-it-works","title":"How It Works","text":"<p>The ChemStation API uses a sophisticated communication protocol to bridge Python and ChemStation:</p>"},{"location":"chemstation-api/introduction/#communication-flow","title":"Communication Flow","text":"<ol> <li>Command Initiation: Python sends a command through the API</li> <li>Protocol Translation: The command is formatted for ChemStation's Command Processor</li> <li>File-Based Transfer: Commands are written to communication files monitored by ChemStation</li> <li>Macro Processing: A specialized macro in ChemStation reads commands and executes them</li> <li>Response Generation: ChemStation writes responses back to communication files</li> <li>Python Integration: The API reads responses and returns results to Python</li> </ol>"},{"location":"chemstation-api/introduction/#architecture-benefits","title":"Architecture Benefits","text":"<ul> <li>Reliability: File-based communication eliminates connection timeouts</li> <li>Bidirectional: Full command and response capabilities</li> <li>Error Handling: Comprehensive error detection and reporting</li> <li>State Synchronization: Maintains consistent state between Python and ChemStation</li> </ul>"},{"location":"chemstation-api/introduction/#core-components","title":"Core Components","text":""},{"location":"chemstation-api/introduction/#chemstationapi-class","title":"ChemstationAPI Class","text":"<p>The main entry point providing organized access to all functionality:</p> <pre><code>from ChemstationAPI import ChemstationAPI\n\n# Initialize connection to ChemStation\napi = ChemstationAPI()\n\n# Access specialized modules\nce_operations = api.ce\nmethod_control = api.method\nsequence_management = api.sequence\n</code></pre>"},{"location":"chemstation-api/introduction/#functional-modules","title":"Functional Modules","text":"<p>CE Module (<code>api.ce</code>) - Vial handling operations (load, unload, positioning) - Capillary conditioning and maintenance procedures - Pressure control for injection and flushing - Position monitoring and validation</p> <p>Methods Module (<code>api.method</code>) - Method loading from ChemStation database - Method execution with custom parameters - Method saving and modification - Parameter validation and error checking</p> <p>Sequence Module (<code>api.sequence</code>) - Sequence table management and editing - Excel integration for batch import/export - Sequence execution control (start/pause/resume) - Progress monitoring and reporting</p> <p>System Module (<code>api.system</code>) - Real-time status monitoring and health checks - Analysis progress tracking with time estimates - System control (start/stop operations) - Error detection and diagnostic reporting</p> <p>Validation Module (<code>api.validation</code>) - Pre-operation checks for vials, methods, and files - System state verification before critical operations - File existence validation for methods and sequences - Comprehensive error prevention</p>"},{"location":"chemstation-api/introduction/#typical-workflow-example","title":"Typical Workflow Example","text":"<pre><code>from ChemstationAPI import ChemstationAPI\nimport time\n\n# Initialize ChemStation connection\napi = ChemstationAPI()\n\n# Pre-operation validation\nprint(\"Validating prerequisites...\")\napi.validation.validate_vial_in_system(15)         # Check sample vial\napi.validation.validate_vial_in_system(48)         # Check buffer vial  \napi.validation.validate_method_name(\"CE_Analysis\") # Verify method exists\n\n# Prepare instrument for analysis\nprint(\"Preparing instrument...\")\napi.ce.load_vial_to_position(15, \"inlet\")   # Load sample to inlet\napi.ce.load_vial_to_position(48, \"outlet\")  # Load buffer to outlet\n\n# Condition capillary\nprint(\"Conditioning capillary...\")\napi.ce.flush_capillary(duration=60.0, pressure=950)  # 60-second flush\n\n# Execute analysis\nprint(\"Starting analysis...\")\napi.method.execute_method_with_parameters(\n    vial=15,\n    method_name=\"CE_Analysis\", \n    sample_name=\"Sample_001\",\n    injection_time=5.0\n)\n\n# Monitor progress\nprint(\"Monitoring analysis progress...\")\nwhile api.system.method_on():\n    remaining = api.system.get_remaining_analysis_time()\n    current_step = api.system.get_current_method_step()\n    print(f\"Step: {current_step}, Time remaining: {remaining:.1f} minutes\")\n    time.sleep(30)  # Update every 30 seconds\n\nprint(\"Analysis complete!\")\n\n# Optional: Retrieve results\nresults = api.system.get_analysis_results()\nprint(f\"Analysis completed successfully. Peak count: {results.peak_count}\")\n</code></pre>"},{"location":"chemstation-api/introduction/#key-benefits","title":"Key Benefits","text":""},{"location":"chemstation-api/introduction/#complete-automation","title":"Complete Automation","text":"<p>Eliminate Manual Operations: - No manual vial loading or positioning required - Automated capillary conditioning and maintenance - Hands-free method execution and monitoring</p> <p>Large-Scale Processing: - Process hundreds of samples with minimal supervision - Batch operations with error recovery and resume capabilities - Parallel sample preparation while analysis is running</p>"},{"location":"chemstation-api/introduction/#enhanced-reproducibility","title":"Enhanced Reproducibility","text":"<p>Standardized Workflows: - Consistent method execution across all analyses - Identical conditioning and preparation procedures - Traceable operations with comprehensive logging</p> <p>Quality Control: - Pre-operation validation prevents common errors - Automated checks ensure optimal system conditions - Detailed error reporting for troubleshooting</p>"},{"location":"chemstation-api/introduction/#flexible-integration","title":"Flexible Integration","text":"<p>System Connectivity: - Integrate with SIA systems for sample preparation - Connect to external pumps and preparation equipment - Interface with LIMS and data management systems</p> <p>Custom Workflows: - Create specialized analytical procedures - Implement adaptive methods based on sample properties - Develop method optimization routines</p>"},{"location":"chemstation-api/introduction/#operational-efficiency","title":"Operational Efficiency","text":"<p>Increased Throughput: - Parallel sample preparation during analysis - Reduced setup and transition times - Optimized instrument utilization</p> <p>Resource Optimization: - Minimized reagent consumption through precise control - Reduced analyst time requirements - Lower operational costs per sample</p>"},{"location":"chemstation-api/introduction/#getting-started","title":"Getting Started","text":"<p>Ready to implement automated CE analysis? Follow these steps:</p> <ol> <li>Installation Setup - Configure your system and install required components</li> <li>File Protocol Overview - Understand the communication mechanism</li> <li>Basic Operations - Learn fundamental CE control functions</li> <li>Advanced Workflows - Explore sophisticated automation patterns</li> </ol> <p>Development Approach</p> <p>Start with simple operations like vial loading and method execution before implementing complex batch workflows. The modular design allows incremental automation development.</p> <p>Support and Community</p> <p>For technical support, feature requests, or to share your automation workflows, visit the project repository or check the troubleshooting guide.</p>"},{"location":"chemstation-api/methods-sequences/","title":"Methods and Sequences","text":"<p>Learn how to work with CE methods and create automated sequences for batch analysis.</p>"},{"location":"chemstation-api/methods-sequences/#understanding-methods","title":"Understanding Methods","text":"<p>CE methods define all analytical parameters: - Voltage and current settings - Temperature control - Injection parameters - Detection wavelengths - Time programs - Data acquisition settings</p>"},{"location":"chemstation-api/methods-sequences/#method-management","title":"Method Management","text":""},{"location":"chemstation-api/methods-sequences/#listing-available-methods","title":"Listing Available Methods","text":"<pre><code># Get method directory path\nmethod_path = api.send(\"response$ = _METHPATH$\")\nprint(f\"Method directory: {method_path}\")\n\n# List methods using Python\nimport os\nmethods = [f for f in os.listdir(method_path) if f.endswith('.M')]\nprint(\"Available methods:\", methods)\n</code></pre>"},{"location":"chemstation-api/methods-sequences/#loading-methods","title":"Loading Methods","text":"<pre><code># Load from default directory\napi.method.load(\"CE_Standard_Method\")\n\n# Load with full validation\ntry:\n    api.validation.validate_method_name(\"CE_Protein_Analysis\")\n    api.method.load(\"CE_Protein_Analysis\")\n    print(\"Method loaded successfully\")\nexcept ValidationError:\n    print(\"Method not found!\")\n</code></pre>"},{"location":"chemstation-api/methods-sequences/#modifying-method-parameters","title":"Modifying Method Parameters","text":"<p>While the API doesn't directly modify method parameters, you can:</p> <ol> <li>Load a template method</li> <li>Save with modifications via ChemStation</li> <li>Use the modified method</li> </ol> <pre><code># Load template\napi.method.load(\"Template_Method\")\n\n# Make changes in ChemStation UI...\n\n# Save as new method\napi.method.save(\"Modified_Method\", comment=\"Voltage increased to 30kV\")\n</code></pre>"},{"location":"chemstation-api/methods-sequences/#running-methods-with-custom-parameters","title":"Running Methods with Custom Parameters","text":"<pre><code># Simple run - uses current loaded method\napi.method.run(\"Sample_001\")\n\n# Run specific method with all parameters\napi.method.execution_method_with_parameters(\n    vial=15,\n    method_name=\"CE_Protein_Analysis\",\n    sample_name=\"BSA_Standard_1mg\",\n    comment=\"Validation run, fresh buffer\",\n    subdirectory_name=\"Validation_2024\"\n)\n\n# The method creates a temporary register for custom parameters\n# without modifying the original method file\n</code></pre>"},{"location":"chemstation-api/methods-sequences/#understanding-sequences","title":"Understanding Sequences","text":"<p>Sequences automate the analysis of multiple samples with different parameters:</p>"},{"location":"chemstation-api/methods-sequences/#sequence-structure","title":"Sequence Structure","text":"Column Description Example Vial Carousel position 15 Method Method name CE_Protein.M SampleName Sample identifier BSA_001 SampleInfo Additional info 1 mg/mL, pH 7.4 DataFileName Custom filename Project_X_001 InjVial Injection parameters 1"},{"location":"chemstation-api/methods-sequences/#creating-sequences-manually","title":"Creating Sequences Manually","text":"<pre><code># Load existing sequence\napi.sequence.load_sequence(\"Daily_QC\")\n\n# Modify specific row\napi.sequence.modify_sequence_row(\n    row=1,\n    vial_sample=\"10\",\n    method=\"CE_Standard\",\n    sample_name=\"QC_Standard_001\",\n    sample_info=\"Fresh preparation\"\n)\n\n# Add more samples\nfor i in range(2, 6):\n    api.sequence.modify_sequence_row(\n        row=i,\n        vial_sample=str(10 + i),\n        method=\"CE_Standard\",\n        sample_name=f\"QC_Standard_{i:03d}\",\n        sample_info=\"Replicate analysis\"\n    )\n\n# Save sequence\napi.sequence.save_sequence(\"Daily_QC_Modified\")\n</code></pre>"},{"location":"chemstation-api/methods-sequences/#excel-integration","title":"Excel Integration","text":""},{"location":"chemstation-api/methods-sequences/#preparing-excel-file","title":"Preparing Excel File","text":"<p>Create an Excel file with columns matching your needs:</p> Vial Method Sample Info Replicate 10 CE_Standard STD_001 1 mg/mL 1 11 CE_Standard STD_002 2 mg/mL 1 12 CE_Modified TEST_001 Unknown 1"},{"location":"chemstation-api/methods-sequences/#importing-from-excel","title":"Importing from Excel","text":"<pre><code># Basic import\napi.sequence.prepare_sequence_table(\n    excel_file_path=\"sample_list.xlsx\",\n    vial_column=\"Vial\",\n    method_column=\"Method\",\n    sample_name_column=\"Sample\"\n)\n\n# Full import with all columns\napi.sequence.prepare_sequence_table(\n    excel_file_path=\"complex_sequence.xlsx\",\n    sequence_name=\"Research_Project_2024\",  # Load this sequence first\n    sheet_name=0,  # First worksheet\n    vial_column=\"Vial_Position\",\n    method_column=\"CE_Method\",\n    sample_name_column=\"Sample_ID\",\n    sample_info_column=\"Description\",\n    filename_column=\"Data_Name\",\n    replicate_column=\"Rep_Number\"\n)\n</code></pre> <p>Excel Requirements</p> <ul> <li>Excel must be installed on the system</li> <li>File should not be open during import</li> <li>Column names must match exactly (case-sensitive)</li> </ul>"},{"location":"chemstation-api/methods-sequences/#sequence-execution","title":"Sequence Execution","text":""},{"location":"chemstation-api/methods-sequences/#starting-a-sequence","title":"Starting a Sequence","text":"<pre><code># Load and start sequence\napi.sequence.load_sequence(\"Daily_Analysis\")\napi.sequence.start()\n\n# Monitor progress\nwhile api.system.method_on():\n    status = api.system.status()\n    print(f\"Status: {status}\")\n    time.sleep(60)\n</code></pre>"},{"location":"chemstation-api/methods-sequences/#sequence-control","title":"Sequence Control","text":"<pre><code># Pause after current sample\napi.sequence.pause()\nprint(\"Sequence paused - current sample will complete\")\n\n# Resume sequence\napi.sequence.resume()\nprint(\"Sequence resumed\")\n\n# Emergency stop\napi.system.abort_run()\nprint(\"Sequence aborted!\")\n</code></pre>"},{"location":"chemstation-api/methods-sequences/#advanced-sequence-workflows","title":"Advanced Sequence Workflows","text":""},{"location":"chemstation-api/methods-sequences/#validation-sequence-with-standards","title":"Validation Sequence with Standards","text":"<pre><code>def create_validation_sequence(standard_vials, sample_vials):\n    \"\"\"Create sequence with bracketing standards.\"\"\"\n\n    row = 1\n\n    # Initial standards\n    for vial in standard_vials[:2]:\n        api.sequence.modify_sequence_row(\n            row=row,\n            vial_sample=str(vial),\n            method=\"CE_Standard\",\n            sample_name=f\"STD_{row:03d}\",\n            sample_info=\"System suitability\"\n        )\n        row += 1\n\n    # Samples with bracketing standards\n    for i, vial in enumerate(sample_vials):\n        # Sample\n        api.sequence.modify_sequence_row(\n            row=row,\n            vial_sample=str(vial),\n            method=\"CE_Analysis\",\n            sample_name=f\"Sample_{i+1:03d}\",\n            sample_info=\"Test sample\"\n        )\n        row += 1\n\n        # Bracket standard every 5 samples\n        if (i + 1) % 5 == 0:\n            api.sequence.modify_sequence_row(\n                row=row,\n                vial_sample=str(standard_vials[0]),\n                method=\"CE_Standard\",\n                sample_name=f\"STD_B{row:03d}\",\n                sample_info=\"Bracket standard\"\n            )\n            row += 1\n\n    # Final standards\n    for vial in standard_vials[:2]:\n        api.sequence.modify_sequence_row(\n            row=row,\n            vial_sample=str(vial),\n            method=\"CE_Standard\",\n            sample_name=f\"STD_F{row:03d}\",\n            sample_info=\"Final check\"\n        )\n        row += 1\n\n    api.sequence.save_sequence(\"Validation_Sequence\")\n\n# Create the sequence\ncreate_validation_sequence(\n    standard_vials=[1, 2],\n    sample_vials=list(range(10, 25))\n)\n</code></pre>"},{"location":"chemstation-api/methods-sequences/#multi-method-sequence","title":"Multi-Method Sequence","text":"<pre><code>def create_screening_sequence(samples_info):\n    \"\"\"Create sequence with different methods for screening.\"\"\"\n\n    for row, (vial, sample_type, sample_name) in enumerate(samples_info, 1):\n        # Select method based on sample type\n        if sample_type == \"protein\":\n            method = \"CE_Protein_SDS\"\n        elif sample_type == \"small_molecule\":\n            method = \"MEKC_General\"\n        elif sample_type == \"anion\":\n            method = \"CE_Anions\"\n        else:\n            method = \"CE_Screening\"\n\n        api.sequence.modify_sequence_row(\n            row=row,\n            vial_sample=str(vial),\n            method=method,\n            sample_name=sample_name,\n            sample_info=f\"Type: {sample_type}\"\n        )\n\n    api.sequence.save_sequence(\"Screening_Sequence\")\n\n# Define samples\nsamples = [\n    (10, \"protein\", \"BSA_Test\"),\n    (11, \"small_molecule\", \"Caffeine_Std\"),\n    (12, \"anion\", \"Chloride_Mix\"),\n    (13, \"protein\", \"Antibody_001\"),\n    (14, \"unknown\", \"Customer_Sample_X\")\n]\n\ncreate_screening_sequence(samples)\n</code></pre>"},{"location":"chemstation-api/methods-sequences/#sequence-data-management","title":"Sequence Data Management","text":""},{"location":"chemstation-api/methods-sequences/#organizing-data-files","title":"Organizing Data Files","text":"<pre><code># Set up data organization\nfrom datetime import datetime\n\n# Create project-specific subdirectory\nproject_name = \"Protein_Stability_Study\"\ndate_stamp = datetime.now().strftime(\"%Y%m%d\")\n\n# Use in sequence\napi.method.execution_method_with_parameters(\n    vial=15,\n    method_name=\"CE_Protein\",\n    sample_name=\"BSA_T0\",\n    subdirectory_name=f\"{project_name}_{date_stamp}\"\n)\n</code></pre>"},{"location":"chemstation-api/methods-sequences/#sequence-templates","title":"Sequence Templates","text":"<p>Create reusable sequence templates:</p> <pre><code>def create_qc_sequence_template():\n    \"\"\"Create standard QC sequence template.\"\"\"\n\n    qc_positions = {\n        1: (\"System_Suitability\", \"CE_QC\"),\n        2: (\"Blank\", \"CE_QC\"),\n        3: (\"Standard_Low\", \"CE_QC\"),\n        4: (\"Standard_Mid\", \"CE_QC\"),\n        5: (\"Standard_High\", \"CE_QC\"),\n    }\n\n    for row, (vial, (sample_type, method)) in enumerate(qc_positions.items(), 1):\n        api.sequence.modify_sequence_row(\n            row=row,\n            vial_sample=str(vial),\n            method=method,\n            sample_name=f\"QC_{sample_type}\",\n            sample_info=\"Daily QC\"\n        )\n\n    api.sequence.save_sequence(\"QC_Template\")\n    print(\"QC template created - modify dates/info before running\")\n\ncreate_qc_sequence_template()\n</code></pre>"},{"location":"chemstation-api/methods-sequences/#best-practices","title":"Best Practices","text":""},{"location":"chemstation-api/methods-sequences/#1-validate-before-execution","title":"1. Validate Before Execution","text":"<pre><code>def validate_sequence_ready(sequence_name):\n    \"\"\"Validate all sequence requirements before starting.\"\"\"\n\n    # Load sequence\n    api.sequence.load_sequence(sequence_name)\n\n    # Get vial list from sequence (manual check needed)\n    # For now, validate known vials\n    required_vials = [1, 2, 3, 10, 11, 12]  # Example\n\n    try:\n        # Check all vials present\n        api.validation.list_vial_validation(required_vials)\n\n        # Check all methods exist\n        methods = [\"CE_QC\", \"CE_Analysis\"]  # Example\n        for method in methods:\n            api.validation.validate_method_name(method)\n\n        # Check system ready\n        if api.system.status() != \"STANDBY\":\n            raise SystemError(\"System not in standby\")\n\n        print(f\"Sequence {sequence_name} ready to run!\")\n        return True\n\n    except Exception as e:\n        print(f\"Sequence validation failed: {e}\")\n        return False\n</code></pre>"},{"location":"chemstation-api/methods-sequences/#2-error-recovery","title":"2. Error Recovery","text":"<pre><code>def run_sequence_with_recovery(sequence_name):\n    \"\"\"Run sequence with error recovery.\"\"\"\n\n    try:\n        api.sequence.load_sequence(sequence_name)\n        api.sequence.start()\n\n        while api.system.method_on():\n            status = api.system.status()\n\n            if status == \"ERROR\":\n                print(\"Error detected - attempting recovery\")\n                api.system.abort_run()\n                time.sleep(30)\n\n                # Try to resume\n                api.sequence.resume()\n\n            time.sleep(30)\n\n    except Exception as e:\n        print(f\"Sequence failed: {e}\")\n        api.system.abort_run()\n</code></pre>"},{"location":"chemstation-api/methods-sequences/#3-progress-tracking","title":"3. Progress Tracking","text":"<pre><code>def track_sequence_progress():\n    \"\"\"Track and log sequence progress.\"\"\"\n\n    sample_count = 0\n    start_time = time.time()\n\n    while api.system.method_on():\n        if api.system.status() == \"RUN\":\n            sample_count += 1\n            elapsed = (time.time() - start_time) / 60\n            remaining = api.system.get_remaining_analysis_time()\n\n            print(f\"Sample {sample_count} - \"\n                  f\"Elapsed: {elapsed:.1f} min - \"\n                  f\"Current remaining: {remaining:.1f} min\")\n\n        time.sleep(60)\n\n    total_time = (time.time() - start_time) / 60\n    print(f\"Sequence complete! {sample_count} samples in {total_time:.1f} minutes\")\n</code></pre> <p>You're ready!</p> <p>You now know how to create and run complex analytical sequences. Check out the Tutorials for complete workflow examples.</p>"},{"location":"chemstation-api/troubleshooting/","title":"ChemStation Troubleshooting Guide","text":"<p>Detailed troubleshooting for ChemStation-specific issues.</p>"},{"location":"chemstation-api/troubleshooting/#connection-issues","title":"Connection Issues","text":""},{"location":"chemstation-api/troubleshooting/#macro-not-running","title":"Macro Not Running","text":"<p>Symptoms: - <code>ConnectionError: Failed to establish communication with ChemStation</code> - No response to commands - Timeout errors on initialization</p> <p>Solutions:</p> <ol> <li> <p>Load the macro manually: <pre><code>In ChemStation command line:\nmacro \"C:\\full\\path\\to\\ChemPyConnect.mac\"; Python_Run\n</code></pre></p> </li> <li> <p>Verify macro is running: <pre><code>Check ChemStation command line for:\n\"Start Python communication\"\n</code></pre></p> </li> <li> <p>Auto-load macro on startup:</p> </li> <li>Edit ChemStation's <code>user.mac</code> file</li> <li>Add macro load command</li> <li>Restart ChemStation</li> </ol>"},{"location":"chemstation-api/troubleshooting/#file-access-issues","title":"File Access Issues","text":"<p>Symptoms: - <code>FileOperationError: Failed to write command</code> - Permission denied errors - Communication files not created</p> <p>Solutions:</p> <ol> <li> <p>Check directory permissions: <pre><code>import os\ncomm_dir = r\"...\\ChemstationAPI\\core\\communication_files\"\nprint(f\"Exists: {os.path.exists(comm_dir)}\")\nprint(f\"Writable: {os.access(comm_dir, os.W_OK)}\")\n</code></pre></p> </li> <li> <p>Run as Administrator:</p> </li> <li>Right-click Python/IDE</li> <li> <p>Select \"Run as administrator\"</p> </li> <li> <p>Antivirus interference:</p> </li> <li>Add communication directory to exclusions</li> <li>Disable real-time scanning temporarily</li> </ol>"},{"location":"chemstation-api/troubleshooting/#command-syntax-errors","title":"Command Syntax Errors","text":"<p>Symptoms: - <code>ChemstationError: Command failed: ERROR: ...</code> - Invalid command messages - Unexpected responses</p> <p>Solutions:</p> <ol> <li> <p>Check command syntax: <pre><code># Correct: Quotes around string parameters\napi.send('LoadMethod _METHPATH$, \"Method.M\"')\n\n# Wrong: Missing quotes\napi.send('LoadMethod _METHPATH$, Method.M')\n</code></pre></p> </li> <li> <p>Verify response variable: <pre><code># For return values, use response$\nvalue = api.send(\"response$ = _METHPATH$\")\n\n# Without response$, returns None\napi.send(\"LoadMethod ...\")  # No return value\n</code></pre></p> </li> </ol>"},{"location":"chemstation-api/troubleshooting/#method-issues","title":"Method Issues","text":""},{"location":"chemstation-api/troubleshooting/#method-not-found","title":"Method Not Found","text":"<p>Symptoms: - <code>ValidationError: Method 'X' not found</code> - Method loading fails - Case sensitivity issues</p> <p>Solutions:</p> <ol> <li> <p>Check exact filename: <pre><code>import os\nmethod_path = api.send(\"response$ = _METHPATH$\")\nmethods = [f for f in os.listdir(method_path) if f.endswith('.M')]\nprint(\"Available methods:\", methods)\n</code></pre></p> </li> <li> <p>Case-insensitive validation: <pre><code># The API handles case-insensitive matching\napi.validation.validate_method_name(\"method_name\")  # Without .M\n</code></pre></p> </li> <li> <p>Path issues: <pre><code># Use full path if needed\napi.method.load(\"MyMethod\", method_path=\"C:\\\\Methods\\\\Special\\\\\")\n</code></pre></p> </li> </ol>"},{"location":"chemstation-api/troubleshooting/#method-execution-failures","title":"Method Execution Failures","text":"<p>Symptoms: - <code>MethodError: Method failed to start</code> - Analysis doesn't begin - System remains in STANDBY</p> <p>Solutions:</p> <ol> <li> <p>Check prerequisites: <pre><code># Verify system ready\nprint(f\"Status: {api.system.status()}\")\nprint(f\"Method on: {api.system.method_on()}\")\n\n# Check vials loaded\napi.validation.vial_in_position(\"inlet\")\napi.validation.vial_in_position(\"outlet\")\n</code></pre></p> </li> <li> <p>Clear previous errors: <pre><code># Abort any stuck operations\napi.system.abort_run()\ntime.sleep(5)\n\n# Wait for ready\napi.system.wait_for_ready(60)\n</code></pre></p> </li> </ol>"},{"location":"chemstation-api/troubleshooting/#sequence-problems","title":"Sequence Problems","text":""},{"location":"chemstation-api/troubleshooting/#excel-import-failures","title":"Excel Import Failures","text":"<p>Symptoms: - <code>SequenceError: Failed to import from Excel</code> - Empty sequence after import - Column mapping errors</p> <p>Solutions:</p> <ol> <li> <p>Verify Excel format: <pre><code>import pandas as pd\n\n# Check your Excel file\ndf = pd.read_excel(\"samples.xlsx\")\nprint(\"Columns:\", df.columns.tolist())\nprint(\"First row:\", df.iloc[0].to_dict())\n</code></pre></p> </li> <li> <p>Column name matching: <pre><code># Exact column names required\napi.sequence.prepare_sequence_table(\n    excel_file_path=\"samples.xlsx\",\n    vial_column=\"Vial\",         # Must match exactly\n    method_column=\"Method\",     # Case sensitive\n    sample_name_column=\"Name\"   # No extra spaces\n)\n</code></pre></p> </li> <li> <p>Excel application issues:</p> </li> <li>Close Excel before import</li> <li>Ensure Excel is installed</li> <li>Try saving as .xlsx (not .xls)</li> </ol>"},{"location":"chemstation-api/troubleshooting/#sequence-execution-issues","title":"Sequence Execution Issues","text":"<p>Symptoms: - Sequence stops unexpectedly - Skips samples - Wrong vial loaded</p> <p>Solutions:</p> <ol> <li> <p>Monitor sequence state: <pre><code># Check sequence progress\nwhile api.system.method_on():\n    status = api.system.status()\n    rc_status = api.system.RC_status()\n    print(f\"Status: {status}, RC: {rc_status}\")\n    time.sleep(30)\n</code></pre></p> </li> <li> <p>Validate all vials: <pre><code># Before starting sequence\nvials_needed = [1, 2, 3, 10, 11, 12]  # Your vial list\napi.validation.list_vial_validation(vials_needed)\n</code></pre></p> </li> </ol>"},{"location":"chemstation-api/troubleshooting/#system-status-issues","title":"System Status Issues","text":""},{"location":"chemstation-api/troubleshooting/#incorrect-status-reporting","title":"Incorrect Status Reporting","text":"<p>Symptoms: - Status doesn't update - Wrong remaining time - Method appears stuck</p> <p>Solutions:</p> <ol> <li> <p>Force status update: <pre><code># Multiple status checks\nfor _ in range(3):\n    status = api.system.status()\n    print(f\"Status: {status}\")\n    time.sleep(1)\n</code></pre></p> </li> <li> <p>Direct register access: <pre><code># Get status from RC registers\nrc_state = api.send('response$ = ObjHdrText$(RCCE1Status[1], \"RunState\")')\nprint(f\"RC State: {rc_state}\")\n</code></pre></p> </li> </ol>"},{"location":"chemstation-api/troubleshooting/#timing-discrepancies","title":"Timing Discrepancies","text":"<p>Symptoms: - Incorrect analysis time - Progress calculation wrong - Early termination</p> <p>Solutions:</p> <pre><code># Robust time monitoring\ndef monitor_with_validation():\n    last_remaining = float('inf')\n    stuck_count = 0\n\n    while api.system.method_on():\n        remaining = api.system.get_remaining_analysis_time()\n\n        # Check if time is updating\n        if remaining == last_remaining:\n            stuck_count += 1\n            if stuck_count &gt; 10:\n                print(\"Warning: Time not updating\")\n        else:\n            stuck_count = 0\n\n        last_remaining = remaining\n        time.sleep(10)\n</code></pre>"},{"location":"chemstation-api/troubleshooting/#recovery-procedures","title":"Recovery Procedures","text":""},{"location":"chemstation-api/troubleshooting/#complete-system-reset","title":"Complete System Reset","text":"<pre><code>def full_system_reset():\n    \"\"\"Complete reset procedure.\"\"\"\n\n    print(\"Performing full system reset...\")\n\n    # 1. Abort any running operations\n    try:\n        api.system.abort_run()\n    except:\n        pass\n\n    # 2. Unload all vials\n    for position in [\"inlet\", \"outlet\", \"replenishment\"]:\n        try:\n            api.ce.unload_vial_from_position(position)\n        except:\n            pass\n\n    # 3. Reinitialize communication\n    time.sleep(5)\n    api = ChemstationAPI()\n\n    # 4. Verify ready state\n    if api.system.wait_for_ready(60):\n        print(\"System reset complete\")\n    else:\n        print(\"System reset failed - manual intervention required\")\n\n    return api\n</code></pre>"},{"location":"chemstation-api/troubleshooting/#communication-recovery","title":"Communication Recovery","text":"<pre><code>def recover_communication():\n    \"\"\"Recover from communication failures.\"\"\"\n\n    # 1. Clear communication files\n    import os\n    comm_dir = \"path/to/communication_files\"\n\n    for filename in [\"command\", \"response\"]:\n        filepath = os.path.join(comm_dir, filename)\n        try:\n            os.remove(filepath)\n        except:\n            pass\n\n    # 2. Restart macro in ChemStation\n    print(\"In ChemStation, execute:\")\n    print('macro \"path\\\\ChemPyConnect.mac\"; Python_Stop')\n    print('macro \"path\\\\ChemPyConnect.mac\"; Python_Run')\n    input(\"Press Enter when complete...\")\n\n    # 3. Reconnect\n    try:\n        api = ChemstationAPI()\n        print(\"Communication restored\")\n        return api\n    except:\n        print(\"Communication recovery failed\")\n        return None\n</code></pre>"},{"location":"chemstation-api/troubleshooting/#performance-optimization","title":"Performance Optimization","text":""},{"location":"chemstation-api/troubleshooting/#slow-command-response","title":"Slow Command Response","text":"<p>Solutions:</p> <ol> <li> <p>Reduce retry delay: <pre><code>config = CommunicationConfig(\n    retry_delay=0.05,  # 50ms instead of 100ms\n    max_retries=20     # More retries with shorter delay\n)\n</code></pre></p> </li> <li> <p>Batch commands: <pre><code># Instead of multiple calls\n# api.send(\"command1\")\n# api.send(\"command2\")\n\n# Use macro for batch operations\napi.send('macro \"batch_commands.mac\"; execute_all')\n</code></pre></p> </li> </ol>"},{"location":"chemstation-api/troubleshooting/#memory-issues","title":"Memory Issues","text":"<p>Solutions:</p> <ol> <li> <p>Clear old data: <pre><code># Periodically reinitialize\nif command_count &gt; 1000:\n    api = ChemstationAPI()  # Fresh connection\n</code></pre></p> </li> <li> <p>Monitor file sizes: <pre><code>import os\n\ndef check_comm_files():\n    for file in [\"command\", \"response\"]:\n        path = f\"communication_files/{file}\"\n        size = os.path.getsize(path) / 1024  # KB\n        if size &gt; 100:\n            print(f\"Warning: {file} is {size:.1f} KB\")\n</code></pre></p> </li> </ol>"},{"location":"chemstation-api/troubleshooting/#diagnostic-tools","title":"Diagnostic Tools","text":""},{"location":"chemstation-api/troubleshooting/#communication-monitor","title":"Communication Monitor","text":"<pre><code>def monitor_communication(duration=60):\n    \"\"\"Monitor communication for specified duration.\"\"\"\n\n    import time\n    from datetime import datetime\n\n    start = time.time()\n    command_count = 0\n    error_count = 0\n\n    while time.time() - start &lt; duration:\n        try:\n            # Test command\n            result = api.send(\"response$ = ACQSTATUS$\")\n            command_count += 1\n            print(f\"\\r{datetime.now()}: {result}\", end=\"\")\n        except Exception as e:\n            error_count += 1\n            print(f\"\\nError: {e}\")\n\n        time.sleep(1)\n\n    print(f\"\\n\\nSummary: {command_count} commands, {error_count} errors\")\n    print(f\"Success rate: {(command_count/(command_count+error_count))*100:.1f}%\")\n</code></pre>"},{"location":"chemstation-api/troubleshooting/#register-browser","title":"Register Browser","text":"<pre><code># Add register browser to ChemStation menu\napi.system.add_register_reader()\n\n# Then in ChemStation:\n# Menu \u2192 Debug \u2192 Show Registers\n# Browse all system registers and values\n</code></pre>"},{"location":"chemstation-api/troubleshooting/#best-practices","title":"Best Practices","text":"<ol> <li>Always validate before operations</li> <li>Use appropriate timeouts for different operations</li> <li>Implement retry logic for critical operations</li> <li>Monitor system state during long operations</li> <li>Keep communication files clean</li> <li>Document any custom macros or modifications</li> </ol> <p>When All Else Fails</p> <p>If persistent issues: 1. Restart ChemStation 2. Reboot computer 3. Check for ChemStation updates 4. Verify hardware connections 5. Contact Agilent support</p>"},{"location":"sia-api/ce_workflows/","title":"CE Workflows - SI Integration","text":""},{"location":"sia-api/ce_workflows/#overview","title":"Overview","text":"<p>The <code>PreparedSIMethods</code> class provides high-level automation workflows that combine SI sample preparation with Capillary Electrophoresis analysis. These workflows handle complex sequences of operations for complete analytical automation.</p>"},{"location":"sia-api/ce_workflows/#system-integration","title":"System Integration","text":"<pre><code>from ChemstationAPI import ChemstationAPI\nfrom SI_API.devices import SyringeController, ValveSelector  \nfrom SI_API.methods import PreparedSIMethods\n\n# Initialize all components\nce_api = ChemstationAPI()\nsyringe = SyringeController(\"COM3\", syringe_size=1000)\nvalve = ValveSelector(\"COM4\", num_positions=8)\n\n# Create integrated workflow system\nworkflow = PreparedSIMethods(\n    chemstation_controller=ce_api,\n    syringe_device=syringe,\n    valve_device=valve\n)\n</code></pre>"},{"location":"sia-api/ce_workflows/#core-workflow-components","title":"Core Workflow Components","text":""},{"location":"sia-api/ce_workflows/#system-initialization","title":"System Initialization","text":"<p>Every analytical session starts with complete system preparation:</p> <pre><code># Complete system initialization and cleaning\nworkflow.system_initialization_and_cleaning(\n    waste_vial=50,  # Waste collection vial\n    bubble=20       # Air bubble size (\u00b5L)\n)\n</code></pre> <p>What happens during initialization:</p> <ol> <li>Syringe homing and speed setting</li> <li>Holding coil flushing with methanol</li> <li>DI water rinse cycles</li> <li>Transfer line conditioning</li> <li>Air bubble creation for separation</li> </ol>"},{"location":"sia-api/ce_workflows/#sample-handling-integration","title":"Sample Handling Integration","text":"<p>The workflows automatically coordinate between SI preparation and CE autosampler:</p> <pre><code># Load vial to CE replenishment position\nworkflow.load_to_replenishment(vial_number=15)\n\n# Perform SI operations on loaded vial\nworkflow.continuous_fill(vial=15, volume=500, solvent_port=3)\n\n# Unload vial back to carousel  \nworkflow.unload_from_replenishment()\n</code></pre>"},{"location":"sia-api/ce_workflows/#flow-modes","title":"Flow Modes","text":""},{"location":"sia-api/ce_workflows/#continuous-flow-mode","title":"Continuous Flow Mode","text":"<p>Ideal for multiple samples with the same solvent:</p> <pre><code># Prepare system for continuous flow\nworkflow.prepare_continuous_flow(\n    solvent_port=3,              # DI water port\n    transfer_coil_flush=600,     # Transfer line volume\n    speed=2000                   # Flow rate (\u00b5L/min)\n)\n\n# Fill multiple vials efficiently\nsample_vials = [10, 11, 12, 13, 14]\nfor vial in sample_vials:\n    workflow.continuous_fill(\n        vial=vial,\n        volume=1000,             # 1 mL per vial  \n        solvent_port=3,          # DI water\n        flush_needle=50          # Needle cleaning\n    )\n</code></pre> <p>Continuous flow characteristics:</p> <ul> <li>Transfer line pre-filled with solvent</li> <li>Faster operation (no air gaps)</li> <li>Consistent flow properties</li> <li>Best for same solvent, multiple vials</li> </ul>"},{"location":"sia-api/ce_workflows/#batch-flow-mode","title":"Batch Flow Mode","text":"<p>Better for different solvents or single operations:</p> <pre><code># Prepare for batch operations\nworkflow.prepare_batch_flow(\n    solvent_port=5,              # Methanol port\n    transfer_coil_volume=600,    # Line volume\n    speed=1500                   # Flow rate\n)\n\n# Fill with air-driven dispensing\nworkflow.batch_fill(\n    vial=20,\n    volume=750,                  # Volume to dispense\n    solvent_port=5,              # Methanol\n    bubble_volume=15,            # Air separation\n    wait=2                       # Wait after dispensing\n)\n</code></pre> <p>Batch flow characteristics:</p> <ul> <li>Air-driven dispensing</li> <li>Complete separation between solutions</li> <li>Suitable for solvent changes</li> <li>Independent operations</li> </ul>"},{"location":"sia-api/ce_workflows/#sample-preparation-workflows","title":"Sample Preparation Workflows","text":""},{"location":"sia-api/ce_workflows/#automated-dilution","title":"Automated Dilution","text":"<pre><code>def prepare_dilution_series():\n    \"\"\"Prepare 1:10 dilution series\"\"\"\n\n    # Initialize system\n    workflow.system_initialization_and_cleaning()\n\n    # Prepare for water addition\n    workflow.prepare_continuous_flow(solvent_port=3)  # DI water\n\n    sample_vials = [15, 16, 17, 18, 19]\n\n    for vial in sample_vials:\n        # Add 900 \u00b5L diluent (for 1:10 dilution)\n        workflow.continuous_fill(\n            vial=vial,\n            volume=900,\n            solvent_port=3,\n            flush_needle=None  # No wash between same solvent\n        )\n\n        print(f\"Vial {vial}: Add 100 \u00b5L sample manually\")\n\n    print(\"All dilutions prepared - add samples as indicated\")\n\nprepare_dilution_series()\n</code></pre>"},{"location":"sia-api/ce_workflows/#multi-solvent-sample-preparation","title":"Multi-Solvent Sample Preparation","text":"<pre><code>def prepare_mixed_samples():\n    \"\"\"Prepare samples with multiple reagents\"\"\"\n\n    sample_preparations = [\n        {'vial': 20, 'water': 500, 'buffer': 200, 'reagent': 50},\n        {'vial': 21, 'water': 600, 'buffer': 150, 'reagent': 25},\n        {'vial': 22, 'water': 400, 'buffer': 300, 'reagent': 75}\n    ]\n\n    for prep in sample_preparations:\n        print(f\"Preparing vial {prep['vial']}\")\n\n        # Use batch mode for different solvents\n        workflow.batch_fill_multiple_solvents(\n            vial=prep['vial'],\n            solvent_ports=[3, 6, 7],  # Water, buffer, reagent\n            volumes=[prep['water'], prep['buffer'], prep['reagent']],\n            air_push_volume=20\n        )\n\nprepare_mixed_samples()\n</code></pre>"},{"location":"sia-api/ce_workflows/#sample-homogenization","title":"Sample Homogenization","text":""},{"location":"sia-api/ce_workflows/#liquid-mixing","title":"Liquid Mixing","text":"<p>Gentle mixing for sensitive samples:</p> <pre><code># Prepare system for liquid homogenization\nworkflow.prepare_for_liquid_homogenization()\n\n# Mix by liquid aspiration/dispensing\nworkflow.homogenize_by_liquid_mixing(\n    vial=15,\n    volume_aspirate=400,         # Volume per cycle\n    num_cycles=3,                # Number of cycles\n    aspirate_speed=1500,         # Gentle aspiration\n    dispense_speed=2000,         # Controlled dispensing\n    clean_after=True             # Clean transfer line\n)\n</code></pre>"},{"location":"sia-api/ce_workflows/#air-bubble-mixing","title":"Air Bubble Mixing","text":"<p>Vigorous mixing for thorough homogenization:</p> <pre><code># Air bubble mixing for viscous samples\nworkflow.homogenize_by_air_mixing(\n    vial=22,\n    volume_aspirate=300,         # Liquid per cycle\n    air_bubble_volume=100,       # Air bubble size\n    num_cycles=5,                # More cycles for thorough mixing\n    wait_between_cycles=8.0,     # Time for bubble action\n    aspirate_speed=800           # Slower for viscous samples\n)\n</code></pre>"},{"location":"sia-api/ce_workflows/#complete-analytical-workflows","title":"Complete Analytical Workflows","text":""},{"location":"sia-api/ce_workflows/#automated-analysis","title":"Automated Analysis","text":"<pre><code>def analysis_workflow():\n    \"\"\"Complete sample preparation and analysis\"\"\"\n\n    # Sample preparation\n    samples = [10, 11, 12, 13]\n    method_name = \"CE_Protein_Analysis\"\n\n    ce_api.validation.list_vial_validation(samples)\n    ce_api.validation.validate_method(method_name)\n\n    # System initialization\n    workflow.system_initialization_and_cleaning()\n\n    # Prepare buffer dilutions  \n    workflow.prepare_continuous_flow(solvent_port=6)  # Buffer\n\n    for vial in samples:\n        # Add buffer\n        workflow.continuous_fill(\n            vial=vial,\n            volume=500,      # 500 \u00b5L buffer\n            solvent_port=6,\n            flush_needle=25\n        )\n\n    print(\"Samples ready for CE analysis\")\n\n    workflow.prepare_for_liquid_homogenization()\n\n    # Proceed with CE analysis using ChemStation integration\n    for vial in samples:\n\n        #\u010dek\u00e1n\u00ed a\u017e bude mo\u017en\u00e9 pou\u017e\u00edt carousel\n        while ce_api.system.RC_status() not in [\"Idle\", \"Run\"]:\n            time.sleep(5)\n\n        #homogenizace vzorku p\u0159ed anal\u00fdzou\n        workflow.homogenize_by_liquid_mixing(\n            vial=vial,\n            volume_aspirate=200,\n            num_cycles=2,\n            aspirate_speed=1000,  # Gentle\n            dispense_speed=1200\n        )\n\n        #\u010dek\u00e1n\u00ed a\u017e bude syst\u00e9m p\u0159ipraven na spu\u0161t\u011bn\u00ed anal\u00fdzy\n        ce_api.system.ready_to_start_analysis()\n\n        #spu\u0161t\u011bn\u00ed anal\u00fdzy s parametry\n        ce_api.method.execution_method_with_parameters(\n            vial=vial,\n            method_name=\"CE_Protein_Analysis\",\n            sample_name=f\"Protein_Sample_{vial}\"\n        )\n\nanalysis_workflow()\n</code></pre>"},{"location":"sia-api/ce_workflows/#configuration-and-optimization","title":"Configuration and Optimization","text":""},{"location":"sia-api/ce_workflows/#custom-port-configuration","title":"Custom Port Configuration","text":"<pre><code>from SI_API.methods import create_custom_config\n\n# Create custom port mapping\ncustom_ports = create_custom_config(\n    waste_port=8,        # Move waste to end\n    air_port=1,          # Air at beginning  \n    di_port=2,           # Water nearby\n    transfer_port=7,     # Transfer near waste\n    meoh_port=3,         # Cleaning solvents grouped\n    buffer_port=4,       # Sample prep solvents  \n    sample_port=5        # Sample input\n)\n\n# Use custom configuration\nworkflow = PreparedSIMethods(\n    chemstation_controller=ce_api,\n    syringe_device=syringe,\n    valve_device=valve,\n    ports_config=custom_ports\n)\n</code></pre>"},{"location":"sia-api/ce_workflows/#performance-optimization","title":"Performance Optimization","text":"<pre><code># Optimize for speed\nspeed_config = {\n    'speed_fast': 4000,           # Fast transfers\n    'speed_normal': 2500,         # Normal operations  \n    'wait_after_aspirate': 0.5,   # Minimal delays\n    'wait_after_dispense': 0.2,\n    'homogenization_liquid_cycles': 1,  # Fewer mixing cycles\n    'verbose': False              # Reduce output for speed\n}\n\nworkflow.update_config(**speed_config)\n\n# Optimize for precision  \nprecision_config = {\n    'speed_fast': 2000,           # Slower, more controlled\n    'speed_normal': 1200,\n    'wait_after_aspirate': 2.0,   # Allow settling\n    'wait_after_dispense': 1.0,\n    'homogenization_liquid_cycles': 4,  # More thorough mixing\n    'verbose': True               # Full feedback\n}\n\nworkflow.update_config(**precision_config)\n</code></pre>"},{"location":"sia-api/ce_workflows/#best-practices","title":"Best Practices","text":""},{"location":"sia-api/ce_workflows/#1-always-initialize-first","title":"1. Always Initialize First","text":"<pre><code># Start every session with system initialization\nworkflow.system_initialization_and_cleaning()\n</code></pre>"},{"location":"sia-api/ce_workflows/#2-match-flow-mode-to-application","title":"2. Match Flow Mode to Application","text":"<ul> <li>Continuous flow: Same solvent, multiple samples, speed priority</li> <li>Batch flow: Different solvents, contamination concerns</li> </ul>"},{"location":"sia-api/ce_workflows/#3-plan-needle-cleaning","title":"3. Plan Needle Cleaning","text":"<pre><code># Clean between different sample types\nworkflow.continuous_fill(vial=10, volume=1000, solvent_port=3, flush_needle=50)\n# Skip cleaning within replicate groups  \nworkflow.continuous_fill(vial=11, volume=1000, solvent_port=3, flush_needle=None)\n</code></pre>"},{"location":"sia-api/ce_workflows/#4-monitor-critical-operations","title":"4. Monitor Critical Operations","text":"<pre><code># Enable verbose mode for important workflows\nworkflow.update_config(verbose=True)\n\n# Check system status\nstatus = workflow.get_system_status()\nprint(f\"Syringe size: {status['syringe_size']} \u00b5L\")\nprint(f\"Port assignments: {status['port_assignments']}\")\n</code></pre>"},{"location":"sia-api/ce_workflows/#custom-configuration","title":"Custom Configuration","text":""},{"location":"sia-api/ce_workflows/#port-configuration","title":"Port Configuration","text":"<pre><code>from SI_API.methods import create_custom_config\n\n# Create custom port mapping\ncustom_ports = create_custom_config(\n    waste_port=8,        # Move waste to end\n    air_port=1,          # Air at beginning  \n    di_port=2,           # Water nearby\n    transfer_port=7,     # Transfer near waste\n    meoh_port=3          # Cleaning solvents grouped\n)\n\n# Use custom configuration\nworkflow = PreparedSIMethods(\n    chemstation_controller=ce_api,\n    syringe_device=syringe,\n    valve_device=valve,\n    ports_config=custom_ports\n)\n</code></pre>"},{"location":"sia-api/ce_workflows/#performance-optimization_1","title":"Performance Optimization","text":"<pre><code># Optimize for speed\nworkflow.update_config(\n    speed_fast=4000,\n    speed_normal=2500,\n    wait_after_dispense=0.2,\n    verbose=False\n)\n\n# Optimize for precision  \nworkflow.update_config(\n    speed_fast=2000,\n    speed_normal=1200,\n    wait_after_aspirate=2.0,\n    homogenization_liquid_cycles=4,\n    verbose=True\n)\n</code></pre>"},{"location":"sia-api/ce_workflows/#advanced-integration","title":"Advanced Integration","text":"<p>The SI-CE integration enables sophisticated analytical workflows:</p> <ul> <li>Unattended operation: Complete sample prep and analysis</li> <li>Method development: Automated optimization studies  </li> <li>Quality control: Reproducible sample handling</li> <li>High throughput: Parallel processing capabilities</li> <li>Adaptive methods: Sample-specific preparations</li> </ul> <p>This integration transforms manual, time-intensive procedures into fully automated analytical workflows suitable for research, quality control, and routine analysis applications.</p>"},{"location":"sia-api/core_communication/","title":"Core Communication System","text":""},{"location":"sia-api/core_communication/#overview","title":"Overview","text":"<p>The <code>CommandSender</code> class provides the foundation for all SIA device communication. It handles serial port management, command formatting, and response processing for any RS-232/USB device.</p>"},{"location":"sia-api/core_communication/#how-it-works","title":"How It Works","text":""},{"location":"sia-api/core_communication/#command-formatting","title":"Command Formatting","text":"<p>Commands are automatically formatted as: <code>{prefix}{address}{command}\\r</code></p> <pre><code># Your command: \"MOVE 5\"\n# Sent to device: \"/1MOVE 5\\r\"\n</code></pre>"},{"location":"sia-api/core_communication/#port-management","title":"Port Management","text":"<ul> <li>Opens port only when needed</li> <li>Handles connection errors gracefully</li> <li>Closes port after each operation</li> </ul>"},{"location":"sia-api/core_communication/#response-handling","title":"Response Handling","text":"<ul> <li>Optional response capture with timeout</li> <li>Automatic encoding/decoding</li> <li>Error detection and reporting</li> </ul>"},{"location":"sia-api/core_communication/#basic-usage","title":"Basic Usage","text":"<pre><code>from SI_API.core import CommandSender\n\n# Initialize device communication\ndevice = CommandSender(\n    port=\"COM3\",\n    prefix=\"/\",      # Command prefix (device-specific)\n    address=\"1\",     # Device address (for multi-device setups)\n    baudrate=9600    # Communication speed\n)\n\n# Send command without response\ndevice.send_command(\"INITIALIZE\")\n\n# Send command and get response\nresponse = device.send_command(\"STATUS?\", get_response=True)\nprint(f\"Device status: {response}\")\n</code></pre>"},{"location":"sia-api/core_communication/#advanced-features","title":"Advanced Features","text":""},{"location":"sia-api/core_communication/#completion-waiting","title":"Completion Waiting","text":"<pre><code>def wait_for_ready():\n    \"\"\"Custom function to wait for operation completion\"\"\"\n    time.sleep(2)\n\n# Send command and wait for completion\ndevice.send_command(\n    \"MOVE_TO_POSITION 5\",\n    wait_for_completion=wait_for_ready,\n    response_timeout=10\n)\n</code></pre> <p>Important: The wait_for_completion function is called while the serial port remains open. This allows for continuous monitoring or additional operations during the waiting period.</p>"},{"location":"sia-api/core_communication/#response-timeout-control","title":"Response Timeout Control","text":"<pre><code># Short timeout for quick responses\nstatus = device.send_command(\"QUICK_STATUS?\", get_response=True, response_timeout=2)\n\n# Long timeout for slow operations\nresult = device.send_command(\"CALIBRATE\", get_response=True, response_timeout=60)\n</code></pre>"},{"location":"sia-api/core_communication/#custom-device-integration","title":"Custom Device Integration","text":""},{"location":"sia-api/core_communication/#arduino-example","title":"Arduino Example","text":"<p>If you have a pre-programmed Arduino controlling a custom stirrer:</p> <pre><code>class StirrerController(CommandSender):\n    \"\"\"Control custom Arduino-based stirrer\"\"\"\n\n    def __init__(self, port):\n        super().__init__(port=port, prefix=\"\", address=\"\")\n\n    def start_stirring(self, speed):\n        \"\"\"Start stirring at specified speed (RPM)\"\"\"\n        self.send_command(f\"START {speed}\")\n\n    def stop_stirring(self):\n        \"\"\"Stop stirring\"\"\"\n        self.send_command(\"STOP\")\n\n    def get_temperature(self):\n        \"\"\"Read current temperature from Arduino\"\"\"\n        temp = self.send_command(\"TEMP?\", get_response=True)\n        return float(temp.strip())\n\n# Usage\nstirrer = StirrerController(\"COM5\")\nstirrer.start_stirring(500)  # 500 RPM\ncurrent_temp = stirrer.get_temperature()\nstirrer.stop_stirring()\n</code></pre>"},{"location":"sia-api/core_communication/#different-communication-protocols","title":"Different Communication Protocols","text":"<pre><code># Cavro syringe style (SyringeController)\nsyringe = CommandSender(port=\"COM3\", prefix=\"\", address=\"/1\")\nsyringe.send_command(\"A1000R\")  # Aspirate 1000 steps\n# Sends: \"/1A1000R\\r\"\n\n# VICI valve style (ValveSelector)  \nvalve = CommandSender(port=\"COM4\", prefix=\"/Z\", address=\"\")\nvalve.send_command(\"GO3\")  # Go to position 3\n# Sends: \"/ZGO3\\r\"\n\n# Custom device protocol\ncustom = CommandSender(port=\"COM5\", prefix=\"@\", address=\"01\")\ncustom.send_command(\"RUN\")  # Start operation\n# Sends: \"@01RUN\\r\"\n</code></pre>"},{"location":"sia-api/core_communication/#error-handling","title":"Error Handling","text":"<pre><code>try:\n    device = CommandSender(\"COM3\")\n    response = device.send_command(\"STATUS?\", get_response=True)\nexcept serial.SerialException as e:\n    print(f\"Connection failed: {e}\")\nexcept TimeoutError:\n    print(\"Device didn't respond in time\")\n</code></pre> <p>The CommandSender design allows easy integration with any device that uses serial communication by understanding the device's command protocol and implementing the appropriate prefix, address, and command formatting.</p>"},{"location":"sia-api/sia_introduction/","title":"SI API - Sequential Injection Module","text":""},{"location":"sia-api/sia_introduction/#what-is-sequential-injection","title":"What is Sequential Injection?","text":"<p>Sequential Injection (SI) is an automated liquid handling technique that enables precise control of fluid movement for analytical chemistry applications. Unlike manual pipetting, SI provides reproducible, computer-controlled operations with microliter precision.</p>"},{"location":"sia-api/sia_introduction/#system-components","title":"System Components","text":""},{"location":"sia-api/sia_introduction/#1-syringe-pump","title":"1. Syringe Pump","text":"<p>The heart of the SI system - provides bidirectional fluid movement with precise volume control:</p> <ul> <li>Volume range: Typically 50-5000 \u00b5L syringes</li> <li>Precision: Sub-microliter accuracy</li> <li>Flow control: Variable speed operation</li> <li>Automation: Computer-controlled aspiration and dispensing</li> </ul>"},{"location":"sia-api/sia_introduction/#2-multi-position-valve","title":"2. Multi-Position Valve","text":"<p>Routes fluids between different sources and destinations:</p> <ul> <li>Positions: 6-12 port configurations</li> <li>Fast switching: Rapid fluid path selection</li> <li>Low dead volume: Minimal fluid waste</li> <li>Computer control: Automated position switching</li> </ul>"},{"location":"sia-api/sia_introduction/#3-holding-coil","title":"3. Holding Coil","text":"<p>Temporary storage for fluids during complex operations:</p> <ul> <li>Capacity: 1-5 mL typical volume</li> <li>Mixing: Enables complex fluid manipulations via liquid mixing or air bubble segmentation</li> <li>Segmentation: Air bubbles separate different solutions, preventing cross-contamination</li> <li>Flow path: Connects valve to sample needle, acting as a fluid reservoir</li> </ul> <p>Basic Operation Sequence:</p> <ol> <li>Valve selects source (sample, reagent, wash solution)</li> <li>Syringe aspirates fluid through holding coil (fluid stays in coil, not syringe)</li> <li>Valve switches to destination </li> <li>Syringe pushes fluid from holding coil to destination</li> <li>Repeat for complex procedures</li> </ol>"},{"location":"sia-api/sia_introduction/#si_api-module-overview","title":"SI_API Module Overview","text":"<p>The SI_API provides Python control for Sequential Injection systems with three main components:</p>"},{"location":"sia-api/sia_introduction/#core-communication-core","title":"Core Communication (<code>core/</code>)","text":"<ul> <li>Universal serial interface for analytical instruments</li> <li>Extensible design for custom devices (Arduino, ESP32, etc.)</li> <li>Error handling and connection management</li> <li>Protocol abstraction for different command formats</li> </ul>"},{"location":"sia-api/sia_introduction/#device-controllers-devices","title":"Device Controllers (<code>devices/</code>)","text":"<ul> <li>SyringeController: Complete syringe pump automation</li> <li>ValveSelector: Multi-position valve control</li> <li>Hamilton MVP compatibility: Tested with industry-standard pumps</li> <li>VICI valve support: Compatible with common valve selectors</li> </ul>"},{"location":"sia-api/sia_introduction/#workflow-methods-methods","title":"Workflow Methods (<code>methods/</code>)","text":"<ul> <li>High-level automation: Complete analytical procedures</li> <li>CE integration: Seamless connection with ChemStation</li> <li>Sample preparation: Automated dilution, mixing, homogenization</li> <li>Configurable parameters: Adaptable to different applications</li> </ul>"},{"location":"sia-api/sia_introduction/#key-benefits","title":"Key Benefits","text":"<p>Automation - Unattended operation for hours - Consistent, reproducible results - Reduced manual errors</p> <p>Precision - Microliter volume accuracy - Controlled flow rates - Precise timing</p> <p>Flexibility  - Multiple sample handling modes - Custom workflow creation - Integration with analytical instruments</p> <p>Efficiency - Parallel sample preparation - Minimal reagent consumption - High sample throughput</p>"},{"location":"sia-api/sia_introduction/#documentation-resources","title":"Documentation Resources","text":"<p>For detailed hardware specifications and setup procedures:</p> <ul> <li>Device Manuals - Complete hardware documentation and setup guides</li> <li>Syringe Pump Manual - Cavro XCalibur manual</li> <li>Valve Manual - VICI Universal Actuator documentation</li> </ul>"},{"location":"sia-api/sia_introduction/#quick-start-example","title":"Quick Start Example","text":"<pre><code>from SI_API import SyringeController, ValveSelector\nfrom SI_API.methods import PreparedSIMethods\n\n# Initialize hardware\nsyringe = SyringeController(port=\"COM3\", syringe_size=1000)\nvalve = ValveSelector(port=\"COM4\", num_positions=8)\n\n# Create workflow system\nworkflow = PreparedSIMethods(chemstation_api, syringe, valve)\n\n# Initialize and clean system\nworkflow.system_initialization_and_cleaning()\n\n# Prepare samples\nworkflow.continuous_fill(vial=15, volume=500, solvent_port=3)\nworkflow.homogenize_sample(vial=15, speed=1000, time=30)\n</code></pre>"},{"location":"sia-api/sia_introduction/#next-steps","title":"Next Steps","text":"<ul> <li>Core Communication: Learn about the underlying communication system</li> <li>Syringe Control: Master precise fluid handling</li> <li>Valve Control: Control fluid routing</li> <li>CE Workflows: Build complete analytical procedures</li> </ul>"},{"location":"sia-api/syringe_control/","title":"Syringe Control","text":""},{"location":"sia-api/syringe_control/#overview","title":"Overview","text":"<p>The <code>SyringeController</code> class provides complete automation of syringe pumps for precise fluid handling in SI systems. It supports Hamilton MVP series and compatible pumps with automatic volume tracking and safety features.</p>"},{"location":"sia-api/syringe_control/#quick-start","title":"Quick Start","text":"<pre><code>from SI_API.devices import SyringeController\n\n# Initialize syringe pump\nsyringe = SyringeController(\n    port=\"COM3\",        # Serial port\n    syringe_size=1000,  # 1000 \u00b5L syringe\n    microstep_mode=False  # Standard resolution\n)\n\n# Basic operations\nsyringe.initialize()                    # Home to zero position\nsyringe.set_speed_uL_min(1500)         # Set flow rate\nsyringe.aspirate(500)                   # Draw 500 \u00b5L\nsyringe.dispense(250)                   # Dispense 250 \u00b5L\n</code></pre>"},{"location":"sia-api/syringe_control/#speed-limits-and-calculations","title":"Speed Limits and Calculations","text":"<p>The syringe controller automatically calculates flow rate limits based on syringe size:</p> <ul> <li>Minimum speed: <code>0.05 \u00d7 syringe_size</code> \u00b5L/min</li> <li>Maximum speed: <code>60 \u00d7 syringe_size</code> \u00b5L/min</li> </ul> <p>These limits are set in the syringe firmware, but very high speeds can damage the syringe or the system.</p>"},{"location":"sia-api/syringe_control/#supported-syringe-sizes","title":"Supported Syringe Sizes","text":"<p>The controller supports standard syringe volumes:</p> <ul> <li>50, 100, 250, 500, 1000, 2500, 5000 \u00b5L</li> </ul> <p>Each size has optimized parameters for:</p> <ul> <li>Resolution: Volume per increment (0.02-1.67 \u00b5L depending on size)</li> <li>Speed limits: Minimum and maximum flow rates</li> <li>Initialization force: Appropriate for syringe mechanics</li> </ul>"},{"location":"sia-api/syringe_control/#basic-operations","title":"Basic Operations","text":""},{"location":"sia-api/syringe_control/#initialization","title":"Initialization","text":"<p>Always start with syringe initialization:</p> <pre><code># Initialize to home position (volume = 0)\nsyringe.initialize()\nprint(f\"Syringe ready: {syringe.volume_counter} \u00b5L\")\n</code></pre>"},{"location":"sia-api/syringe_control/#volume-control","title":"Volume Control","text":"<pre><code># Aspirate specific volume\nsyringe.aspirate(300)           # Draw 300 \u00b5L\nprint(f\"Current volume: {syringe.volume_counter} \u00b5L\")  # Shows 300\n\n# Aspirate to full capacity\nsyringe.aspirate()              # Fill completely (700 \u00b5L remaining)\n\n# Dispense specific volume  \nsyringe.dispense(200)           # Dispense 200 \u00b5L\n\n# Dispense all contents\nsyringe.dispense()              # Empty completely\n</code></pre>"},{"location":"sia-api/syringe_control/#flow-rate-control","title":"Flow Rate Control","text":"<pre><code># Set different speeds for different operations\nsyringe.set_speed_uL_min(3000)  # Fast transfer\nsyringe.set_speed_uL_min(1000)  # Precise dispensing  \nsyringe.set_speed_uL_min(500)   # Gentle mixing\n\n# Speed limits depend on syringe size:\n# Minimum: 0.05 \u00d7 syringe_size \u00b5L/min\n# Maximum: 60 \u00d7 syringe_size \u00b5L/min\n</code></pre>"},{"location":"sia-api/syringe_control/#emergency-operations","title":"Emergency Operations","text":""},{"location":"sia-api/syringe_control/#emergency-stop","title":"Emergency Stop","text":"<pre><code># Immediately halt all syringe operations\nsyringe.emergency_stop()\n</code></pre> <p>The <code>emergency_stop()</code> method:</p> <ul> <li>Immediately terminates any running operation</li> <li>Updates volume counter to reflect current position</li> <li>Safe to use during any operation for safety shutdowns</li> <li>Automatic status update ensures accurate volume tracking</li> </ul> <p>Use this method when:</p> <ul> <li>System errors are detected</li> <li>Manual intervention is needed</li> <li>Safety concerns arise</li> <li>Process needs immediate termination</li> </ul> <pre><code># Example emergency handling\ntry:\n    syringe.aspirate(1000)\nexcept KeyboardInterrupt:\n    syringe.emergency_stop()  # Safe shutdown\n    print(f\"Emergency stop - current volume: {syringe.volume_counter} \u00b5L\")\n</code></pre>"},{"location":"sia-api/syringe_control/#volume-tracking","title":"Volume Tracking","text":"<p>The controller automatically tracks syringe contents:</p> <pre><code># Check current volume\nsyringe.print_volume_in_syringe()\n# Output: \"The current volume in the syringe is: 250.0 \u00b5l\"\n\n# Get actual volume from pump\nactual_volume = syringe.get_actual_volume()\nprint(f\"Pump reports: {actual_volume} \u00b5L\")\n\n# Volume validation prevents errors\ntry:\n    syringe.aspirate(2000)  # Exceeds 1000 \u00b5L capacity\nexcept ValueError as e:\n    print(f\"Error: {e}\")\n</code></pre>"},{"location":"sia-api/syringe_control/#valve-control","title":"Valve Control","text":"<p>For syringes with attached valves:</p> <pre><code># Configure valve type first\nsyringe.configuration_valve_type('3-Port')\n\n# Control valve positions\nsyringe.valve_in()    # Input position (aspiration)\nsyringe.valve_out()   # Output position (dispensing)  \nsyringe.valve_up()    # Bypass/waste position\n</code></pre>"},{"location":"sia-api/syringe_control/#supported-valve-types","title":"Supported Valve Types","text":"<ul> <li>'No' - No valve attached</li> <li>'3-Port' - Standard 3-way valve</li> <li>'4-Port' - 4-way selection valve</li> <li>'6-Port distribution' - 6-port selection</li> <li>'12-Port distribution' - 12-port selection</li> <li>And more (see API reference)</li> </ul>"},{"location":"sia-api/syringe_control/#advanced-features","title":"Advanced Features","text":""},{"location":"sia-api/syringe_control/#progress-monitoring","title":"Progress Monitoring","text":"<pre><code># Show progress bar during long operations\nsyringe.aspirate(1000, show_progress=True)\n# Output: Processing: 67%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588  | 4.2s/6.3s [00:04&lt;00:02]\n</code></pre>"},{"location":"sia-api/syringe_control/#non-blocking-operations","title":"Non-blocking Operations","text":"<pre><code># Start operation without waiting\nsyringe.aspirate(500, wait=False)\n\n# Do other work...\nprint(\"Operation started, doing other tasks\")\n\n# Check if pump is ready\nwhile not syringe._is_pump_ready():\n    time.sleep(0.1)\nprint(\"Aspiration completed\")\n</code></pre>"},{"location":"sia-api/syringe_control/#high-resolution-mode","title":"High-Resolution Mode","text":"<pre><code># Enable microstep mode for higher precision\nsyringe.set_microstep_mode(True)\nprint(f\"Resolution: {syringe.resolution:.3f} \u00b5L/step\")\n# Standard: ~0.33 \u00b5L/step \u2192 Microstep: ~0.04 \u00b5L/step\n</code></pre>"},{"location":"sia-api/syringe_control/#error-handling","title":"Error Handling","text":""},{"location":"sia-api/syringe_control/#common-error-types","title":"Common Error Types","text":"<pre><code># Volume overflow\ntry:\n    syringe.aspirate(1200)  # Exceeds 1000 \u00b5L\nexcept ValueError as e:\n    print(f\"Volume error: {e}\")\n\n# Communication error\ntry:\n    syringe.initialize()\nexcept serial.SerialException as e:\n    print(f\"Communication error: {e}\")\n    # Check port, cable, power\n\n# Speed out of range\ntry:\n    syringe.set_speed_uL_min(100000)  # Too fast\nexcept ValueError as e:\n    print(f\"Speed error: {e}\")\n</code></pre>"},{"location":"sia-api/syringe_control/#recovery-procedures","title":"Recovery Procedures","text":"<pre><code>def reset_syringe():\n    \"\"\"Complete syringe reset\"\"\"\n    try:\n        syringe.emergency_stop()  # Stop immediately\n        syringe.initialize()      # Re-home\n        syringe.set_speed_uL_min(2000)  # Reset speed\n        print(\"Syringe reset successful\")\n    except Exception as e:\n        print(f\"Reset failed: {e}\")\n</code></pre>"},{"location":"sia-api/syringe_control/#integration-tips","title":"Integration Tips","text":""},{"location":"sia-api/syringe_control/#with-valveselector","title":"With ValveSelector","text":"<pre><code># Coordinate syringe and external valve\nfrom SI_API.devices import ValveSelector\n\nsyringe = SyringeController(\"COM3\", 1000)\nvalve = ValveSelector(\"COM4\", 8)\n\n# Transfer from port 3 to port 6\nvalve.position(3)       # Select source\nsyringe.aspirate(500)   # Draw liquid\nvalve.position(6)       # Select destination  \nsyringe.dispense(500)   # Deliver liquid\n</code></pre>"},{"location":"sia-api/syringe_control/#with-error-recovery","title":"With Error Recovery","text":"<pre><code>def robust_operation():\n    \"\"\"Operation with automatic error recovery\"\"\"\n    max_attempts = 3\n\n    for attempt in range(max_attempts):\n        try:\n            syringe.aspirate(500)\n            syringe.dispense(500)\n            break  # Success\n        except Exception as e:\n            print(f\"Attempt {attempt+1} failed: {e}\")\n            if attempt &lt; max_attempts - 1:\n                syringe.initialize()  # Reset and retry\n            else:\n                raise  # Final attempt failed\n</code></pre>"},{"location":"sia-api/syringe_control/#documentation-references","title":"Documentation References","text":"<p>For detailed hardware information, command specifications, and troubleshooting:</p> <ul> <li>Cavro XCalibur Operating Manual - Comprehensive pump specifications and setup</li> </ul>"},{"location":"sia-api/syringe_control/#next-steps","title":"Next Steps","text":"<ul> <li>Valve Control: Learn to control multi-position valves</li> <li>CE Workflows: Combine syringe and valve for complete automation</li> </ul>"},{"location":"sia-api/valve_control/","title":"Valve Control","text":""},{"location":"sia-api/valve_control/#overview","title":"Overview","text":"<p>The <code>ValveSelector</code> class controls multi-position valve selectors for automated fluid routing in SI systems. It supports VICI/Valco and compatible valves with 2-12 positions.</p>"},{"location":"sia-api/valve_control/#quick-start","title":"Quick Start","text":"<pre><code>from SI_API.devices import ValveSelector\n\n# Initialize valve selector\nvalve = ValveSelector(\n    port=\"COM4\",         # Serial port\n    num_positions=8,     # 8-position valve\n    prefix=\"/Z\",         # VICI standard prefix\n    baudrate=9600        # Communication speed\n)\n\n# Basic operation\nvalve.position(1)        # Move to position 1\nvalve.position(5)        # Move to position 5\n</code></pre>"},{"location":"sia-api/valve_control/#valve-types-and-configurations","title":"Valve Types and Configurations","text":""},{"location":"sia-api/valve_control/#common-valve-configurations","title":"Common Valve Configurations","text":"<p>6-Position Valve: <pre><code>valve = ValveSelector(\"COM4\", num_positions=6)\n</code></pre></p> <p>8-Position Valve: <pre><code>valve = ValveSelector(\"COM4\", num_positions=8)\n</code></pre></p> <p>12-Position Valve: <pre><code>valve = ValveSelector(\"COM4\", num_positions=12)\n</code></pre></p>"},{"location":"sia-api/valve_control/#basic-operations","title":"Basic Operations","text":""},{"location":"sia-api/valve_control/#position-control","title":"Position Control","text":"<pre><code># Move to specific positions\nvalve.position(1)    # Position 1\nvalve.position(3)    # Position 3\nvalve.position(8)    # Position 8\n\n# Position validation is automatic\ntry:\n    valve.position(15)  # Error: exceeds 8 positions\nexcept ValueError as e:\n    print(f\"Invalid position: {e}\")\n</code></pre>"},{"location":"sia-api/valve_control/#reliable-positioning","title":"Reliable Positioning","text":"<pre><code># Use multiple attempts for critical operations\nvalve.position(5, num_attempts=5)  # Try up to 5 times\n\n# Some valves may not respond on first attempt\n# Multiple attempts ensure reliable positioning\n</code></pre>"},{"location":"sia-api/valve_control/#integration-with-syringe","title":"Integration with Syringe","text":""},{"location":"sia-api/valve_control/#basic-fluid-transfer","title":"Basic Fluid Transfer","text":"<pre><code>from SI_API.devices import SyringeController, ValveSelector\n\nsyringe = SyringeController(\"COM3\", 1000)\nvalve = ValveSelector(\"COM4\", 8)\n\ndef transfer_fluid(source_port, dest_port, volume):\n    \"\"\"Transfer fluid between ports\"\"\"\n    # Select source\n    valve.position(source_port)\n    syringe.aspirate(volume)\n\n    # Select destination\n    valve.position(dest_port)\n    syringe.dispense(volume)\n\n# Transfer 500 \u00b5L from port 3 to port 6\ntransfer_fluid(source_port=3, dest_port=6, volume=500)\n</code></pre>"},{"location":"sia-api/valve_control/#multi-step-procedures","title":"Multi-Step Procedures","text":"<pre><code>def prepare_dilution(sample_port, buffer_port, waste_port):\n    \"\"\"Prepare diluted sample\"\"\"\n\n    # Aspirate buffer first (reverse order prevents contamination)\n    valve.position(buffer_port)\n    syringe.aspirate(900)  # 900 \u00b5L buffer\n\n    # Add sample\n    valve.position(sample_port)  \n    syringe.aspirate(100)  # 100 \u00b5L sample (1:10 dilution)\n\n    # Mix by dispensing to waste and re-aspirating\n    valve.position(waste_port)\n    syringe.dispense(50)   # Remove air bubble\n\n    valve.position(sample_port)\n    syringe.dispense()     # Deliver mixture\n\nprepare_dilution(sample_port=4, buffer_port=3, waste_port=1)\n</code></pre>"},{"location":"sia-api/valve_control/#best-practices","title":"Best Practices","text":""},{"location":"sia-api/valve_control/#1-port-assignment-planning","title":"1. Port Assignment Planning","text":"<pre><code># Document your port assignments clearly\nPORT_ASSIGNMENTS = {\n    'WASTE': 1,\n    'AIR': 2,\n    'DI_WATER': 3, \n    'SAMPLE_A': 4,\n    'SAMPLE_B': 5,\n    'BUFFER': 6,\n    'CLEANING': 7,\n    'TO_INSTRUMENT': 8\n}\n\n# Use constants instead of numbers\nvalve.position(PORT_ASSIGNMENTS['WASTE'])  # Clear intent\nvalve.position(1)                          # Unclear\n</code></pre>"},{"location":"sia-api/valve_control/#2-minimize-valve-switching","title":"2. Minimize Valve Switching","text":"<pre><code># Inefficient: many valve switches\nvalve.position(3)\nsyringe.aspirate(100)\nvalve.position(4) \nsyringe.aspirate(100)\nvalve.position(3)\nsyringe.aspirate(100)\n\n# Better: group operations by port\nvalve.position(3)\nsyringe.aspirate(200)  # Get all water at once\nvalve.position(4)\nsyringe.aspirate(100)\n</code></pre>"},{"location":"sia-api/valve_control/#documentation-references","title":"Documentation References","text":"<p>For comprehensive valve specifications and setup procedures:</p> <ul> <li>VICI Universal Actuator Manual - Complete hardware specifications and setup procedures</li> </ul>"},{"location":"sia-api/valve_control/#next-steps","title":"Next Steps","text":"<ul> <li>CE Workflows: Learn to combine valve and syringe control for complete analytical workflows</li> </ul>"},{"location":"tutorials/batch-processing/","title":"Batch Processing Tutorial","text":"<p>Learn how to analyze multiple samples automatically using sequences and SIA sample preparation.</p>"},{"location":"tutorials/batch-processing/#overview","title":"Overview","text":"<p>In this tutorial, we'll: - Prepare multiple samples with different dilutions - Create a sequence from Excel data - Run automated batch analysis - Handle different sample types - Monitor batch progress</p>"},{"location":"tutorials/batch-processing/#scenario","title":"Scenario","text":"<p>We'll analyze 10 protein samples: - 2 standards (known concentration) - 6 unknown samples - 2 QC samples - Each requires different dilution factors</p>"},{"location":"tutorials/batch-processing/#step-1-prepare-excel-file","title":"Step 1: Prepare Excel File","text":"<p>Create <code>batch_samples.xlsx</code> with this structure:</p> Vial Method Sample_Name Dilution Type 10 CE_Protein STD_Low 5 Standard 11 CE_Protein STD_High 20 Standard 12 CE_Protein Sample_001 10 Unknown 13 CE_Protein Sample_002 10 Unknown 14 CE_Protein Sample_003 15 Unknown 15 CE_Protein QC_001 10 QC 16 CE_Protein Sample_004 10 Unknown 17 CE_Protein Sample_005 12 Unknown 18 CE_Protein Sample_006 8 Unknown 19 CE_Protein QC_002 10 QC"},{"location":"tutorials/batch-processing/#step-2-initialize-system","title":"Step 2: Initialize System","text":"<pre><code>import pandas as pd\nimport time\nfrom datetime import datetime\nfrom ChemstationAPI import ChemstationAPI\nfrom SIA_API.devices import syringeController, ValveSelector\nfrom SIA_API.methods import PreparedSIAMethods\n\n# Initialize all components\nprint(\"=== Batch Processing Tutorial ===\\n\")\nprint(f\"Date: {datetime.now().strftime('%Y-%m-%d %H:%M')}\")\n\n# Connect to devices\nce_api = ChemstationAPI()\nsyringe = syringeController(port=\"COM3\", syringe_size=1000)\nvalve = ValveSelector(port=\"COM4\", num_positions=8)\nworkflow = PreparedSIAMethods(ce_api, syringe, valve)\n\n# System initialization\nprint(\"\\nInitializing system...\")\nworkflow.system_initialization_and_cleaning()\nprint(\"\u2713 System ready\")\n</code></pre>"},{"location":"tutorials/batch-processing/#step-3-load-and-validate-sample-data","title":"Step 3: Load and Validate Sample Data","text":"<pre><code># Load sample information\nprint(\"\\nLoading sample data...\")\nsamples_df = pd.read_excel(\"batch_samples.xlsx\")\nprint(f\"\u2713 Loaded {len(samples_df)} samples\")\n\n# Display sample summary\nprint(\"\\nSample Summary:\")\nprint(f\"Standards: {len(samples_df[samples_df['Type'] == 'Standard'])}\")\nprint(f\"Unknowns: {len(samples_df[samples_df['Type'] == 'Unknown'])}\")\nprint(f\"QC: {len(samples_df[samples_df['Type'] == 'QC'])}\")\n\n# Validate all vials are present\nprint(\"\\nValidating vials...\")\nmissing_vials = []\nfor vial in samples_df['Vial']:\n    try:\n        ce_api.validation.validate_vial_in_system(int(vial))\n    except:\n        missing_vials.append(vial)\n\nif missing_vials:\n    print(f\"\u2717 Missing vials: {missing_vials}\")\n    print(\"Please load all vials before continuing\")\n    exit(1)\nelse:\n    print(\"\u2713 All vials present\")\n\n# Validate method\nmethod_name = samples_df['Method'].iloc[0]\nce_api.validation.validate_method_name(method_name)\nprint(f\"\u2713 Method '{method_name}' validated\")\n</code></pre>"},{"location":"tutorials/batch-processing/#step-4-automated-sample-preparation","title":"Step 4: Automated Sample Preparation","text":"<pre><code>def prepare_samples(samples_df):\n    \"\"\"Prepare all samples with specified dilutions.\"\"\"\n\n    print(\"\\n=== Sample Preparation ===\")\n\n    # Prepare for continuous flow with DI water\n    workflow.prepare_continuous_flow(solvent_port=3, speed=2000)\n\n    preparation_log = []\n\n    for idx, row in samples_df.iterrows():\n        vial = int(row['Vial'])\n        dilution = int(row['Dilution'])\n        sample_name = row['Sample_Name']\n        sample_type = row['Type']\n\n        print(f\"\\nPreparing {sample_name} (Vial {vial})\")\n        print(f\"Type: {sample_type}, Dilution: 1:{dilution}\")\n\n        # Calculate volumes (1500 \u00b5L final volume)\n        final_volume = 1500\n        sample_volume = final_volume / dilution\n        diluent_volume = final_volume - sample_volume\n\n        # Add diluent\n        workflow.continuous_fill(\n            vial=vial,\n            volume=diluent_volume,\n            solvent_port=3,\n            flush_needle=None  # No wash between same solvent\n        )\n\n        # Log preparation\n        prep_info = {\n            'vial': vial,\n            'sample': sample_name,\n            'sample_vol': sample_volume,\n            'diluent_vol': diluent_volume,\n            'time': datetime.now()\n        }\n        preparation_log.append(prep_info)\n\n        print(f\"\u2713 Added {diluent_volume:.0f} \u00b5L diluent\")\n        print(f\"  \u2192 Add {sample_volume:.0f} \u00b5L sample manually\")\n\n    # Clean needle after all dilutions\n    workflow.clean_needle(volume_flush=100, wash_vial=48)\n\n    return preparation_log\n\n# Prepare all samples\nprep_log = prepare_samples(samples_df)\n\nprint(\"\\n\u26a0 Add samples to vials according to the volumes shown above\")\ninput(\"Press Enter when all samples are added...\")\n</code></pre>"},{"location":"tutorials/batch-processing/#step-5-mix-all-samples","title":"Step 5: Mix All Samples","text":"<pre><code># Homogenize all samples\nprint(\"\\n=== Sample Mixing ===\")\n\nfor idx, row in samples_df.iterrows():\n    vial = int(row['Vial'])\n    sample_name = row['Sample_Name']\n\n    print(f\"Mixing {sample_name}...\", end='')\n\n    workflow.homogenize_sample(\n        vial=vial,\n        speed=1000,\n        homogenization_time=20,\n        flush_needle=None,  # Wash at end\n        unload=True\n    )\n\n    print(\" \u2713\")\n\n# Final needle wash\nworkflow.clean_needle(volume_flush=100, wash_vial=48)\nprint(\"\\n\u2713 All samples prepared and mixed\")\n</code></pre>"},{"location":"tutorials/batch-processing/#step-6-create-ce-sequence","title":"Step 6: Create CE Sequence","text":"<pre><code># Create sequence in ChemStation\nprint(\"\\n=== Creating CE Sequence ===\")\n\n# Import sequence from Excel\nce_api.sequence.prepare_sequence_table(\n    excel_file_path=\"batch_samples.xlsx\",\n    sequence_name=\"Batch_Tutorial\",\n    vial_column=\"Vial\",\n    method_column=\"Method\",\n    sample_name_column=\"Sample_Name\"\n)\n\nprint(\"\u2713 Sequence created from Excel\")\n\n# Add sample info to sequence\nfor idx, row in samples_df.iterrows():\n    ce_api.sequence.modify_sequence_row(\n        row=idx + 1,\n        sample_info=f\"Type: {row['Type']}, Dilution: 1:{row['Dilution']}\"\n    )\n\n# Save sequence\nsequence_name = f\"Batch_{datetime.now().strftime('%Y%m%d_%H%M')}\"\nce_api.sequence.save_sequence(sequence_name)\nprint(f\"\u2713 Sequence saved as: {sequence_name}\")\n</code></pre>"},{"location":"tutorials/batch-processing/#step-7-pre-analysis-setup","title":"Step 7: Pre-Analysis Setup","text":"<pre><code># Condition system before batch run\nprint(\"\\n=== Pre-Analysis Setup ===\")\n\n# Load buffer vials\nprint(\"Loading buffer vials...\")\nce_api.ce.load_vial_to_position(1, \"inlet\")  # Running buffer\nce_api.ce.load_vial_to_position(48, \"outlet\")  # Waste\n\n# Extended conditioning for batch run\nprint(\"Conditioning capillary (3 minutes)...\")\nce_api.ce.flush_capillary(time_flush=180.0)\n\n# Return vials\nce_api.ce.unload_vial_from_position(\"inlet\")\nce_api.ce.unload_vial_from_position(\"outlet\")\n\nprint(\"\u2713 System conditioned and ready\")\n</code></pre>"},{"location":"tutorials/batch-processing/#step-8-run-batch-analysis","title":"Step 8: Run Batch Analysis","text":"<pre><code># Start batch analysis\nprint(\"\\n=== Starting Batch Analysis ===\")\nprint(f\"Sequence: {sequence_name}\")\nprint(f\"Samples: {len(samples_df)}\")\nprint(f\"Estimated time: {len(samples_df) * 15} minutes\")\n\n# Start sequence\nce_api.sequence.start()\nprint(\"\u2713 Sequence started\")\n\n# Create analysis log\nanalysis_log = {\n    'start_time': datetime.now(),\n    'samples_completed': 0,\n    'current_sample': '',\n    'errors': []\n}\n</code></pre>"},{"location":"tutorials/batch-processing/#step-9-monitor-batch-progress","title":"Step 9: Monitor Batch Progress","text":"<pre><code>def monitor_batch_analysis(ce_api, samples_df, analysis_log):\n    \"\"\"Monitor batch analysis with progress tracking.\"\"\"\n\n    print(\"\\n=== Monitoring Progress ===\")\n    print(\"Press Ctrl+C to stop monitoring (analysis continues)\\n\")\n\n    try:\n        last_status = \"\"\n        sample_start_time = time.time()\n\n        while True:\n            # Get current status\n            status = ce_api.system.status()\n            rc_status = ce_api.system.RC_status()\n\n            # Detect sample changes\n            if status == \"RUN\" and last_status != \"RUN\":\n                analysis_log['samples_completed'] += 1\n                sample_start_time = time.time()\n\n                if analysis_log['samples_completed'] &lt;= len(samples_df):\n                    current_sample = samples_df.iloc[\n                        analysis_log['samples_completed'] - 1\n                    ]['Sample_Name']\n                    analysis_log['current_sample'] = current_sample\n                    print(f\"\\n\u2192 Analyzing {current_sample}\")\n\n            # Display progress\n            if ce_api.system.method_on():\n                remaining = ce_api.system.get_remaining_analysis_time()\n                elapsed = (time.time() - sample_start_time) / 60\n\n                print(f\"\\r[{analysis_log['samples_completed']}/{len(samples_df)}] \"\n                      f\"{analysis_log['current_sample']} - \"\n                      f\"Status: {status} - \"\n                      f\"Remaining: {remaining:.1f} min\", end='')\n            else:\n                # Check if sequence is complete\n                if analysis_log['samples_completed'] &gt;= len(samples_df):\n                    print(\"\\n\\n\u2713 Batch analysis complete!\")\n                    break\n                else:\n                    print(f\"\\rWaiting for next sample...\", end='')\n\n            last_status = status\n            time.sleep(5)\n\n    except KeyboardInterrupt:\n        print(\"\\n\\nMonitoring stopped (analysis continues)\")\n\n    return analysis_log\n\n# Monitor the batch\nanalysis_log = monitor_batch_analysis(ce_api, samples_df, analysis_log)\n</code></pre>"},{"location":"tutorials/batch-processing/#step-10-post-analysis-summary","title":"Step 10: Post-Analysis Summary","text":"<pre><code># Generate analysis summary\nprint(\"\\n=== Analysis Summary ===\")\n\nanalysis_log['end_time'] = datetime.now()\ntotal_time = (analysis_log['end_time'] - analysis_log['start_time']).seconds / 60\n\nprint(f\"Start Time: {analysis_log['start_time'].strftime('%H:%M')}\")\nprint(f\"End Time: {analysis_log['end_time'].strftime('%H:%M')}\")\nprint(f\"Total Duration: {total_time:.1f} minutes\")\nprint(f\"Samples Completed: {analysis_log['samples_completed']}/{len(samples_df)}\")\n\n# Calculate statistics\navg_time = total_time / analysis_log['samples_completed'] if analysis_log['samples_completed'] &gt; 0 else 0\nprint(f\"Average Time per Sample: {avg_time:.1f} minutes\")\n\n# Sample type breakdown\nif analysis_log['samples_completed'] == len(samples_df):\n    print(\"\\nSamples Analyzed:\")\n    for sample_type in samples_df['Type'].unique():\n        count = len(samples_df[samples_df['Type'] == sample_type])\n        print(f\"  {sample_type}: {count}\")\n\n# Save summary report\nreport_filename = f\"batch_report_{datetime.now().strftime('%Y%m%d_%H%M')}.txt\"\nwith open(report_filename, 'w') as f:\n    f.write(\"Batch Analysis Report\\n\")\n    f.write(\"=\" * 50 + \"\\n\")\n    f.write(f\"Date: {datetime.now().strftime('%Y-%m-%d')}\\n\")\n    f.write(f\"Sequence: {sequence_name}\\n\")\n    f.write(f\"Total Samples: {len(samples_df)}\\n\")\n    f.write(f\"Duration: {total_time:.1f} minutes\\n\")\n    f.write(\"\\nSample Details:\\n\")\n    for _, row in samples_df.iterrows():\n        f.write(f\"  {row['Sample_Name']} - Vial {row['Vial']} - \"\n                f\"Dilution 1:{row['Dilution']}\\n\")\n\nprint(f\"\\n\u2713 Report saved as: {report_filename}\")\n</code></pre>"},{"location":"tutorials/batch-processing/#complete-batch-processing-script","title":"Complete Batch Processing Script","text":"<pre><code># Complete Batch Processing Script\nimport pandas as pd\nimport time\nfrom datetime import datetime\nfrom ChemstationAPI import ChemstationAPI\nfrom SIA_API.devices import syringeController, ValveSelector\nfrom SIA_API.methods import PreparedSIAMethods\n\ndef run_batch_analysis(excel_file=\"batch_samples.xlsx\"):\n    \"\"\"Complete batch analysis with SIA preparation.\"\"\"\n\n    # Initialize\n    ce_api = ChemstationAPI()\n    syringe = syringeController(port=\"COM3\", syringe_size=1000)\n    valve = ValveSelector(port=\"COM4\", num_positions=8)\n    workflow = PreparedSIAMethods(ce_api, syringe, valve)\n\n    # System preparation\n    workflow.system_initialization_and_cleaning()\n\n    # Load samples\n    samples_df = pd.read_excel(excel_file)\n\n    # Validate\n    for vial in samples_df['Vial']:\n        ce_api.validation.validate_vial_in_system(int(vial))\n\n    # Prepare samples\n    workflow.prepare_continuous_flow(solvent_port=3)\n\n    for _, row in samples_df.iterrows():\n        vial = int(row['Vial'])\n        dilution = int(row['Dilution'])\n        diluent_volume = 1500 * (dilution - 1) / dilution\n\n        workflow.continuous_fill(\n            vial=vial,\n            volume=diluent_volume,\n            solvent_port=3\n        )\n\n    input(\"\\nAdd samples and press Enter...\")\n\n    # Mix all samples\n    for vial in samples_df['Vial']:\n        workflow.homogenize_sample(\n            vial=int(vial),\n            speed=1000,\n            homogenization_time=20\n        )\n\n    # Create and run sequence\n    ce_api.sequence.prepare_sequence_table(\n        excel_file_path=excel_file,\n        vial_column=\"Vial\",\n        method_column=\"Method\",\n        sample_name_column=\"Sample_Name\"\n    )\n\n    ce_api.sequence.start()\n\n    # Monitor\n    samples_done = 0\n    while samples_done &lt; len(samples_df):\n        if ce_api.system.method_on():\n            remaining = ce_api.system.get_remaining_analysis_time()\n            print(f\"\\r[{samples_done + 1}/{len(samples_df)}] \"\n                  f\"Remaining: {remaining:.1f} min\", end='')\n        time.sleep(10)\n\n    print(\"\\n\u2713 Batch complete!\")\n\nif __name__ == \"__main__\":\n    run_batch_analysis()\n</code></pre>"},{"location":"tutorials/batch-processing/#advanced-batch-processing","title":"Advanced Batch Processing","text":""},{"location":"tutorials/batch-processing/#intelligent-sample-grouping","title":"Intelligent Sample Grouping","text":"<pre><code>def group_samples_by_dilution(samples_df):\n    \"\"\"Group samples by dilution to optimize preparation.\"\"\"\n\n    grouped = samples_df.groupby('Dilution')\n\n    for dilution, group in grouped:\n        print(f\"\\nDilution 1:{dilution} ({len(group)} samples):\")\n\n        # Prepare all samples with same dilution together\n        workflow.prepare_continuous_flow(solvent_port=3)\n\n        for _, sample in group.iterrows():\n            vial = int(sample['Vial'])\n            volume = 1500 * (dilution - 1) / dilution\n\n            workflow.continuous_fill(\n                vial=vial,\n                volume=volume,\n                solvent_port=3,\n                flush_needle=None\n            )\n\n        # Wash between dilution groups\n        workflow.clean_needle(100)\n</code></pre>"},{"location":"tutorials/batch-processing/#error-recovery","title":"Error Recovery","text":"<pre><code>def batch_with_error_recovery():\n    \"\"\"Run batch with automatic error recovery.\"\"\"\n\n    max_retries = 3\n    failed_samples = []\n\n    for _, sample in samples_df.iterrows():\n        retry_count = 0\n        success = False\n\n        while retry_count &lt; max_retries and not success:\n            try:\n                ce_api.method.execution_method_with_parameters(\n                    vial=int(sample['Vial']),\n                    method_name=sample['Method'],\n                    sample_name=sample['Sample_Name']\n                )\n\n                # Wait for completion\n                while ce_api.system.method_on():\n                    time.sleep(30)\n\n                success = True\n\n            except Exception as e:\n                retry_count += 1\n                print(f\"\\nError with {sample['Sample_Name']}: {e}\")\n\n                if retry_count &lt; max_retries:\n                    print(f\"Retrying ({retry_count}/{max_retries})...\")\n                    ce_api.system.abort_run()\n                    time.sleep(60)\n                else:\n                    failed_samples.append(sample['Sample_Name'])\n\n    if failed_samples:\n        print(f\"\\nFailed samples: {failed_samples}\")\n</code></pre>"},{"location":"tutorials/batch-processing/#tips-for-efficient-batch-processing","title":"Tips for Efficient Batch Processing","text":"<ol> <li>Group Similar Samples</li> <li>Process samples with same dilution together</li> <li> <p>Minimize solvent changes</p> </li> <li> <p>Optimize Timing</p> </li> <li>Prepare next samples during current analysis</li> <li> <p>Use parallel operations when possible</p> </li> <li> <p>Quality Control</p> </li> <li>Include QC samples at regular intervals</li> <li> <p>Monitor system suitability</p> </li> <li> <p>Error Handling</p> </li> <li>Plan for sample failures</li> <li> <p>Include retry logic</p> </li> <li> <p>Documentation</p> </li> <li>Log all preparation steps</li> <li>Generate comprehensive reports</li> </ol> <p>Batch Processing Mastered!</p> <p>You can now process multiple samples efficiently. Continue to SIA-CE Integration for advanced workflows.</p>"},{"location":"tutorials/chemstation-macros/","title":"ChemStation Scripting and Macros - Complete Guide","text":"<p>This comprehensive guide covers the practical fundamentals of scripting in Agilent ChemStation, including detailed registry operations and RC.NET module interactions.</p>"},{"location":"tutorials/chemstation-macros/#overview","title":"Overview","text":"<p>ChemStation's built-in scripting capabilities enable powerful automation of analytical workflows. This guide provides hands-on examples and best practices for creating automation solutions.</p>"},{"location":"tutorials/chemstation-macros/#1-chemstation-commands","title":"1. ChemStation Commands","text":"<p>ChemStation includes a command processor (CP) that interprets and executes commands interactively or through scripts.</p>"},{"location":"tutorials/chemstation-macros/#basic-command-syntax","title":"Basic Command Syntax","text":"<p>Display Messages: <pre><code>Print \"This is a message\"\n</code></pre></p> <p>Multiple Commands per Line: Separate commands with semicolons (<code>;</code>): <pre><code>Print \"Starting\"; Sleep 2; Print \"Complete\"\n</code></pre></p> <p>Comments: Text after <code>!</code> is ignored: <pre><code>! This is a comment\nPrint \"Active command\"  ! End-of-line comment\n</code></pre></p> <p>Command History: Use <code>\u2191</code> and <code>\u2193</code> arrow keys to navigate through previous commands in the command processor.</p>"},{"location":"tutorials/chemstation-macros/#2-macro-structure-and-parameters","title":"2. Macro Structure and Parameters","text":"<p>Macros are named collections of commands that automate repetitive tasks and complex workflows.</p>"},{"location":"tutorials/chemstation-macros/#basic-macro-structure","title":"Basic Macro Structure","text":"<pre><code>Name MyMessage\n    Print \"Hello World!\"\nEndMacro\n</code></pre>"},{"location":"tutorials/chemstation-macros/#macro-parameters","title":"Macro Parameters","text":"<p>Macros can accept parameters for flexible operation. Parameters are declared using the <code>Parameter</code> statement:</p> <pre><code>Name InjectSample\n    Parameter SampleName$, VialPos, InjVol\n    Print \"Sample=\", SampleName$, \", Vial=\", VialPos, \", InjVol=\", InjVol\nEndMacro\n</code></pre> <p>Calling the macro: <pre><code>InjectSample \"Std_1\", 5, 10\n</code></pre></p>"},{"location":"tutorials/chemstation-macros/#local-variables","title":"Local Variables","text":"<p>Define local variables within macros using the <code>Local</code> statement:</p> <pre><code>Name CalculateVolume\n    Local Area, Volume, Concentration\n    Area = 2.5\n    Concentration = 0.1\n    Volume = Area * Concentration * 10\n    Print \"Calculated Volume =\", Volume\nEndMacro\n</code></pre> <p>Variable Scope: - Local variables exist only within the macro - Global variables persist throughout the ChemStation session - Use local variables to prevent naming conflicts</p>"},{"location":"tutorials/chemstation-macros/#3-loading-and-managing-macros","title":"3. Loading and Managing Macros","text":""},{"location":"tutorials/chemstation-macros/#loading-macros","title":"Loading Macros","text":"<p>Load from relative path: <pre><code>Macro \"mymacro.mac\"\n</code></pre></p> <p>Load from absolute path: <pre><code>Macro \"D:\\projects\\chem\\automation\\mymacro.mac\"\n</code></pre></p>"},{"location":"tutorials/chemstation-macros/#executing-macros","title":"Executing Macros","text":"<p>Run without parameters: <pre><code>MyMessage\n</code></pre></p> <p>Run with parameters: <pre><code>InjectSample \"Sample_A\", 3, 5.0\n</code></pre></p>"},{"location":"tutorials/chemstation-macros/#macro-management","title":"Macro Management","text":"<p>Remove macro from memory: <pre><code>Remove MyMessage\n</code></pre></p> <p>List loaded macros: <pre><code>Show Macros\n</code></pre></p>"},{"location":"tutorials/chemstation-macros/#4-variables-and-data-types","title":"4. Variables and Data Types","text":"<p>ChemStation supports several variable types for different data handling needs.</p>"},{"location":"tutorials/chemstation-macros/#variable-types","title":"Variable Types","text":"<p>String Variables: <pre><code>Sample$ = \"Test_Sample_001\"\nDataPath$ = \"C:\\ChemStation\\Data\\\"\n</code></pre></p> <p>Numeric Variables: <pre><code>Flow = 1.5\nTemperature = 25.0\nInjectionVolume = 10\n</code></pre></p>"},{"location":"tutorials/chemstation-macros/#system-variables","title":"System Variables","text":"<p>ChemStation provides built-in system variables for accessing current state information:</p> <p>Common System Variables: - <code>_DataFile$</code> - Current data file name - <code>_MethodOn</code> - Method status (0=off, 1=on) - <code>_SequenceOn</code> - Sequence status (0=off, 1=on) - <code>_AutoPath$</code> - Automatic data path - <code>_Instrument$</code> - Current instrument configuration</p> <p>Display all system variables: <pre><code>Show Variables\n</code></pre></p>"},{"location":"tutorials/chemstation-macros/#5-registry-operations","title":"5. Registry Operations","text":"<p>Registries are ChemStation's primary data containers, storing complex information about analyses, methods, chromatograms, and spectra.</p>"},{"location":"tutorials/chemstation-macros/#understanding-registry-structure","title":"Understanding Registry Structure","text":"<p>Registry Hierarchy: - Registry - Top-level container (e.g., ChromReg for chromatograms) - Objects - Individual data items within registry (e.g., ChromReg[1]) - Headers - Metadata about objects - Data Blocks - Raw analytical data - Tables - Processed results (peaks, quantification)</p>"},{"location":"tutorials/chemstation-macros/#basic-registry-operations","title":"Basic Registry Operations","text":"<p>Check registry size: <pre><code>Print RegSize(ChromReg)\n</code></pre></p> <p>List registry contents: <pre><code>Print RegCont$(ChromReg)\n</code></pre></p> <p>Access specific registry object: <pre><code>ChromReg[1]  ! Access first chromatogram\n</code></pre></p>"},{"location":"tutorials/chemstation-macros/#reading-data-from-registries","title":"Reading Data from Registries","text":"<p>Extract raw data points: <pre><code>Data(ChromReg[1], 0, 10)  ! X-axis value at point 10\nData(ChromReg[1], 1, 10)  ! Y-axis value at point 10\n</code></pre></p> <p>Read header information: <pre><code>Print ObjHdrVal$(ChromReg[1], \"SampleName\")\nPrint ObjHdrVal(ChromReg[1], \"InjectionVolume\")\n</code></pre></p>"},{"location":"tutorials/chemstation-macros/#working-with-tables","title":"Working with Tables","text":"<p>Read text from tables: <pre><code>TabText$(ChromRes[1], \"Peak\", 2, \"Name\")    ! Peak name for peak #2\n</code></pre></p> <p>Read numeric values from tables: <pre><code>TabVal(ChromRes[1], \"Peak\", 2, \"Area\")      ! Peak area for peak #2\nTabVal(ChromRes[1], \"Peak\", 2, \"RT\")        ! Retention time for peak #2\n</code></pre></p>"},{"location":"tutorials/chemstation-macros/#modifying-registry-data","title":"Modifying Registry Data","text":"<p>Update header values: <pre><code>SetObjHdrVal ChromReg[1], \"Title\", \"My Custom Chromatogram\"\nSetObjHdrVal ChromReg[1], \"SampleInfo\", \"Batch_2024_001\"\n</code></pre></p> <p>Modify data points: <pre><code>SetData ChromReg[1], 1, 10, 1500.5  ! Set Y-value at point 10\n</code></pre></p> <p>Advanced Registry Exploration: For comprehensive registry exploration, use the <code>register_reader.mac</code> utility to examine all available registry structures and data.</p>"},{"location":"tutorials/chemstation-macros/#6-rcnet-module-control","title":"6. RC.NET Module Control","text":"<p>RC.NET provides standardized communication with ChemStation modules like pumps, detectors, and autosamplers.</p>"},{"location":"tutorials/chemstation-macros/#rcnet-registry-structure","title":"RC.NET Registry Structure","text":"<p>Each module maintains three primary registries:</p> <p>Registry Types: - <code>RC&lt;ModID&gt;&lt;#&gt;Method</code> - Method parameters and settings - <code>RC&lt;ModID&gt;&lt;#&gt;Status</code> - Real-time status information (pressures, temperatures) - <code>RC&lt;ModID&gt;&lt;#&gt;Config</code> - Module configuration (type, firmware version, serial number)</p> <p>Example Module Identifiers: - <code>PMP1</code> - Quaternary Pump - <code>WLS1</code> - UV-Vis Detector - <code>ALS1</code> - Autosampler - <code>CE1</code> - Capillary Electrophoresis</p>"},{"location":"tutorials/chemstation-macros/#method-parameter-modification","title":"Method Parameter Modification","text":"<p>Standard method parameter workflow: <pre><code>! Upload current method to memory\nUploadRCMethod PMP1\n\n! Modify parameters\nSetObjHdrVal RCPMP1Method[1], \"StopTime_Time\", 10\nSetObjHdrVal RCPMP1Method[1], \"Flow\", 1.0\n\n! Download modified method to instrument\nDownloadRCMethod PMP1\n</code></pre></p> <p>Common Method Parameters: - Flow rates: <code>\"Flow\"</code>, <code>\"Flow_A\"</code>, <code>\"Flow_B\"</code> - Temperatures: <code>\"Temperature\"</code>, <code>\"ColTemp\"</code> - Times: <code>\"StopTime_Time\"</code>, <code>\"PostTime\"</code> - Volumes: <code>\"InjVol\"</code>, <code>\"MaxInjVol\"</code></p>"},{"location":"tutorials/chemstation-macros/#reading-module-status","title":"Reading Module Status","text":"<p>Current operational parameters: <pre><code>Print ObjHdrVal(RCPMP1Status[1], \"Pressure\")     ! Current pressure\nPrint ObjHdrVal(RCPMP1Status[1], \"Flow_actual\")  ! Actual flow rate\nPrint ObjHdrVal(RCWLS1Status[1], \"Lamp\")         ! Lamp status\n</code></pre></p> <p>Module configuration information: <pre><code>Print ObjHdrVal(RCPMP1Config[1], \"SerialNumber\")   ! Serial number\nPrint ObjHdrVal(RCPMP1Config[1], \"FirmwareRev\")    ! Firmware version\n</code></pre></p>"},{"location":"tutorials/chemstation-macros/#direct-module-communication","title":"Direct Module Communication","text":"<p>Send command without response: <pre><code>WriteModule \"CE1\", \"LRPL 10\"  ! Set reference wavelength\n</code></pre></p> <p>Send command and get response: <pre><code>Response$ = SendModule$(\"CE1\", \"LIFTER:OCCUPIED? 3\")  ! Check vial position\nPrint \"Vial occupied:\", Response$\n</code></pre></p> <p>Advanced module interrogation: <pre><code>Print SendModule$(\"PMP1\", \"PRES?\")     ! Query current pressure\nPrint SendModule$(\"ALS1\", \"INJ:STAT?\")  ! Query injection status\n</code></pre></p>"},{"location":"tutorials/chemstation-macros/#7-discovering-module-commands-through-trace-logs","title":"7. Discovering Module Commands Through Trace Logs","text":"<p>Module-specific commands can be discovered by monitoring ChemStation's communication logs.</p>"},{"location":"tutorials/chemstation-macros/#practical-example-vial-loading","title":"Practical Example - Vial Loading","text":"<p>Sample log entry for loading vial 50 to replenishment position: <pre><code>EventId: 228808;Timestamp: 22/07/2025 8:21:16.851;Thread Id: 25;\nMessage: LDT SendInstruction: Module:[G7150A:DEDAD01310]; \nInstruction:[RRPL]; Reply:[[G7150A:DEDAD01310:IN]: RA 00000 RRPL];\nCategory: Agilent.LCDrivers.Common.ModuleAccess, Debug;Priority: 3;\nProcess Name: C:\\Chem32\\CORE\\ChemMain.exe;\nExtended Properties: ModuleShortname - Agilent.LCDrivers.Common.ModuleAccess;\n</code></pre></p> <p>Key Information:</p> <ul> <li>Module ID: <code>G7150A:DEDAD01310</code> (CE1)</li> <li>Command: <code>LRPL 50</code> (Load Replenishment Position 50)</li> <li>Response: <code>RA 00000</code> (Response Acknowledge - Success)</li> </ul>"},{"location":"tutorials/chemstation-macros/#trace-analysis-workflow","title":"Trace Analysis Workflow","text":"<ol> <li>Monitor during operations:</li> <li>Perform action in ChemStation interface (load vial, change parameter)</li> <li> <p>Check <code>C:\\Chem32\\1\\TEMP\\rcdriver.trc</code></p> </li> <li> <p>Extract commands:</p> </li> <li>Look for <code>Instruction:</code> entries</li> <li> <p>Note the exact module ID and command syntax</p> </li> <li> <p>Test in Command Processor: <pre><code>WriteModule \"CE1\", \"LRPL 50\"  ! Load vial 50 to replenishment\n</code></pre></p> </li> </ol> <p>Common Commands Discovered: - <code>LRPL n</code> - Load replenishment position - <code>LIFTER:OCCUPIED? n</code> - Check if vial n is present</p>"},{"location":"tutorials/chemstation-macros/#10-quick-troubleshooting","title":"10. Quick Troubleshooting","text":""},{"location":"tutorials/chemstation-macros/#common-issues","title":"Common Issues","text":"<p>Module communication fails: - Verify module is online: <code>Print RCModuleReady(\"PMP1\")</code> - Restart ChemStation if persistent errors</p> <p>Registry errors: - Check registry exists: <code>Print RegSize(ChromReg)</code> - Verify object number: <code>Print RegCont$(ChromReg)</code></p> <p>Command not working: - Test in Command Processor first - Check trace logs for exact syntax - Verify module ID matches your system</p>"},{"location":"tutorials/chemstation-macros/#quick-reference-commands","title":"Quick Reference Commands","text":"<pre><code>Show                          ! List all variables\nRCListDevices$()             ! List RC.NET modules  \nPrint RegCont$(ChromReg)     ! Show registry contents\nRemove MacroName             ! Unload macro\n</code></pre> <p>For detailed registry exploration, use the provided <code>register_reader.mac</code> utility.</p>"},{"location":"tutorials/first-analysis/","title":"Your First Automated Analysis","text":"<p>This tutorial will guide you through your first automated CE analysis using the SIA-CE system. We'll analyze a single sample with automated sample preparation.</p>"},{"location":"tutorials/first-analysis/#what-well-do","title":"What We'll Do","text":"<ol> <li>Initialize the SIA system</li> <li>Prepare a sample with automated dilution</li> <li>Load the sample for CE analysis</li> <li>Run the separation</li> <li>Monitor the analysis progress</li> </ol>"},{"location":"tutorials/first-analysis/#prerequisites","title":"Prerequisites","text":"<ul> <li>ChemStation is running with the macro loaded</li> <li>SIA devices are connected and powered on</li> <li>You have identified your COM ports</li> <li>Sample and reagents are prepared</li> </ul>"},{"location":"tutorials/first-analysis/#step-1-system-setup","title":"Step 1: System Setup","text":"<pre><code># Import required modules\nfrom ChemstationAPI import ChemstationAPI\nfrom SIA_API.devices import syringeController, ValveSelector\nfrom SIA_API.methods import PreparedSIAMethods\nimport time\n\n# Initialize ChemStation connection\nprint(\"Connecting to ChemStation...\")\nce_api = ChemstationAPI()\nprint(\"\u2713 ChemStation connected\")\n\n# Initialize SIA devices\nprint(\"Initializing SIA devices...\")\nsyringe = syringeController(port=\"COM3\", syringe_size=1000)\nvalve = ValveSelector(port=\"COM4\", num_positions=8)\nprint(\"\u2713 SIA devices connected\")\n\n# Create workflow controller\nworkflow = PreparedSIAMethods(ce_api, syringe, valve)\nprint(\"\u2713 Workflow controller ready\")\n</code></pre>"},{"location":"tutorials/first-analysis/#step-2-system-initialization","title":"Step 2: System Initialization","text":"<pre><code># Perform complete system initialization\nprint(\"\\nInitializing and cleaning system...\")\nprint(\"This will take about 2 minutes\")\n\nworkflow.system_initialization_and_cleaning(\n    waste_vial=50,  # Vial 50 for waste collection\n    bubble=20       # 20 \u00b5L separating bubble\n)\n\nprint(\"\u2713 System initialized and ready\")\n</code></pre>"},{"location":"tutorials/first-analysis/#step-3-sample-information","title":"Step 3: Sample Information","text":"<pre><code># Define our sample parameters\nsample_info = {\n    'vial': 15,\n    'name': 'Protein_Sample_001',\n    'method': 'CE_Protein_Analysis',\n    'dilution': 10,  # 1:10 dilution\n    'volume': 1500   # \u00b5L final volume\n}\n\nprint(f\"\\nSample: {sample_info['name']}\")\nprint(f\"Location: Vial {sample_info['vial']}\")\nprint(f\"Dilution: 1:{sample_info['dilution']}\")\n</code></pre>"},{"location":"tutorials/first-analysis/#step-4-validate-prerequisites","title":"Step 4: Validate Prerequisites","text":"<pre><code># Check everything is ready\nprint(\"\\nValidating system...\")\n\ntry:\n    # Check sample vial exists\n    ce_api.validation.validate_vial_in_system(sample_info['vial'])\n    print(\"\u2713 Sample vial present\")\n\n    # Check waste vials\n    ce_api.validation.validate_vial_in_system(48)  # Wash vial\n    ce_api.validation.validate_vial_in_system(50)  # Waste vial\n    print(\"\u2713 Wash and waste vials present\")\n\n    # Check method exists\n    ce_api.validation.validate_method_name(sample_info['method'])\n    print(\"\u2713 CE method found\")\n\n    # Check system is ready\n    if ce_api.system.status() == \"STANDBY\":\n        print(\"\u2713 CE system ready\")\n    else:\n        print(\"\u26a0 Waiting for system...\")\n        ce_api.system.wait_for_ready(timeout=60)\n\nexcept Exception as e:\n    print(f\"\u2717 Validation failed: {e}\")\n    print(\"Please fix the issue and restart\")\n    exit(1)\n\nprint(\"\\nAll checks passed!\")\n</code></pre>"},{"location":"tutorials/first-analysis/#step-5-automated-sample-preparation","title":"Step 5: Automated Sample Preparation","text":"<pre><code># Prepare for sample dilution\nprint(f\"\\nPreparing 1:{sample_info['dilution']} dilution...\")\n\n# Calculate volumes\nsample_volume = sample_info['volume'] / sample_info['dilution']\ndiluent_volume = sample_info['volume'] - sample_volume\n\nprint(f\"Sample volume: {sample_volume:.0f} \u00b5L\")\nprint(f\"Diluent volume: {diluent_volume:.0f} \u00b5L\")\n\n# Prepare for continuous flow with DI water\nworkflow.prepare_continuous_flow(\n    solvent_port=3,  # DI water port\n    speed=2000       # 2 mL/min\n)\n\n# Note: In a real workflow, you would add the sample first,\n# then diluent. For this demo, we'll add diluent to an empty vial\nprint(\"\\nAdding diluent to vial...\")\nworkflow.continuous_fill(\n    vial=sample_info['vial'],\n    volume=diluent_volume,\n    solvent_port=3,\n    flush_needle=50\n)\n\nprint(\"\u2713 Diluent added\")\n\n# In practice, you would now add your sample\nprint(\"\\n\u26a0 Add sample to vial manually or use liquid handling robot\")\ninput(\"Press Enter when sample is added...\")\n\n# Homogenize the diluted sample\nprint(\"\\nMixing sample...\")\nworkflow.homogenize_sample(\n    vial=sample_info['vial'],\n    speed=1000,              # 1 mL/min bubbling\n    homogenization_time=30,  # 30 seconds\n    flush_needle=50\n)\n\nprint(\"\u2713 Sample prepared and mixed\")\n</code></pre>"},{"location":"tutorials/first-analysis/#step-6-ce-analysis-setup","title":"Step 6: CE Analysis Setup","text":"<pre><code># Load vials for CE analysis\nprint(\"\\nSetting up CE analysis...\")\n\n# Load sample vial to inlet\nce_api.ce.load_vial_to_position(sample_info['vial'], \"inlet\")\nprint(\"\u2713 Sample loaded to inlet\")\n\n# Load waste vial to outlet\nce_api.ce.load_vial_to_position(48, \"outlet\")\nprint(\"\u2713 Waste vial loaded to outlet\")\n\n# Condition capillary\nprint(\"\\nConditioning capillary...\")\nce_api.ce.flush_capillary(time_flush=60.0)\nprint(\"\u2713 Capillary conditioned\")\n</code></pre>"},{"location":"tutorials/first-analysis/#step-7-run-analysis","title":"Step 7: Run Analysis","text":"<pre><code># Start the CE analysis\nprint(f\"\\nStarting analysis: {sample_info['name']}\")\nprint(f\"Method: {sample_info['method']}\")\n\nce_api.method.execution_method_with_parameters(\n    vial=sample_info['vial'],\n    method_name=sample_info['method'],\n    sample_name=sample_info['name'],\n    comment=\"Tutorial first analysis\",\n    subdirectory_name=\"Tutorial_Runs\"\n)\n\nprint(\"\u2713 Analysis started\")\n</code></pre>"},{"location":"tutorials/first-analysis/#step-8-monitor-progress","title":"Step 8: Monitor Progress","text":"<pre><code># Monitor the running analysis\nprint(\"\\nMonitoring analysis...\")\nprint(\"Press Ctrl+C to stop monitoring (analysis will continue)\")\n\ntry:\n    start_time = time.time()\n\n    while ce_api.system.method_on():\n        # Get progress information\n        elapsed = ce_api.system.get_elapsed_analysis_time()\n        total = ce_api.system.get_analysis_time()\n        remaining = ce_api.system.get_remaining_analysis_time()\n        status = ce_api.system.status()\n\n        # Calculate percentage\n        if total &gt; 0:\n            progress = (elapsed / total) * 100\n        else:\n            progress = 0\n\n        # Display progress\n        print(f\"\\rStatus: {status} | Progress: {progress:.1f}% | \"\n              f\"Remaining: {remaining:.1f} min\", end='')\n\n        time.sleep(10)  # Update every 10 seconds\n\nexcept KeyboardInterrupt:\n    print(\"\\n\\nStopped monitoring (analysis continues)\")\n\n# Analysis complete\ntotal_time = (time.time() - start_time) / 60\nprint(f\"\\n\\n\u2713 Analysis complete! Total time: {total_time:.1f} minutes\")\n</code></pre>"},{"location":"tutorials/first-analysis/#step-9-cleanup","title":"Step 9: Cleanup","text":"<pre><code># Return vials to carousel\nprint(\"\\nCleaning up...\")\n\nce_api.ce.unload_vial_from_position(\"inlet\")\nce_api.ce.unload_vial_from_position(\"outlet\")\n\nprint(\"\u2713 Vials returned to carousel\")\nprint(\"\\nFirst analysis tutorial complete!\")\n</code></pre>"},{"location":"tutorials/first-analysis/#complete-script","title":"Complete Script","text":"<p>Here's the complete script in one block:</p> <pre><code># First Analysis Tutorial - Complete Script\nfrom ChemstationAPI import ChemstationAPI\nfrom SIA_API.devices import syringeController, ValveSelector\nfrom SIA_API.methods import PreparedSIAMethods\nimport time\n\ndef first_analysis():\n    \"\"\"Run your first automated CE analysis with SIA sample prep.\"\"\"\n\n    # Initialize all systems\n    print(\"=== SIA-CE First Analysis Tutorial ===\\n\")\n\n    ce_api = ChemstationAPI()\n    syringe = syringeController(port=\"COM3\", syringe_size=1000)\n    valve = ValveSelector(port=\"COM4\", num_positions=8)\n    workflow = PreparedSIAMethods(ce_api, syringe, valve)\n\n    # Sample parameters\n    sample_vial = 15\n    sample_name = \"Tutorial_Sample_001\"\n    ce_method = \"CE_Protein_Analysis\"\n\n    # Initialize system\n    print(\"Initializing system...\")\n    workflow.system_initialization_and_cleaning()\n\n    # Validate prerequisites\n    print(\"\\nValidating...\")\n    ce_api.validation.validate_vial_in_system(sample_vial)\n    ce_api.validation.validate_method_name(ce_method)\n\n    # Prepare sample (dilution)\n    print(\"\\nPreparing sample...\")\n    workflow.prepare_continuous_flow(solvent_port=3)\n    workflow.continuous_fill(vial=sample_vial, volume=900, solvent_port=3)\n\n    input(\"\\nAdd 100 \u00b5L sample to vial and press Enter...\")\n\n    workflow.homogenize_sample(vial=sample_vial, speed=1000, \n                               homogenization_time=30)\n\n    # Setup CE\n    print(\"\\nSetting up CE...\")\n    ce_api.ce.load_vial_to_position(sample_vial, \"inlet\")\n    ce_api.ce.load_vial_to_position(48, \"outlet\")\n    ce_api.ce.flush_capillary(60.0)\n\n    # Run analysis\n    print(\"\\nStarting analysis...\")\n    ce_api.method.execution_method_with_parameters(\n        vial=sample_vial,\n        method_name=ce_method,\n        sample_name=sample_name\n    )\n\n    # Monitor\n    while ce_api.system.method_on():\n        remaining = ce_api.system.get_remaining_analysis_time()\n        print(f\"\\r{remaining:.1f} minutes remaining...\", end='')\n        time.sleep(30)\n\n    # Cleanup\n    print(\"\\n\\nCleaning up...\")\n    ce_api.ce.unload_vial_from_position(\"inlet\")\n    ce_api.ce.unload_vial_from_position(\"outlet\")\n\n    print(\"\\n\u2713 Analysis complete!\")\n\nif __name__ == \"__main__\":\n    first_analysis()\n</code></pre>"},{"location":"tutorials/first-analysis/#what-you-learned","title":"What You Learned","text":"<p>In this tutorial, you:</p> <ol> <li>\u2713 Connected to ChemStation and SIA devices</li> <li>\u2713 Initialized the complete system</li> <li>\u2713 Validated all prerequisites</li> <li>\u2713 Performed automated sample dilution</li> <li>\u2713 Mixed samples using pneumatic homogenization</li> <li>\u2713 Set up and ran a CE analysis</li> <li>\u2713 Monitored analysis progress</li> <li>\u2713 Cleaned up after analysis</li> </ol>"},{"location":"tutorials/first-analysis/#next-steps","title":"Next Steps","text":"<ul> <li>Try modifying the dilution ratio</li> <li>Run multiple samples in sequence</li> <li>Explore different CE methods</li> <li>Add more complex sample preparation</li> </ul>"},{"location":"tutorials/first-analysis/#troubleshooting","title":"Troubleshooting","text":"<p>ChemStation Connection Failed - Is ChemStation running? - Is the macro loaded? (<code>macro \"path\\ChemPyConnect.mac\"; Python_Run</code>)</p> <p>SIA Device Not Responding - Check COM port numbers in Device Manager - Verify power and cable connections - Try <code>syringe.send_command(\"?\", get_response=True)</code></p> <p>Vial Not Found - Check vial is properly seated in carousel - Verify vial number is correct (1-50)</p> <p>Method Not Found - Check method name spelling (case-sensitive) - Verify method exists in ChemStation method directory</p> <p>Congratulations!</p> <p>You've completed your first automated analysis! Continue to Batch Processing to learn about analyzing multiple samples.</p>"},{"location":"tutorials/sia-ce-integration/","title":"SIA-CE Integration Tutorial","text":"<p>Learn how to create sophisticated analytical workflows combining SIA sample preparation with CE analysis.</p>"},{"location":"tutorials/sia-ce-integration/#overview","title":"Overview","text":"<p>This tutorial demonstrates advanced integration scenarios: - Multi-step sample preparation - Parallel processing during CE runs - Automated method development - Complex decision trees - Real-time optimization</p>"},{"location":"tutorials/sia-ce-integration/#scenario-protein-stability-study","title":"Scenario: Protein Stability Study","text":"<p>We'll analyze protein samples under different conditions: - pH variations (5.0, 6.0, 7.0, 8.0) - Temperature stress (native, heated) - Time points (0h, 24h, 48h) - Automated sample preparation and analysis</p>"},{"location":"tutorials/sia-ce-integration/#workflow-architecture","title":"Workflow Architecture","text":"<pre><code>graph LR\n    A[Sample Preparation] --&gt; B[CE Analysis]\n    B --&gt; C[Data Collection]\n    C --&gt; D[Decision Logic]\n    D --&gt; A\n    D --&gt; E[Report Generation]</code></pre>"},{"location":"tutorials/sia-ce-integration/#step-1-system-architecture","title":"Step 1: System Architecture","text":"<pre><code>import time\nimport pandas as pd\nimport numpy as np\nfrom datetime import datetime, timedelta\nfrom ChemstationAPI import ChemstationAPI\nfrom SIA_API.devices import syringeController, ValveSelector\nfrom SIA_API.methods import PreparedSIAMethods\n\nclass IntegratedAnalysisSystem:\n    \"\"\"Complete SIA-CE integration for automated analysis.\"\"\"\n\n    def __init__(self):\n        # Initialize all components\n        print(\"Initializing Integrated Analysis System...\")\n\n        self.ce = ChemstationAPI()\n        self.syringe = syringeController(port=\"COM3\", syringe_size=1000)\n        self.valve = ValveSelector(port=\"COM4\", num_positions=8)\n        self.sia = PreparedSIAMethods(self.ce, self.syringe, self.valve)\n\n        # System configuration\n        self.config = {\n            'ports': {\n                'waste': 1,\n                'air': 2,\n                'water': 3,\n                'transfer': 4,\n                'buffer_ph5': 5,\n                'buffer_ph6': 6,\n                'buffer_ph7': 7,\n                'buffer_ph8': 8\n            },\n            'vials': {\n                'samples': list(range(10, 34)),  # 24 sample positions\n                'standards': [1, 2],\n                'blanks': [3, 4],\n                'wash': 48,\n                'waste': 50\n            },\n            'methods': {\n                'native': 'CE_Protein_Native',\n                'denatured': 'CE_Protein_Denatured',\n                'fast_screen': 'CE_Protein_Fast'\n            }\n        }\n\n        # Analysis tracking\n        self.analysis_log = []\n        self.results_cache = {}\n\n        print(\"\u2713 System initialized\")\n\n    def initialize_system(self):\n        \"\"\"Complete system initialization.\"\"\"\n        self.sia.system_initialization_and_cleaning()\n        return self\n\n# Create system instance\nsystem = IntegratedAnalysisSystem()\nsystem.initialize_system()\n</code></pre>"},{"location":"tutorials/sia-ce-integration/#step-2-sample-preparation-workflows","title":"Step 2: Sample Preparation Workflows","text":"<pre><code>class SamplePreparationWorkflows:\n    \"\"\"Advanced sample preparation methods.\"\"\"\n\n    def __init__(self, system):\n        self.system = system\n        self.sia = system.sia\n        self.ce = system.ce\n\n    def prepare_ph_series(self, sample_vial, target_vials, volumes):\n        \"\"\"Prepare pH series from single sample.\"\"\"\n\n        print(f\"\\nPreparing pH series from vial {sample_vial}\")\n\n        ph_buffers = {\n            5.0: self.system.config['ports']['buffer_ph5'],\n            6.0: self.system.config['ports']['buffer_ph6'],\n            7.0: self.system.config['ports']['buffer_ph7'],\n            8.0: self.system.config['ports']['buffer_ph8']\n        }\n\n        preparations = []\n\n        for (target_vial, ph), (sample_vol, buffer_vol) in zip(\n            target_vials.items(), volumes\n        ):\n            print(f\"  pH {ph} \u2192 Vial {target_vial}\")\n\n            # Add buffer first\n            self.sia.prepare_batch_flow(solvent_port=ph_buffers[ph])\n            self.sia.batch_fill(\n                vial=target_vial,\n                volume=buffer_vol,\n                solvent_port=ph_buffers[ph],\n                unload=False\n            )\n\n            # Add sample (manual or automated)\n            print(f\"    Add {sample_vol} \u00b5L from vial {sample_vial}\")\n\n            # Mix thoroughly\n            self.sia.homogenize_sample(\n                vial=target_vial,\n                speed=800,\n                homogenization_time=30\n            )\n\n            preparations.append({\n                'vial': target_vial,\n                'ph': ph,\n                'sample_vol': sample_vol,\n                'buffer_vol': buffer_vol,\n                'time': datetime.now()\n            })\n\n        return preparations\n\n    def thermal_stress_preparation(self, sample_vials, temperature=60, duration=30):\n        \"\"\"Prepare thermally stressed samples.\"\"\"\n\n        print(f\"\\nThermal stress: {temperature}\u00b0C for {duration} min\")\n        print(\"Remove samples for heating\")\n\n        # Log sample removal\n        removal_time = datetime.now()\n\n        # Wait for thermal treatment\n        print(f\"Heating samples...\")\n        time.sleep(duration * 60)  # In real scenario, use external heating\n\n        print(\"Return heated samples to carousel\")\n        return_time = datetime.now()\n\n        # Quick-cool samples\n        for vial in sample_vials:\n            # Add cold buffer for quenching\n            self.sia.batch_fill(\n                vial=vial,\n                volume=100,\n                solvent_port=self.system.config['ports']['water'],\n                transfer_line_volume=300,\n                speed=3000  # Fast for quick cooling\n            )\n\n        stress_log = {\n            'vials': sample_vials,\n            'temperature': temperature,\n            'duration': duration,\n            'removed': removal_time,\n            'returned': return_time\n        }\n\n        return stress_log\n\n    def automated_dilution_series(self, stock_vial, target_vials, dilution_factors):\n        \"\"\"Create dilution series with mixing.\"\"\"\n\n        print(f\"\\nCreating dilution series from vial {stock_vial}\")\n\n        # Use continuous flow for efficiency\n        self.sia.prepare_continuous_flow(\n            solvent_port=self.system.config['ports']['water']\n        )\n\n        dilutions = []\n\n        for vial, factor in zip(target_vials, dilution_factors):\n            # Calculate volumes\n            final_volume = 1000  # \u00b5L\n            stock_volume = final_volume / factor\n            diluent_volume = final_volume - stock_volume\n\n            print(f\"  1:{factor} dilution \u2192 Vial {vial}\")\n\n            # Add diluent\n            self.sia.continuous_fill(\n                vial=vial,\n                volume=diluent_volume,\n                solvent_port=self.system.config['ports']['water']\n            )\n\n            dilutions.append({\n                'vial': vial,\n                'factor': factor,\n                'stock_vol': stock_volume,\n                'diluent_vol': diluent_volume\n            })\n\n        print(f\"Add stock solution volumes as indicated\")\n        return dilutions\n\n# Add workflows to system\nsystem.prep = SamplePreparationWorkflows(system)\n</code></pre>"},{"location":"tutorials/sia-ce-integration/#step-3-intelligent-ce-control","title":"Step 3: Intelligent CE Control","text":"<pre><code>class IntelligentCEControl:\n    \"\"\"Smart CE control with decision logic.\"\"\"\n\n    def __init__(self, system):\n        self.system = system\n        self.ce = system.ce\n\n    def adaptive_method_selection(self, sample_info):\n        \"\"\"Select optimal method based on sample properties.\"\"\"\n\n        # Decision tree for method selection\n        if sample_info.get('screening', False):\n            method = self.system.config['methods']['fast_screen']\n\n        elif sample_info.get('denatured', False):\n            method = self.system.config['methods']['denatured']\n\n        else:\n            method = self.system.config['methods']['native']\n\n        # Adjust parameters based on pH\n        ph = sample_info.get('ph', 7.0)\n        if ph &lt; 6.0:\n            # Low pH modifications\n            print(f\"Adjusting for pH {ph}\")\n            # In practice, modify method parameters here\n\n        return method\n\n    def parallel_sample_prep(self, current_vial, next_vial):\n        \"\"\"Prepare next sample during current analysis.\"\"\"\n\n        print(f\"\\nParallel processing: Current={current_vial}, Next={next_vial}\")\n\n        # Start CE analysis\n        self.ce.method.execution_method_with_parameters(\n            vial=current_vial,\n            method_name=\"CE_Protein_Analysis\",\n            sample_name=f\"Sample_{current_vial}\"\n        )\n\n        # While CE is running, prepare next sample\n        print(\"CE running - preparing next sample...\")\n\n        # Monitor CE and prepare when safe\n        while self.ce.system.method_on():\n            status = self.ce.system.status()\n            remaining = self.ce.system.get_remaining_analysis_time()\n\n            # Start prep when 5 minutes remaining\n            if remaining &lt; 5 and remaining &gt; 0:\n                print(\"Starting next sample preparation\")\n\n                # Safe to use SIA during separation\n                self.system.sia.batch_fill(\n                    vial=next_vial,\n                    volume=500,\n                    solvent_port=self.system.config['ports']['water']\n                )\n\n                self.system.sia.homogenize_sample(\n                    vial=next_vial,\n                    speed=1000,\n                    homogenization_time=20\n                )\n\n                break\n\n            time.sleep(30)\n\n        # Wait for CE completion\n        while self.ce.system.method_on():\n            time.sleep(10)\n\n        return True\n\n    def automated_system_suitability(self):\n        \"\"\"Run system suitability before batch.\"\"\"\n\n        print(\"\\n=== System Suitability Test ===\")\n\n        # Load standard\n        self.ce.ce.load_vial_to_position(1, \"inlet\")\n        self.ce.ce.load_vial_to_position(48, \"outlet\")\n\n        # Condition with method-specific parameters\n        self.ce.ce.flush_capillary(120)  # 2 min conditioning\n\n        # Run suitability standard\n        self.ce.method.execution_method_with_parameters(\n            vial=1,\n            method_name=\"CE_System_Suitability\",\n            sample_name=\"SST_Standard\"\n        )\n\n        # Monitor and evaluate\n        while self.ce.system.method_on():\n            time.sleep(30)\n\n        # In practice, evaluate peak parameters here\n        print(\"\u2713 System suitability passed\")\n\n        # Return vials\n        self.ce.ce.unload_vial_from_position(\"inlet\")\n        self.ce.ce.unload_vial_from_position(\"outlet\")\n\n        return True\n\n# Add intelligent control\nsystem.smart_ce = IntelligentCEControl(system)\n</code></pre>"},{"location":"tutorials/sia-ce-integration/#step-4-complete-stability-study-workflow","title":"Step 4: Complete Stability Study Workflow","text":"<pre><code>def run_protein_stability_study(system):\n    \"\"\"Execute complete protein stability study.\"\"\"\n\n    print(\"\\n=== Protein Stability Study ===\")\n    print(f\"Start: {datetime.now()}\")\n\n    # Study design\n    study_design = {\n        'time_points': [0, 24, 48],  # hours\n        'ph_values': [5.0, 6.0, 7.0, 8.0],\n        'conditions': ['native', 'heat_stressed'],\n        'replicates': 2\n    }\n\n    # Calculate total samples\n    total_samples = (len(study_design['time_points']) * \n                    len(study_design['ph_values']) * \n                    len(study_design['conditions']) * \n                    study_design['replicates'])\n\n    print(f\"Total samples: {total_samples}\")\n\n    # Run system suitability\n    system.smart_ce.automated_system_suitability()\n\n    # Time point 0 - Baseline\n    print(\"\\n--- Time Point 0h ---\")\n\n    # Prepare pH series for native\n    native_vials = {10: 5.0, 11: 6.0, 12: 7.0, 13: 8.0}\n    system.prep.prepare_ph_series(\n        sample_vial=1,  # Original sample\n        target_vials=native_vials,\n        volumes=[(100, 900), (100, 900), (100, 900), (100, 900)]\n    )\n\n    # Prepare heat stressed samples\n    stressed_vials = [14, 15, 16, 17]\n    system.prep.thermal_stress_preparation(\n        sample_vials=stressed_vials,\n        temperature=60,\n        duration=30\n    )\n\n    # Analyze all T0 samples\n    all_t0_vials = list(native_vials.keys()) + stressed_vials\n\n    for i, vial in enumerate(all_t0_vials):\n        # Determine sample info\n        if vial in native_vials:\n            ph = native_vials[vial]\n            condition = 'native'\n        else:\n            idx = stressed_vials.index(vial)\n            ph = list(native_vials.values())[idx]\n            condition = 'stressed'\n\n        sample_info = {\n            'vial': vial,\n            'time_point': 0,\n            'ph': ph,\n            'condition': condition,\n            'denatured': condition == 'stressed'\n        }\n\n        # Select method adaptively\n        method = system.smart_ce.adaptive_method_selection(sample_info)\n\n        # Run with parallel prep if not last sample\n        if i &lt; len(all_t0_vials) - 1:\n            system.smart_ce.parallel_sample_prep(\n                current_vial=vial,\n                next_vial=all_t0_vials[i + 1]\n            )\n        else:\n            # Last sample - no parallel prep\n            system.ce.method.execution_method_with_parameters(\n                vial=vial,\n                method_name=method,\n                sample_name=f\"T0_{condition}_pH{ph}\"\n            )\n\n            while system.ce.system.method_on():\n                time.sleep(30)\n\n    print(\"\\n\u2713 Time point 0h complete\")\n\n    # Store samples for next time points\n    print(\"\\nStore remaining samples at 4\u00b0C\")\n    print(\"Continue with 24h and 48h time points...\")\n\n    # Generate report\n    generate_study_report(system, study_design)\n\ndef generate_study_report(system, study_design):\n    \"\"\"Generate comprehensive study report.\"\"\"\n\n    report = f\"\"\"\nProtein Stability Study Report\n==============================\nGenerated: {datetime.now()}\n\nStudy Design:\n- Time Points: {study_design['time_points']}\n- pH Values: {study_design['ph_values']}\n- Conditions: {study_design['conditions']}\n- Replicates: {study_design['replicates']}\n\nAnalysis Summary:\n- Total Samples: {len(system.analysis_log)}\n- Methods Used: {set([log.get('method') for log in system.analysis_log])}\n\nPreparation Log:\n{pd.DataFrame(system.analysis_log).to_string()}\n\nSystem Performance:\n- Average Analysis Time: X minutes\n- Total Runtime: Y hours\n- Success Rate: Z%\n\"\"\"\n\n    filename = f\"stability_study_{datetime.now().strftime('%Y%m%d')}.txt\"\n    with open(filename, 'w') as f:\n        f.write(report)\n\n    print(f\"\\n\u2713 Report saved: {filename}\")\n\n# Execute study\nrun_protein_stability_study(system)\n</code></pre>"},{"location":"tutorials/sia-ce-integration/#step-5-advanced-integration-patterns","title":"Step 5: Advanced Integration Patterns","text":""},{"location":"tutorials/sia-ce-integration/#real-time-method-optimization","title":"Real-time Method Optimization","text":"<pre><code>class RealTimeOptimization:\n    \"\"\"Optimize methods based on real-time results.\"\"\"\n\n    def __init__(self, system):\n        self.system = system\n        self.optimization_history = []\n\n    def analyze_separation_quality(self, data_file):\n        \"\"\"Analyze separation metrics.\"\"\"\n        # In practice, parse ChemStation data file\n        # For demo, return mock metrics\n        return {\n            'resolution': 1.8,\n            'peak_symmetry': 1.1,\n            'runtime': 12.5,\n            'baseline_noise': 0.02\n        }\n\n    def optimize_next_run(self, current_metrics):\n        \"\"\"Adjust parameters for next run.\"\"\"\n\n        adjustments = {}\n\n        # Resolution optimization\n        if current_metrics['resolution'] &lt; 1.5:\n            adjustments['voltage'] = '+2kV'\n            adjustments['temperature'] = '-2\u00b0C'\n\n        # Speed optimization\n        if current_metrics['resolution'] &gt; 2.0:\n            adjustments['voltage'] = '+5kV'\n            adjustments['runtime'] = '-20%'\n\n        # Noise reduction\n        if current_metrics['baseline_noise'] &gt; 0.05:\n            adjustments['filter'] = 'increase'\n\n        self.optimization_history.append({\n            'metrics': current_metrics,\n            'adjustments': adjustments,\n            'timestamp': datetime.now()\n        })\n\n        return adjustments\n\n# Add optimization capability\nsystem.optimizer = RealTimeOptimization(system)\n</code></pre>"},{"location":"tutorials/sia-ce-integration/#conditional-workflow-branching","title":"Conditional Workflow Branching","text":"<pre><code>def intelligent_workflow_routing(system, sample_info):\n    \"\"\"Route samples based on previous results.\"\"\"\n\n    # Check if screening is needed\n    if 'initial_screen' not in sample_info:\n        # Run fast screening\n        result = quick_screen_analysis(system, sample_info['vial'])\n\n        if result['complexity'] == 'high':\n            # Complex sample - full analysis\n            sample_info['method'] = 'comprehensive'\n            sample_info['prep'] = 'extensive'\n\n        elif result['complexity'] == 'medium':\n            # Standard analysis\n            sample_info['method'] = 'standard'\n            sample_info['prep'] = 'normal'\n\n        else:\n            # Simple sample - fast method\n            sample_info['method'] = 'rapid'\n            sample_info['prep'] = 'minimal'\n\n    # Execute appropriate workflow\n    execute_sample_workflow(system, sample_info)\n\ndef quick_screen_analysis(system, vial):\n    \"\"\"5-minute screening analysis.\"\"\"\n\n    system.ce.method.execution_method_with_parameters(\n        vial=vial,\n        method_name=\"CE_Quick_Screen\",\n        sample_name=f\"Screen_{vial}\"\n    )\n\n    # Wait and analyze\n    while system.ce.system.method_on():\n        time.sleep(10)\n\n    # Mock complexity assessment\n    complexity = np.random.choice(['low', 'medium', 'high'], p=[0.3, 0.5, 0.2])\n\n    return {'vial': vial, 'complexity': complexity}\n</code></pre>"},{"location":"tutorials/sia-ce-integration/#automated-troubleshooting","title":"Automated Troubleshooting","text":"<pre><code>def automated_troubleshooting(system, error_type):\n    \"\"\"Automated error recovery procedures.\"\"\"\n\n    recovery_procedures = {\n        'high_current': [\n            lambda: system.ce.ce.flush_capillary(300),  # Extended flush\n            lambda: system.ce.ce.apply_pressure_to_capillary(-50, 60),  # Vacuum\n            lambda: replace_buffer_vials(system)\n        ],\n        'no_peaks': [\n            lambda: check_sample_preparation(system),\n            lambda: verify_injection_parameters(system),\n            lambda: system.sia.homogenize_sample(vial=current_vial, speed=1500, time=60)\n        ],\n        'baseline_drift': [\n            lambda: system.ce.ce.flush_capillary(180),\n            lambda: equilibrate_temperature(system, duration=15),\n            lambda: check_buffer_levels(system)\n        ]\n    }\n\n    if error_type in recovery_procedures:\n        print(f\"\\nTroubleshooting: {error_type}\")\n\n        for i, procedure in enumerate(recovery_procedures[error_type]):\n            print(f\"  Step {i+1}: {procedure.__name__}\")\n            procedure()\n\n            # Test if resolved\n            if test_system_recovery(system):\n                print(\"\u2713 Issue resolved\")\n                return True\n\n    return False\n</code></pre>"},{"location":"tutorials/sia-ce-integration/#best-practices-for-integration","title":"Best Practices for Integration","text":""},{"location":"tutorials/sia-ce-integration/#1-modular-design","title":"1. Modular Design","text":"<pre><code># Separate concerns into modules\nclass AnalysisModule:\n    def __init__(self, system):\n        self.system = system\n\n    def execute(self, samples):\n        raise NotImplementedError\n\nclass ProteinModule(AnalysisModule):\n    def execute(self, samples):\n        # Protein-specific workflow\n        pass\n\nclass SmallMoleculeModule(AnalysisModule):\n    def execute(self, samples):\n        # Small molecule workflow\n        pass\n</code></pre>"},{"location":"tutorials/sia-ce-integration/#2-state-management","title":"2. State Management","text":"<pre><code>class WorkflowState:\n    \"\"\"Track workflow state for recovery.\"\"\"\n\n    def __init__(self):\n        self.current_step = None\n        self.completed_samples = []\n        self.pending_samples = []\n        self.errors = []\n\n    def checkpoint(self):\n        \"\"\"Save state for recovery.\"\"\"\n        state_file = f\"workflow_state_{datetime.now().strftime('%Y%m%d_%H%M')}.json\"\n        # Save state to file\n\n    def recover(self, state_file):\n        \"\"\"Restore from checkpoint.\"\"\"\n        # Load and resume from saved state\n</code></pre>"},{"location":"tutorials/sia-ce-integration/#3-performance-monitoring","title":"3. Performance Monitoring","text":"<pre><code>class PerformanceMonitor:\n    \"\"\"Monitor system performance metrics.\"\"\"\n\n    def __init__(self):\n        self.metrics = {\n            'sample_prep_time': [],\n            'analysis_time': [],\n            'total_throughput': 0,\n            'error_rate': 0\n        }\n\n    def log_operation(self, operation, duration):\n        \"\"\"Log operation timing.\"\"\"\n        self.metrics[f'{operation}_time'].append(duration)\n\n    def generate_dashboard(self):\n        \"\"\"Create performance dashboard.\"\"\"\n        # Calculate statistics and trends\n        pass\n</code></pre>"},{"location":"tutorials/sia-ce-integration/#conclusion","title":"Conclusion","text":"<p>You've learned advanced SIA-CE integration including: - Multi-component system architecture - Parallel processing strategies - Intelligent method selection - Real-time optimization - Error recovery procedures - Complex workflow design</p> <p>These patterns enable fully automated analytical workflows with minimal manual intervention.</p> <p>Further Reading</p> <ul> <li>Explore the API Reference for detailed function documentation</li> <li>Review Hardware Setup for optimization tips</li> <li>Check FAQ for common integration questions</li> </ul>"}]}